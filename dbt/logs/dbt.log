[0m11:27:23.678284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61713d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52848b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5284a00>]}


============================== 11:27:23.682478 | 6f60879c-ae97-4362-8385-2c5d80a678e6 ==============================
[0m11:27:23.682478 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:27:23.682911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:27:23.744133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f60879c-ae97-4362-8385-2c5d80a678e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79f9dc0>]}
[0m11:27:23.749615 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:27:23.750542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:27:23.751134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10284479, "process_in_blocks": "88", "process_kernel_time": 0.084109, "process_mem_max_rss": "91076", "process_out_blocks": "963", "process_user_time": 0.778008}
[0m11:27:23.751419 [debug] [MainThread]: Command `dbt deps` succeeded at 11:27:23.751366 after 0.10 seconds
[0m11:27:23.751652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61713d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51a3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79f9dc0>]}
[0m11:27:23.751858 [debug] [MainThread]: Flushing usage events
[0m11:27:25.383854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:26.219427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82681100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817c25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817c2550>]}


============================== 11:27:26.221632 | a275c343-7f21-4087-ab55-457b940997c7 ==============================
[0m11:27:26.221632 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:27:26.222223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:27:26.309451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a275c343-7f21-4087-ab55-457b940997c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b498e0>]}
[0m11:27:26.338989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a275c343-7f21-4087-ab55-457b940997c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8186e280>]}
[0m11:27:26.339552 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:27:26.382154 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:27:26.382890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:26.383258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a275c343-7f21-4087-ab55-457b940997c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809f43a0>]}
[0m11:27:26.879928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.marts
[0m11:27:26.882982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a275c343-7f21-4087-ab55-457b940997c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8068d9d0>]}
[0m11:27:26.923395 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:27:26.925317 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:27:26.933786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a275c343-7f21-4087-ab55-457b940997c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063a280>]}
[0m11:27:26.934135 [info ] [MainThread]: Found 3 models, 433 macros
[0m11:27:26.934517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a275c343-7f21-4087-ab55-457b940997c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80382190>]}
[0m11:27:26.935381 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:27:26.935863 [debug] [MainThread]: Command end result
[0m11:27:26.950348 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:27:26.951441 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:27:26.953338 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:27:26.953851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.76713383, "process_in_blocks": "224", "process_kernel_time": 0.056826, "process_mem_max_rss": "104888", "process_out_blocks": "2531", "process_user_time": 1.377792}
[0m11:27:26.954097 [debug] [MainThread]: Command `dbt run` succeeded at 11:27:26.954051 after 0.77 seconds
[0m11:27:26.954309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82681100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82580160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063a2b0>]}
[0m11:27:26.954515 [debug] [MainThread]: Flushing usage events
[0m11:27:27.915915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:03.166889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d101400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c246850>]}


============================== 11:34:03.170904 | 282070a1-0a3b-4e64-a17f-274d93849cbe ==============================
[0m11:34:03.170904 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:34:03.171406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:03.227485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '282070a1-0a3b-4e64-a17f-274d93849cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6e29a0>]}
[0m11:34:03.233203 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:34:03.235849 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:34:03.236633 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09938817, "process_in_blocks": "0", "process_kernel_time": 0.094802, "process_mem_max_rss": "90820", "process_out_blocks": "963", "process_user_time": 0.829776}
[0m11:34:03.237013 [debug] [MainThread]: Command `dbt deps` succeeded at 11:34:03.236948 after 0.10 seconds
[0m11:34:03.237325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d101400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c155cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6e29a0>]}
[0m11:34:03.237675 [debug] [MainThread]: Flushing usage events
[0m11:34:04.560777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:05.367999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b711c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c83640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c835e0>]}


============================== 11:34:05.370091 | 57008f3b-7ed9-4dfc-b82c-6994647d4746 ==============================
[0m11:34:05.370091 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:34:05.370596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:34:05.453538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57008f3b-7ed9-4dfc-b82c-6994647d4746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44570a0>]}
[0m11:34:05.483614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57008f3b-7ed9-4dfc-b82c-6994647d4746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb109d130>]}
[0m11:34:05.484262 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:34:05.524630 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:34:05.579095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:05.579437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:05.583236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.marts
[0m11:34:05.597112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57008f3b-7ed9-4dfc-b82c-6994647d4746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bbcdf0>]}
[0m11:34:05.638328 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:34:05.640591 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:34:05.650193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57008f3b-7ed9-4dfc-b82c-6994647d4746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dc04f0>]}
[0m11:34:05.650577 [info ] [MainThread]: Found 3 models, 433 macros
[0m11:34:05.650839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57008f3b-7ed9-4dfc-b82c-6994647d4746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bff1c0>]}
[0m11:34:05.651693 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:34:05.652780 [debug] [MainThread]: Command end result
[0m11:34:05.667187 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:34:05.668383 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:34:05.670424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:34:05.670962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.33258045, "process_in_blocks": "0", "process_kernel_time": 0.060975, "process_mem_max_rss": "102452", "process_out_blocks": "1710", "process_user_time": 0.912632}
[0m11:34:05.671231 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:05.671180 after 0.33 seconds
[0m11:34:05.671491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b711c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a6f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dc04f0>]}
[0m11:34:05.671703 [debug] [MainThread]: Flushing usage events
[0m11:34:07.097747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:50.175471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f2413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e386820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e386880>]}


============================== 11:34:50.180228 | e7820f9a-04c2-4af3-b7bf-3364852504da ==============================
[0m11:34:50.180228 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:34:50.180764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:34:50.241755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7820f9a-04c2-4af3-b7bf-3364852504da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea26040>]}
[0m11:34:50.247795 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:34:50.249282 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:34:50.250125 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10815621, "process_in_blocks": "0", "process_kernel_time": 0.110861, "process_mem_max_rss": "91028", "process_out_blocks": "963", "process_user_time": 0.801998}
[0m11:34:50.250547 [debug] [MainThread]: Command `dbt deps` succeeded at 11:34:50.250474 after 0.11 seconds
[0m11:34:50.251005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f2413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e290cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea26040>]}
[0m11:34:50.251375 [debug] [MainThread]: Flushing usage events
[0m11:34:51.728863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:52.521818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4182610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41825b0>]}


============================== 11:34:52.524012 | e535aaa8-8893-4e97-9207-554a44435e81 ==============================
[0m11:34:52.524012 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:34:52.524560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:34:52.607002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e535aaa8-8893-4e97-9207-554a44435e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68c0d00>]}
[0m11:34:52.637138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e535aaa8-8893-4e97-9207-554a44435e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41cf520>]}
[0m11:34:52.637864 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:34:52.676918 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:34:52.731340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:52.731650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:52.735199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.marts
[0m11:34:52.748737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e535aaa8-8893-4e97-9207-554a44435e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3075130>]}
[0m11:34:52.788490 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:34:52.790907 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:34:52.799657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e535aaa8-8893-4e97-9207-554a44435e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa308eee0>]}
[0m11:34:52.799945 [info ] [MainThread]: Found 3 models, 433 macros
[0m11:34:52.800191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e535aaa8-8893-4e97-9207-554a44435e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa312e550>]}
[0m11:34:52.801018 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:34:52.802139 [debug] [MainThread]: Command end result
[0m11:34:52.817330 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:34:52.818632 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:34:52.820717 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:34:52.821270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32822275, "process_in_blocks": "0", "process_kernel_time": 0.061983, "process_mem_max_rss": "102456", "process_out_blocks": "1710", "process_user_time": 0.893757}
[0m11:34:52.821528 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:52.821482 after 0.33 seconds
[0m11:34:52.821772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34c49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41cf520>]}
[0m11:34:52.821991 [debug] [MainThread]: Flushing usage events
[0m11:34:54.176012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:44.470290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd71400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce867f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce86850>]}


============================== 11:35:44.474182 | a99be8c8-a018-47c0-aa5a-891d82389da9 ==============================
[0m11:35:44.474182 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:35:44.474625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m11:35:44.594062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99be8c8-a018-47c0-aa5a-891d82389da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3529a0>]}
[0m11:35:44.599696 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:35:44.601031 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:35:44.601733 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.16127867, "process_in_blocks": "0", "process_kernel_time": 0.103277, "process_mem_max_rss": "90876", "process_out_blocks": "963", "process_user_time": 0.862675}
[0m11:35:44.602165 [debug] [MainThread]: Command `dbt deps` succeeded at 11:35:44.602051 after 0.16 seconds
[0m11:35:44.602534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd71400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd95cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3529a0>]}
[0m11:35:44.602831 [debug] [MainThread]: Flushing usage events
[0m11:35:46.971687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:47.767847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0171160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf282640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2825e0>]}


============================== 11:35:47.769861 | 6acedb74-8805-4f1a-91d0-ed733df90d93 ==============================
[0m11:35:47.769861 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:35:47.770283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:47.849632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6acedb74-8805-4f1a-91d0-ed733df90d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19e9970>]}
[0m11:35:47.879185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6acedb74-8805-4f1a-91d0-ed733df90d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5a70d0>]}
[0m11:35:47.879710 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:35:47.920594 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:35:47.974225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:47.974516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:47.978109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.marts
[0m11:35:47.991912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6acedb74-8805-4f1a-91d0-ed733df90d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1b5130>]}
[0m11:35:48.033968 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:35:48.036390 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:35:48.044872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6acedb74-8805-4f1a-91d0-ed733df90d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1ca850>]}
[0m11:35:48.045193 [info ] [MainThread]: Found 3 models, 433 macros
[0m11:35:48.045471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6acedb74-8805-4f1a-91d0-ed733df90d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae17f400>]}
[0m11:35:48.046388 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:35:48.047506 [debug] [MainThread]: Command end result
[0m11:35:48.061912 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:35:48.062999 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:35:48.065360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:35:48.065986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32833067, "process_in_blocks": "0", "process_kernel_time": 0.049244, "process_mem_max_rss": "102456", "process_out_blocks": "1710", "process_user_time": 0.9055}
[0m11:35:48.066307 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:48.066249 after 0.33 seconds
[0m11:35:48.066568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0171160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1ca850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5e9f70>]}
[0m11:35:48.066874 [debug] [MainThread]: Flushing usage events
[0m11:35:50.121632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:33.653014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98546820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98546880>]}


============================== 11:43:33.662759 | 140fe7f4-99e2-461b-ab82-1e25ff444358 ==============================
[0m11:43:33.662759 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:43:33.663340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:43:33.729485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '140fe7f4-99e2-461b-ab82-1e25ff444358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bd6040>]}
[0m11:43:33.735538 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:43:33.737152 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:43:33.737856 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12684429, "process_in_blocks": "0", "process_kernel_time": 0.124313, "process_mem_max_rss": "90996", "process_out_blocks": "963", "process_user_time": 0.832797}
[0m11:43:33.738232 [debug] [MainThread]: Command `dbt deps` succeeded at 11:43:33.738173 after 0.13 seconds
[0m11:43:33.738492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98450cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bd6040>]}
[0m11:43:33.738784 [debug] [MainThread]: Flushing usage events
[0m11:43:35.646099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:36.440650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddf1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf436a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf43640>]}


============================== 11:43:36.442761 | cb2dbd81-694e-425b-a6a8-a0fbbb74c800 ==============================
[0m11:43:36.442761 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:43:36.443274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:36.522842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb2dbd81-694e-425b-a6a8-a0fbbb74c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1193d0>]}
[0m11:43:36.551178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb2dbd81-694e-425b-a6a8-a0fbbb74c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d628d30>]}
[0m11:43:36.551684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:43:36.590660 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:43:36.629812 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:43:36.630159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb2dbd81-694e-425b-a6a8-a0fbbb74c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d645970>]}
[0m11:43:37.115679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb2dbd81-694e-425b-a6a8-a0fbbb74c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd7beb0>]}
[0m11:43:37.153070 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:43:37.155119 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:43:37.164631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb2dbd81-694e-425b-a6a8-a0fbbb74c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bccefa0>]}
[0m11:43:37.164981 [info ] [MainThread]: Found 3 models, 433 macros
[0m11:43:37.165383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb2dbd81-694e-425b-a6a8-a0fbbb74c800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcc9fa0>]}
[0m11:43:37.166465 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:43:37.167156 [debug] [MainThread]: Command end result
[0m11:43:37.193226 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:43:37.194450 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:43:37.196509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:43:37.197045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7879028, "process_in_blocks": "0", "process_kernel_time": 0.064084, "process_mem_max_rss": "106104", "process_out_blocks": "2530", "process_user_time": 1.328755}
[0m11:43:37.197287 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:37.197240 after 0.79 seconds
[0m11:43:37.197509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddf1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be0d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1193d0>]}
[0m11:43:37.197723 [debug] [MainThread]: Flushing usage events
[0m11:43:38.414371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:40.155040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9b1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aac2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aac25e0>]}


============================== 12:53:40.158124 | 9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8 ==============================
[0m12:53:40.158124 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:53:40.158816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:40.280832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d22b940>]}
[0m12:53:40.321766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7dfdf0>]}
[0m12:53:40.322472 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:53:40.378637 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:53:40.454499 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m12:53:40.455072 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/staging/stg_districts.sql
[0m12:53:40.455479 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/staging/stg_crime_reports.sql
[0m12:53:40.455820 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/staging/stg_json.sql
[0m12:53:40.456172 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/staging/stg_pdf.sql
[0m12:53:40.637727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998af130>]}
[0m12:53:40.694220 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:53:40.697563 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:53:40.706683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99877b50>]}
[0m12:53:40.707151 [info ] [MainThread]: Found 3 models, 433 macros
[0m12:53:40.707484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998d6e20>]}
[0m12:53:40.708954 [info ] [MainThread]: 
[0m12:53:40.709444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:40.709868 [info ] [MainThread]: 
[0m12:53:40.710396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:40.713843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m12:53:40.784268 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m12:53:40.784835 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:53:40.785185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:40.796395 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:53:40.797460 [debug] [ThreadPool]: On list_analytics: Close
[0m12:53:40.798778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m12:53:40.804328 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:53:40.804758 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m12:53:40.805127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:40.811433 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:53:40.811871 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:53:40.812210 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:53:40.817505 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m12:53:40.818657 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m12:53:40.819066 [debug] [ThreadPool]: On list_analytics_public: Close
[0m12:53:40.823463 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:40.823753 [debug] [MainThread]: On master: BEGIN
[0m12:53:40.823970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:40.829938 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:53:40.830432 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:40.830811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:40.834943 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:53:40.836131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995a2130>]}
[0m12:53:40.836540 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:40.836893 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:40.837138 [debug] [MainThread]: On master: BEGIN
[0m12:53:40.837525 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:53:40.837821 [debug] [MainThread]: On master: COMMIT
[0m12:53:40.838086 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:40.838339 [debug] [MainThread]: On master: COMMIT
[0m12:53:40.838616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:53:40.838842 [debug] [MainThread]: On master: Close
[0m12:53:40.844712 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m12:53:40.844991 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m12:53:40.845462 [info ] [Thread-1  ]: 1 of 2 START sql view model public.stg_crime_reports ........................... [RUN]
[0m12:53:40.845964 [info ] [Thread-2  ]: 2 of 2 START sql view model public.stg_districts ............................... [RUN]
[0m12:53:40.846451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m12:53:40.846968 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_analytics, now model.my_dbt_project.stg_districts)
[0m12:53:40.847340 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m12:53:40.847692 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m12:53:40.854018 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m12:53:40.856603 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m12:53:40.859231 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m12:53:40.868648 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m12:53:40.894183 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m12:53:40.894650 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m12:53:40.897213 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:53:40.897798 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m12:53:40.898119 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:53:40.897604 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:53:40.898903 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m12:53:40.899526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:40.908821 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m12:53:40.909490 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:53:40.909900 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts;
  );
[0m12:53:40.909255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:53:40.910514 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:53:40.911221 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol_km,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    );
  );
[0m12:53:40.910883 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: FROM public.raw_districts;
                                  ^

[0m12:53:40.911766 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: ROLLBACK
[0m12:53:40.912133 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 31:     );
              ^

[0m12:53:40.913022 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: ROLLBACK
[0m12:53:40.912644 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m12:53:40.915737 [debug] [Thread-2  ]: Database Error in model stg_districts (models/staging/stg_districts.sql)
  syntax error at or near ";"
  LINE 18: FROM public.raw_districts;
                                    ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql
[0m12:53:40.913558 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m12:53:40.918113 [debug] [Thread-1  ]: Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  syntax error at or near ";"
  LINE 31:     );
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql
[0m12:53:40.918547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c160d0>]}
[0m12:53:40.917298 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dbdfb-8b77-4c99-96b0-d85980c3ddd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999e7e80>]}
[0m12:53:40.919194 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public.stg_crime_reports .................. [[31mERROR[0m in 0.07s]
[0m12:53:40.920858 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m12:53:40.920183 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.stg_districts ...................... [[31mERROR[0m in 0.07s]
[0m12:53:40.921435 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.stg_crime_reports' to be skipped because of status 'error'.  Reason: Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  syntax error at or near ";"
  LINE 31:     );
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql.
[0m12:53:40.921928 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m12:53:40.922961 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.stg_districts' to be skipped because of status 'error'.  Reason: Database Error in model stg_districts (models/staging/stg_districts.sql)
  syntax error at or near ";"
  LINE 18: FROM public.raw_districts;
                                    ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql.
[0m12:53:40.924304 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:40.924705 [debug] [MainThread]: On master: BEGIN
[0m12:53:40.925062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:40.931671 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:53:40.932031 [debug] [MainThread]: On master: COMMIT
[0m12:53:40.932433 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:40.932737 [debug] [MainThread]: On master: COMMIT
[0m12:53:40.933203 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:53:40.933615 [debug] [MainThread]: On master: Close
[0m12:53:40.934150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:40.934513 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m12:53:40.934901 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m12:53:40.935351 [info ] [MainThread]: 
[0m12:53:40.935752 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:53:40.936601 [debug] [MainThread]: Command end result
[0m12:53:40.961961 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:53:40.963789 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:53:40.969210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:53:40.969497 [info ] [MainThread]: 
[0m12:53:40.969829 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:53:40.970353 [info ] [MainThread]: 
[0m12:53:40.970751 [error] [MainThread]:   Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  syntax error at or near ";"
  LINE 31:     );
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql
[0m12:53:40.971031 [info ] [MainThread]: 
[0m12:53:40.971544 [error] [MainThread]:   Database Error in model stg_districts (models/staging/stg_districts.sql)
  syntax error at or near ";"
  LINE 18: FROM public.raw_districts;
                                    ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql
[0m12:53:40.971970 [info ] [MainThread]: 
[0m12:53:40.972423 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:53:40.973479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8632661, "process_in_blocks": "32", "process_kernel_time": 0.148839, "process_mem_max_rss": "112704", "process_out_blocks": "2525", "process_user_time": 1.593286}
[0m12:53:40.973897 [debug] [MainThread]: Command `dbt run` failed at 12:53:40.973813 after 0.86 seconds
[0m12:53:40.974311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9b1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99877b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c52f130>]}
[0m12:53:40.974693 [debug] [MainThread]: Flushing usage events
[0m12:53:45.891961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:03.005877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cc1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e036a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e03640>]}


============================== 12:54:03.009110 | 8a8cc6b3-8c86-4583-a40d-a1d25f3f137a ==============================
[0m12:54:03.009110 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:03.009848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:54:03.128349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fd93d0>]}
[0m12:54:03.169257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814f8d30>]}
[0m12:54:03.169952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:03.224422 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:03.296315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:54:03.296891 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/stg_districts.sql
[0m12:54:03.297294 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/stg_crime_reports.sql
[0m12:54:03.469232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9cf130>]}
[0m12:54:03.521337 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:54:03.524014 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:54:03.531996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f995a60>]}
[0m12:54:03.532452 [info ] [MainThread]: Found 3 models, 433 macros
[0m12:54:03.532787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9f7f70>]}
[0m12:54:03.534688 [info ] [MainThread]: 
[0m12:54:03.535332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:03.535815 [info ] [MainThread]: 
[0m12:54:03.536376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:03.540016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m12:54:03.597722 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m12:54:03.598300 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:54:03.598635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:03.606989 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m12:54:03.608018 [debug] [ThreadPool]: On list_analytics: Close
[0m12:54:03.609268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m12:54:03.614477 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:54:03.614813 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m12:54:03.615125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:03.621564 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:54:03.621992 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:54:03.622374 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:03.624935 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:54:03.625917 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m12:54:03.626328 [debug] [ThreadPool]: On list_analytics_public: Close
[0m12:54:03.630230 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:03.630584 [debug] [MainThread]: On master: BEGIN
[0m12:54:03.630850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:03.636753 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:54:03.637114 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:03.637474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:03.640108 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m12:54:03.641121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9b9dc0>]}
[0m12:54:03.641537 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:03.641930 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:03.642214 [debug] [MainThread]: On master: BEGIN
[0m12:54:03.642669 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:54:03.642983 [debug] [MainThread]: On master: COMMIT
[0m12:54:03.643365 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:03.643756 [debug] [MainThread]: On master: COMMIT
[0m12:54:03.644163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:03.644444 [debug] [MainThread]: On master: Close
[0m12:54:03.646830 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m12:54:03.647116 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m12:54:03.647683 [info ] [Thread-1  ]: 1 of 2 START sql view model public.stg_crime_reports ........................... [RUN]
[0m12:54:03.648398 [info ] [Thread-2  ]: 2 of 2 START sql view model public.stg_districts ............................... [RUN]
[0m12:54:03.648912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m12:54:03.649430 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m12:54:03.649812 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m12:54:03.650180 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m12:54:03.656091 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.658639 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m12:54:03.661176 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m12:54:03.667998 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m12:54:03.693954 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.695472 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m12:54:03.696879 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.697509 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m12:54:03.697836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:54:03.697296 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:54:03.698734 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m12:54:03.699180 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:54:03.707200 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m12:54:03.707884 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.708962 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol_km,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m12:54:03.708567 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m12:54:03.709591 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:54:03.709967 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m12:54:03.714419 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:54:03.714631 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:54:03.719677 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:54:03.722356 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m12:54:03.722031 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.722796 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m12:54:03.723012 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:54:03.734021 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m12:54:03.734565 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:54:03.734856 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m12:54:03.734294 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.011 seconds
[0m12:54:03.736148 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m12:54:03.736680 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.737008 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m12:54:03.736398 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:54:03.742804 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m12:54:03.743072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m12:54:03.746214 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m12:54:03.748092 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m12:54:03.748855 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m12:54:03.749126 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m12:54:03.748399 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m12:54:03.749545 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m12:54:03.749859 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m12:54:03.751724 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m12:54:03.752641 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m12:54:03.754563 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0f8b80>]}
[0m12:54:03.755197 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m12:54:03.753984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8cc6b3-8c86-4583-a40d-a1d25f3f137a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80eb8d30>]}
[0m12:54:03.756262 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:54:03.755727 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m12:54:03.756833 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m12:54:03.758197 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:03.758546 [debug] [MainThread]: On master: BEGIN
[0m12:54:03.758821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:03.764948 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:54:03.765362 [debug] [MainThread]: On master: COMMIT
[0m12:54:03.765647 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:03.765958 [debug] [MainThread]: On master: COMMIT
[0m12:54:03.766320 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:03.766679 [debug] [MainThread]: On master: Close
[0m12:54:03.767075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:03.767392 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m12:54:03.767735 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m12:54:03.768125 [info ] [MainThread]: 
[0m12:54:03.768474 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:54:03.769218 [debug] [MainThread]: Command end result
[0m12:54:03.793172 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:54:03.794885 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:54:03.800488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:54:03.800746 [info ] [MainThread]: 
[0m12:54:03.801174 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:03.801598 [info ] [MainThread]: 
[0m12:54:03.801978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:54:03.802876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84009385, "process_in_blocks": "0", "process_kernel_time": 0.120835, "process_mem_max_rss": "113152", "process_out_blocks": "2512", "process_user_time": 1.611803}
[0m12:54:03.803292 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:03.803215 after 0.84 seconds
[0m12:54:03.803658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cc1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fd93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80134b50>]}
[0m12:54:03.804055 [debug] [MainThread]: Flushing usage events
[0m12:54:04.718566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:22.303938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ac11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc03640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc035e0>]}


============================== 13:05:22.306939 | 3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe ==============================
[0m13:05:22.306939 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:05:22.307657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:05:22.436101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23a80a0>]}
[0m13:05:22.479822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efce130>]}
[0m13:05:22.480581 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:22.537089 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:05:22.597448 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:05:22.598042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa037fa30>]}
[0m13:05:23.305377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea5cee0>]}
[0m13:05:23.362394 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:05:23.365519 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:05:23.374425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec778e0>]}
[0m13:05:23.374948 [info ] [MainThread]: Found 3 models, 433 macros
[0m13:05:23.375346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea60760>]}
[0m13:05:23.376511 [info ] [MainThread]: 
[0m13:05:23.376835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:05:23.377149 [info ] [MainThread]: 
[0m13:05:23.377605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:23.381025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:05:23.410487 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:05:23.410908 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:05:23.411231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:23.425503 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m13:05:23.426612 [debug] [ThreadPool]: On list_analytics: Close
[0m13:05:23.427883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:05:23.433651 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:05:23.434001 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:05:23.434280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:23.440397 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:05:23.440835 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:05:23.441228 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:05:23.444134 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:05:23.445219 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:05:23.445668 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:05:23.449760 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:23.450099 [debug] [MainThread]: On master: BEGIN
[0m13:05:23.450395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:23.457167 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:05:23.457533 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:23.457898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:23.461446 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:05:23.462759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef730a0>]}
[0m13:05:23.463164 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:23.463541 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:23.463808 [debug] [MainThread]: On master: BEGIN
[0m13:05:23.464334 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:05:23.464727 [debug] [MainThread]: On master: COMMIT
[0m13:05:23.465029 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:23.465296 [debug] [MainThread]: On master: COMMIT
[0m13:05:23.465704 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:23.466019 [debug] [MainThread]: On master: Close
[0m13:05:23.468676 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m13:05:23.469047 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m13:05:23.469683 [info ] [Thread-1  ]: 1 of 2 START sql view model public.stg_crime_reports ........................... [RUN]
[0m13:05:23.470353 [info ] [Thread-2  ]: 2 of 2 START sql view model public.stg_districts ............................... [RUN]
[0m13:05:23.471060 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m13:05:23.471591 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m13:05:23.472199 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m13:05:23.472619 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m13:05:23.478769 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.480734 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m13:05:23.482277 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m13:05:23.489236 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m13:05:23.522696 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.523513 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m13:05:23.525031 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.525673 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m13:05:23.526022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:23.525463 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:05:23.526762 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m13:05:23.527471 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:05:23.537522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m13:05:23.538015 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.538424 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m13:05:23.539128 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m13:05:23.539614 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:05:23.540137 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m13:05:23.541662 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:05:23.541919 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:05:23.547700 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.550686 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports" rename to "stg_crime_reports__dbt_backup"
[0m13:05:23.550380 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:05:23.551113 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts" rename to "stg_districts__dbt_backup"
[0m13:05:23.551357 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:05:23.554259 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.554853 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m13:05:23.554515 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:05:23.557888 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:05:23.558464 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m13:05:23.558131 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:05:23.568076 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.009 seconds
[0m13:05:23.571803 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:05:23.573547 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.573924 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:05:23.573139 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:05:23.574459 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:05:23.575001 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:05:23.574795 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:05:23.580082 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m13:05:23.580329 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m13:05:23.583428 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:05:23.586356 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m13:05:23.587202 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:05:23.587552 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m13:05:23.586702 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m13:05:23.589125 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:05:23.589354 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:05:23.592459 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m13:05:23.591407 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m13:05:23.594341 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2340ee0>]}
[0m13:05:23.593813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e068bc5-de6d-4ffc-a4fd-614ba33f0ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db0f7f0>]}
[0m13:05:23.594905 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:05:23.596060 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m13:05:23.595487 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:05:23.596680 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m13:05:23.597707 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:23.598024 [debug] [MainThread]: On master: BEGIN
[0m13:05:23.598279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:23.604858 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:05:23.607813 [debug] [MainThread]: On master: COMMIT
[0m13:05:23.608181 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:23.608551 [debug] [MainThread]: On master: COMMIT
[0m13:05:23.609041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:23.609401 [debug] [MainThread]: On master: Close
[0m13:05:23.609879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:23.611715 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m13:05:23.612042 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m13:05:23.612359 [info ] [MainThread]: 
[0m13:05:23.612660 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:05:23.613546 [debug] [MainThread]: Command end result
[0m13:05:23.635922 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:05:23.637587 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:05:23.642702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:05:23.642969 [info ] [MainThread]: 
[0m13:05:23.643351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:23.643780 [info ] [MainThread]: 
[0m13:05:23.644270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:05:23.645271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3865036, "process_in_blocks": "0", "process_kernel_time": 0.227039, "process_mem_max_rss": "113800", "process_out_blocks": "2513", "process_user_time": 2.175382}
[0m13:05:23.645697 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:23.645633 after 1.39 seconds
[0m13:05:23.646026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ac11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09af640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec77040>]}
[0m13:05:23.646381 [debug] [MainThread]: Flushing usage events
[0m13:05:29.596454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:06.926236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9081400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81c67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81c6850>]}


============================== 13:41:06.932195 | 17e1d52f-b978-4c39-aba8-0322e16dd15a ==============================
[0m13:41:06.932195 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:41:06.932951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:41:07.019421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e1d52f-b978-4c39-aba8-0322e16dd15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83a29a0>]}
[0m13:41:07.034125 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:41:07.036374 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:41:07.037316 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15384945, "process_in_blocks": "0", "process_kernel_time": 0.128248, "process_mem_max_rss": "91024", "process_out_blocks": "963", "process_user_time": 1.153227}
[0m13:41:07.037847 [debug] [MainThread]: Command `dbt deps` succeeded at 13:41:07.037746 after 0.15 seconds
[0m13:41:07.038158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9081400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80d5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83a29a0>]}
[0m13:41:07.038483 [debug] [MainThread]: Flushing usage events
[0m13:41:12.280010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:13.372231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8c25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8c2580>]}


============================== 13:41:13.374971 | b09b1e0e-78e0-4d07-9055-c58229ac2555 ==============================
[0m13:41:13.374971 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:41:13.375702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:41:13.487368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c69850>]}
[0m13:41:13.527544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c21a90>]}
[0m13:41:13.528243 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:13.583924 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:41:13.660204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:13.660798 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/mart/transformed_data.sql
[0m13:41:13.843332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996c7130>]}
[0m13:41:13.896821 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:41:13.899724 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:41:13.912316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99665340>]}
[0m13:41:13.912768 [info ] [MainThread]: Found 3 models, 433 macros
[0m13:41:13.913285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993d51c0>]}
[0m13:41:13.914612 [info ] [MainThread]: 
[0m13:41:13.915051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:13.915402 [info ] [MainThread]: 
[0m13:41:13.915964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:13.919579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:41:13.990798 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:41:13.991470 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:41:13.991853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:14.001492 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m13:41:14.002578 [debug] [ThreadPool]: On list_analytics: Close
[0m13:41:14.004024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:41:14.009373 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:41:14.009843 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:41:14.010199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:14.016655 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:41:14.017128 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:41:14.017521 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:41:14.020236 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m13:41:14.021353 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:41:14.021826 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:41:14.026921 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.027360 [debug] [MainThread]: On master: BEGIN
[0m13:41:14.027721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:14.034684 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:41:14.035249 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.035608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:14.038879 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:41:14.040376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf4ba60>]}
[0m13:41:14.040939 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:14.041388 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.041756 [debug] [MainThread]: On master: BEGIN
[0m13:41:14.042317 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:41:14.042869 [debug] [MainThread]: On master: COMMIT
[0m13:41:14.043224 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.043595 [debug] [MainThread]: On master: COMMIT
[0m13:41:14.044037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:14.044359 [debug] [MainThread]: On master: Close
[0m13:41:14.050066 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m13:41:14.050378 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m13:41:14.050670 [debug] [Thread-3  ]: Began running node model.my_dbt_project.transformed_data
[0m13:41:14.051169 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m13:41:14.052019 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m13:41:14.052751 [info ] [Thread-3  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m13:41:14.053253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m13:41:14.053905 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m13:41:14.054740 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m13:41:14.056183 [debug] [Thread-3  ]: Began compiling node model.my_dbt_project.transformed_data
[0m13:41:14.055713 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m13:41:14.055190 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m13:41:14.063031 [debug] [Thread-3  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m13:41:14.066068 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m13:41:14.067872 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.070791 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m13:41:14.076871 [debug] [Thread-3  ]: Began executing node model.my_dbt_project.transformed_data
[0m13:41:14.077144 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m13:41:14.100387 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.118324 [debug] [Thread-3  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m13:41:14.121371 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m13:41:14.124607 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:41:14.125035 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.125289 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m13:41:14.125538 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:41:14.125863 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m13:41:14.126803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:41:14.126512 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m13:41:14.126195 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:41:14.127385 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:41:14.142992 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m13:41:14.143398 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.143854 [debug] [Thread-3  ]: SQL status: BEGIN in 0.016 seconds
[0m13:41:14.144197 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m13:41:14.144482 [debug] [Thread-2  ]: SQL status: BEGIN in 0.018 seconds
[0m13:41:14.144948 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:41:14.145599 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:41:14.146108 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM public.stg_crime_reports AS scr
    LEFT JOIN stg_districts AS sd ON scr.district_id = sd.district_id
  );
  
[0m13:41:14.146495 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m13:41:14.147505 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:41:14.153346 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:41:14.154895 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.158554 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports" rename to "stg_crime_reports__dbt_backup"
[0m13:41:14.158170 [debug] [Thread-3  ]: SQL status: SELECT 2403 in 0.011 seconds
[0m13:41:14.157882 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:41:14.161311 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:41:14.161706 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts" rename to "stg_districts__dbt_backup"
[0m13:41:14.162123 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m13:41:14.162780 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:41:14.177881 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m13:41:14.178386 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:41:14.178862 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m13:41:14.179899 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:41:14.180160 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.018 seconds
[0m13:41:14.180422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.022 seconds
[0m13:41:14.185797 [debug] [Thread-3  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m13:41:14.188555 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:41:14.195211 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m13:41:14.194799 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:41:14.191038 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.195737 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m13:41:14.196046 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:14.196374 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m13:41:14.199260 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:41:14.199531 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:41:14.200093 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:41:14.202789 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:41:14.202421 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: Close
[0m13:41:14.200299 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:41:14.204547 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m13:41:14.204852 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a961850>]}
[0m13:41:14.205925 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:41:14.210106 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.209593 [info ] [Thread-3  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.15s]
[0m13:41:14.208955 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m13:41:14.210463 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:41:14.210972 [debug] [Thread-3  ]: Finished running node model.my_dbt_project.transformed_data
[0m13:41:14.212964 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:41:14.214099 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m13:41:14.213768 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:41:14.216426 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m13:41:14.217224 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:41:14.217521 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m13:41:14.216692 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:41:14.219093 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m13:41:14.219900 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b66bb0>]}
[0m13:41:14.220455 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:41:14.221066 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m13:41:14.219351 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:41:14.222386 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m13:41:14.222941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09b1e0e-78e0-4d07-9055-c58229ac2555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993b9c70>]}
[0m13:41:14.223492 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:41:14.224130 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m13:41:14.225292 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.225632 [debug] [MainThread]: On master: BEGIN
[0m13:41:14.225918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:14.231931 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:41:14.232343 [debug] [MainThread]: On master: COMMIT
[0m13:41:14.232742 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.233216 [debug] [MainThread]: On master: COMMIT
[0m13:41:14.233636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:14.233932 [debug] [MainThread]: On master: Close
[0m13:41:14.234345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:14.234816 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m13:41:14.235155 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m13:41:14.235479 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m13:41:14.235832 [info ] [MainThread]: 
[0m13:41:14.236275 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:41:14.237158 [debug] [MainThread]: Command end result
[0m13:41:14.258953 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:41:14.260768 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:41:14.266509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:41:14.266799 [info ] [MainThread]: 
[0m13:41:14.267189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:14.267613 [info ] [MainThread]: 
[0m13:41:14.268093 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:41:14.268866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9373795, "process_in_blocks": "0", "process_kernel_time": 0.109522, "process_mem_max_rss": "114232", "process_out_blocks": "2616", "process_user_time": 1.697096}
[0m13:41:14.269258 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:14.269165 after 0.94 seconds
[0m13:41:14.269633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99699130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99699400>]}
[0m13:41:14.269996 [debug] [MainThread]: Flushing usage events
[0m13:41:15.652162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:16.750250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed02100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de42850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de428b0>]}


============================== 13:41:16.753640 | 9234a002-580d-4dab-9caa-f219ae08de88 ==============================
[0m13:41:16.753640 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:41:16.754319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:16.867170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9234a002-580d-4dab-9caa-f219ae08de88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebff3a0>]}
[0m13:41:16.907509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9234a002-580d-4dab-9caa-f219ae08de88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d16ea60>]}
[0m13:41:16.908194 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:16.962997 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:41:17.037237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:17.037632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:17.061363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9234a002-580d-4dab-9caa-f219ae08de88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd32130>]}
[0m13:41:17.069943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9234a002-580d-4dab-9caa-f219ae08de88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd67760>]}
[0m13:41:17.070523 [info ] [MainThread]: Found 3 models, 433 macros
[0m13:41:17.070966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9234a002-580d-4dab-9caa-f219ae08de88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd67610>]}
[0m13:41:17.072295 [info ] [MainThread]: 
[0m13:41:17.072664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:17.073063 [info ] [MainThread]: 
[0m13:41:17.073614 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:17.077117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:41:17.105854 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:41:17.106338 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:41:17.106649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:17.113227 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:41:17.113659 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:41:17.114053 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:41:17.116070 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:41:17.117307 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:41:17.117753 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:41:17.122497 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:17.122920 [debug] [MainThread]: On master: BEGIN
[0m13:41:17.123279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:17.129436 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:41:17.129837 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:17.130206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:17.132864 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m13:41:17.134207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9234a002-580d-4dab-9caa-f219ae08de88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccff7f0>]}
[0m13:41:17.134600 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:17.134990 [debug] [MainThread]: On master: Close
[0m13:41:17.137396 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m13:41:17.137717 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m13:41:17.138036 [debug] [Thread-3  ]: Began running node model.my_dbt_project.transformed_data
[0m13:41:17.138561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m13:41:17.139782 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m13:41:17.140293 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m13:41:17.140709 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m13:41:17.141123 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m13:41:17.141493 [debug] [Thread-3  ]: Began compiling node model.my_dbt_project.transformed_data
[0m13:41:17.147435 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m13:41:17.149141 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m13:41:17.150829 [debug] [Thread-3  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m13:41:17.153119 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m13:41:17.154070 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m13:41:17.154312 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m13:41:17.155329 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m13:41:17.155585 [debug] [Thread-3  ]: Began executing node model.my_dbt_project.transformed_data
[0m13:41:17.156366 [debug] [Thread-3  ]: Finished running node model.my_dbt_project.transformed_data
[0m13:41:17.157346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:17.157622 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m13:41:17.157848 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m13:41:17.158038 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m13:41:17.158633 [debug] [MainThread]: Command end result
[0m13:41:17.214395 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:41:17.217123 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:41:17.223132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:41:17.227482 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:41:17.227771 [info ] [MainThread]: Building catalog
[0m13:41:17.234957 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m13:41:17.241223 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m13:41:17.241581 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m13:41:17.241867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:17.248285 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:41:17.248686 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m13:41:17.249136 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:41:17.253089 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.004 seconds
[0m13:41:17.256247 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m13:41:17.256703 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m13:41:17.266706 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m13:41:17.326812 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:41:17.328640 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:41:17.328990 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m13:41:17.330017 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6229618, "process_in_blocks": "0", "process_kernel_time": 0.109135, "process_mem_max_rss": "108684", "process_out_blocks": "5025", "process_user_time": 1.369703}
[0m13:41:17.330510 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:41:17.330414 after 0.62 seconds
[0m13:41:17.330825 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:41:17.331062 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m13:41:17.331332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed02100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efca910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebff3a0>]}
[0m13:41:17.331678 [debug] [MainThread]: Flushing usage events
[0m13:41:19.949003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:44.077971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6468b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf646910>]}


============================== 13:44:44.084162 | aee5ff1b-0066-413d-91a8-d44406102bee ==============================
[0m13:44:44.084162 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:44:44.084874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m13:44:44.165828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aee5ff1b-0066-413d-91a8-d44406102bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d79dc0>]}
[0m13:44:44.173229 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:44.174752 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:44.175662 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14087637, "process_in_blocks": "0", "process_kernel_time": 0.124332, "process_mem_max_rss": "91028", "process_out_blocks": "963", "process_user_time": 1.141233}
[0m13:44:44.176134 [debug] [MainThread]: Command `dbt deps` succeeded at 13:44:44.176029 after 0.14 seconds
[0m13:44:44.176512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf550cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf572430>]}
[0m13:44:44.176906 [debug] [MainThread]: Flushing usage events
[0m13:44:50.590302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:51.688357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949b1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ac36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ac3670>]}


============================== 13:44:51.691417 | 87c9f98d-ea1e-4156-997a-d6d547ad1c74 ==============================
[0m13:44:51.691417 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:44:51.692062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:51.810561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9484c7c0>]}
[0m13:44:51.854211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b49430>]}
[0m13:44:51.855049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:51.909583 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:44:51.982877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:51.983277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:52.006700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929eadc0>]}
[0m13:44:52.062529 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:44:52.065079 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:44:52.078229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929f2b50>]}
[0m13:44:52.078712 [info ] [MainThread]: Found 3 models, 433 macros
[0m13:44:52.079156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d2a460>]}
[0m13:44:52.080518 [info ] [MainThread]: 
[0m13:44:52.080903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:52.081232 [info ] [MainThread]: 
[0m13:44:52.081701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:52.085114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:44:52.113105 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:44:52.113536 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:44:52.113874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:52.122660 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m13:44:52.123687 [debug] [ThreadPool]: On list_analytics: Close
[0m13:44:52.125197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:44:52.130362 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:44:52.130744 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:44:52.131043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:52.137200 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:44:52.137608 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:44:52.137934 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:44:52.140610 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m13:44:52.141648 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:44:52.142064 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:44:52.146263 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:52.146723 [debug] [MainThread]: On master: BEGIN
[0m13:44:52.147031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:52.153164 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:44:52.153519 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:52.153883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:52.156872 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:44:52.157939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961723a0>]}
[0m13:44:52.158383 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:52.158822 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:52.159094 [debug] [MainThread]: On master: BEGIN
[0m13:44:52.159558 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:44:52.159826 [debug] [MainThread]: On master: COMMIT
[0m13:44:52.160096 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:52.160356 [debug] [MainThread]: On master: COMMIT
[0m13:44:52.160723 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:52.161009 [debug] [MainThread]: On master: Close
[0m13:44:52.166324 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m13:44:52.166619 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m13:44:52.166894 [debug] [Thread-3  ]: Began running node model.my_dbt_project.transformed_data
[0m13:44:52.167398 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m13:44:52.168020 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m13:44:52.168647 [info ] [Thread-3  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m13:44:52.169175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m13:44:52.169689 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m13:44:52.170126 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m13:44:52.171392 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m13:44:52.171796 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m13:44:52.172119 [debug] [Thread-3  ]: Began compiling node model.my_dbt_project.transformed_data
[0m13:44:52.178040 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.179821 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m13:44:52.181413 [debug] [Thread-3  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m13:44:52.183686 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m13:44:52.190109 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m13:44:52.190344 [debug] [Thread-3  ]: Began executing node model.my_dbt_project.transformed_data
[0m13:44:52.216853 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.216004 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m13:44:52.273072 [debug] [Thread-3  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m13:44:52.275049 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.275836 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:44:52.276832 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m13:44:52.276468 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:44:52.276172 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m13:44:52.277238 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:44:52.277667 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m13:44:52.278036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:44:52.278670 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:44:52.296529 [debug] [Thread-2  ]: SQL status: BEGIN in 0.019 seconds
[0m13:44:52.297001 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m13:44:52.297489 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:44:52.297776 [debug] [Thread-3  ]: SQL status: BEGIN in 0.019 seconds
[0m13:44:52.298198 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.298594 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m13:44:52.298961 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:44:52.299372 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m13:44:52.300001 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM public.stg_crime_reports AS scr
    LEFT JOIN stg_districts AS sd ON scr.district_id = sd.district_id
  );
  
[0m13:44:52.300929 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "public.stg_crime_reports" does not exist
LINE 21: FROM public.stg_crime_reports AS scr
              ^

[0m13:44:52.301690 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: ROLLBACK
[0m13:44:52.301317 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:44:52.302173 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: Close
[0m13:44:52.302462 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:44:52.307907 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:44:52.309745 [debug] [Thread-3  ]: Database Error in model transformed_data (models/mart/transformed_data.sql)
  relation "public.stg_crime_reports" does not exist
  LINE 21: FROM public.stg_crime_reports AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m13:44:52.312893 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.313413 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m13:44:52.315164 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91df3940>]}
[0m13:44:52.315582 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m13:44:52.316439 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model public.transformed_data .................. [[31mERROR[0m in 0.14s]
[0m13:44:52.316741 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:52.317730 [debug] [Thread-3  ]: Finished running node model.my_dbt_project.transformed_data
[0m13:44:52.318016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:52.330914 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:44:52.331577 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.transformed_data' to be skipped because of status 'error'.  Reason: Database Error in model transformed_data (models/mart/transformed_data.sql)
  relation "public.stg_crime_reports" does not exist
  LINE 21: FROM public.stg_crime_reports AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql.
[0m13:44:52.333119 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:44:52.333614 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:44:52.334837 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.335272 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:44:52.335876 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:44:52.337016 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m13:44:52.337359 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:44:52.342764 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m13:44:52.344879 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m13:44:52.348794 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:44:52.349624 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:44:52.350031 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m13:44:52.350485 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m13:44:52.351157 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m13:44:52.351431 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m13:44:52.353816 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m13:44:52.355052 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m13:44:52.355730 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9622feb0>]}
[0m13:44:52.356342 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9f98d-ea1e-4156-997a-d6d547ad1c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ced9d0>]}
[0m13:44:52.356920 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:44:52.357580 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:44:52.358169 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m13:44:52.358702 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m13:44:52.360102 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:52.360473 [debug] [MainThread]: On master: BEGIN
[0m13:44:52.360757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:52.367866 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:44:52.368414 [debug] [MainThread]: On master: COMMIT
[0m13:44:52.368817 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:52.369504 [debug] [MainThread]: On master: COMMIT
[0m13:44:52.373214 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:44:52.374903 [debug] [MainThread]: On master: Close
[0m13:44:52.376168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:52.376732 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m13:44:52.377144 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m13:44:52.377667 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m13:44:52.378259 [info ] [MainThread]: 
[0m13:44:52.378807 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:44:52.379848 [debug] [MainThread]: Command end result
[0m13:44:52.402422 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:44:52.404154 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:44:52.409987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:44:52.410281 [info ] [MainThread]: 
[0m13:44:52.410677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:44:52.411132 [info ] [MainThread]: 
[0m13:44:52.411563 [error] [MainThread]:   Database Error in model transformed_data (models/mart/transformed_data.sql)
  relation "public.stg_crime_reports" does not exist
  LINE 21: FROM public.stg_crime_reports AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m13:44:52.411912 [info ] [MainThread]: 
[0m13:44:52.412310 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:44:52.413167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7669844, "process_in_blocks": "0", "process_kernel_time": 0.095522, "process_mem_max_rss": "111364", "process_out_blocks": "1790", "process_user_time": 1.537401}
[0m13:44:52.413642 [debug] [MainThread]: Command `dbt run` failed at 13:44:52.413511 after 0.77 seconds
[0m13:44:52.414091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949b1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961d1910>]}
[0m13:44:52.414552 [debug] [MainThread]: Flushing usage events
[0m13:44:54.973829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:01.161929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72c1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64047f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6404850>]}


============================== 13:57:01.170867 | b97d59cf-5e73-4b48-949e-325bde0920e1 ==============================
[0m13:57:01.170867 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:57:01.171723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:01.257807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b97d59cf-5e73-4b48-949e-325bde0920e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65e29a0>]}
[0m13:57:01.267668 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:57:01.269573 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:57:01.270685 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15337504, "process_in_blocks": "0", "process_kernel_time": 0.131449, "process_mem_max_rss": "90908", "process_out_blocks": "963", "process_user_time": 1.154735}
[0m13:57:01.271262 [debug] [MainThread]: Command `dbt deps` succeeded at 13:57:01.271149 after 0.15 seconds
[0m13:57:01.271723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72c1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6315cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65e29a0>]}
[0m13:57:01.272155 [debug] [MainThread]: Flushing usage events
[0m13:57:04.443736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:05.561618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb835e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb83580>]}


============================== 13:57:05.564741 | 2628e38b-67b7-4879-8a6d-1e149b31c5d9 ==============================
[0m13:57:05.564741 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:57:05.565436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:05.681559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec2ed30>]}
[0m13:57:05.722791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadea8280>]}
[0m13:57:05.723534 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:05.776810 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:57:05.831872 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:57:05.832445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2a9190>]}
[0m13:57:06.528730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9befa0>]}
[0m13:57:06.583951 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:57:06.586638 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:57:06.599524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad900460>]}
[0m13:57:06.599982 [info ] [MainThread]: Found 3 models, 433 macros
[0m13:57:06.600317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9233d0>]}
[0m13:57:06.601501 [info ] [MainThread]: 
[0m13:57:06.601892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:06.602178 [info ] [MainThread]: 
[0m13:57:06.602603 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:06.606788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:57:06.635579 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:57:06.636092 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:57:06.636430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:06.644508 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m13:57:06.645667 [debug] [ThreadPool]: On list_analytics: Close
[0m13:57:06.646956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:57:06.652647 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:57:06.653029 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:57:06.653330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:06.659766 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:57:06.660108 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:57:06.660435 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:57:06.662826 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m13:57:06.663886 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:57:06.664403 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:57:06.668263 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:06.668582 [debug] [MainThread]: On master: BEGIN
[0m13:57:06.668818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:06.674516 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:57:06.674826 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:06.675158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:06.678120 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:57:06.679100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9cf6a0>]}
[0m13:57:06.679503 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:06.679857 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:06.680135 [debug] [MainThread]: On master: BEGIN
[0m13:57:06.680715 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:57:06.681132 [debug] [MainThread]: On master: COMMIT
[0m13:57:06.681572 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:06.681899 [debug] [MainThread]: On master: COMMIT
[0m13:57:06.682336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:06.682691 [debug] [MainThread]: On master: Close
[0m13:57:06.688334 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m13:57:06.688715 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m13:57:06.689079 [debug] [Thread-3  ]: Began running node model.my_dbt_project.transformed_data
[0m13:57:06.690954 [info ] [Thread-3  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m13:57:06.690260 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m13:57:06.689582 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m13:57:06.691722 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m13:57:06.692248 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m13:57:06.692685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m13:57:06.693256 [debug] [Thread-3  ]: Began compiling node model.my_dbt_project.transformed_data
[0m13:57:06.693696 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m13:57:06.693999 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m13:57:06.700573 [debug] [Thread-3  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m13:57:06.702667 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m13:57:06.704599 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.707435 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m13:57:06.707695 [debug] [Thread-3  ]: Began executing node model.my_dbt_project.transformed_data
[0m13:57:06.707935 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m13:57:06.748410 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.760597 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m13:57:06.761009 [debug] [Thread-3  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m13:57:06.762748 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.763366 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m13:57:06.763960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:06.763737 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:57:06.763160 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:57:06.765118 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m13:57:06.765486 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:57:06.764663 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m13:57:06.766055 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:57:06.771774 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:57:06.774654 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.775099 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m13:57:06.776669 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m13:57:06.777359 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:57:06.777656 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:57:06.778076 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m13:57:06.778579 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m13:57:06.784076 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.784638 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m13:57:06.785009 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m13:57:06.785342 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM public.stg_crime_reports AS scr
    LEFT JOIN stg_districts AS sd ON scr.district_id = sd.district_id
  );
  
[0m13:57:06.785635 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:57:06.786290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:06.786609 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "public.stg_crime_reports" does not exist
LINE 21: FROM public.stg_crime_reports AS scr
              ^

[0m13:57:06.801658 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: ROLLBACK
[0m13:57:06.801190 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:57:06.789205 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:57:06.802941 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m13:57:06.802559 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.802294 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: Close
[0m13:57:06.803444 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m13:57:06.803717 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:06.805420 [debug] [Thread-3  ]: Database Error in model transformed_data (models/mart/transformed_data.sql)
  relation "public.stg_crime_reports" does not exist
  LINE 21: FROM public.stg_crime_reports AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m13:57:06.806914 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:57:06.807194 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:06.808686 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd5d0d0>]}
[0m13:57:06.816172 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model public.transformed_data .................. [[31mERROR[0m in 0.12s]
[0m13:57:06.815560 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m13:57:06.809036 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:57:06.816730 [debug] [Thread-3  ]: Finished running node model.my_dbt_project.transformed_data
[0m13:57:06.820171 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m13:57:06.820587 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m13:57:06.821124 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.transformed_data' to be skipped because of status 'error'.  Reason: Database Error in model transformed_data (models/mart/transformed_data.sql)
  relation "public.stg_crime_reports" does not exist
  LINE 21: FROM public.stg_crime_reports AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql.
[0m13:57:06.821523 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m13:57:06.822353 [debug] [Thread-2  ]: SQL status: COMMIT in 0.000 seconds
[0m13:57:06.822946 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m13:57:06.824963 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m13:57:06.827137 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m13:57:06.827685 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m13:57:06.828238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb158c610>]}
[0m13:57:06.828599 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m13:57:06.829184 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m13:57:06.829763 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m13:57:06.830163 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m13:57:06.831142 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m13:57:06.831858 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2628e38b-67b7-4879-8a6d-1e149b31c5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd676d0>]}
[0m13:57:06.832302 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m13:57:06.832900 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m13:57:06.834075 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:06.834457 [debug] [MainThread]: On master: BEGIN
[0m13:57:06.834768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:06.841252 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:57:06.841744 [debug] [MainThread]: On master: COMMIT
[0m13:57:06.842092 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:06.842373 [debug] [MainThread]: On master: COMMIT
[0m13:57:06.842759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:06.843036 [debug] [MainThread]: On master: Close
[0m13:57:06.843431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:06.843735 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m13:57:06.844005 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m13:57:06.844271 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m13:57:06.844650 [info ] [MainThread]: 
[0m13:57:06.845071 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:57:06.845989 [debug] [MainThread]: Command end result
[0m13:57:06.879282 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:57:06.881319 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:57:06.887092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:57:06.887409 [info ] [MainThread]: 
[0m13:57:06.887776 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:57:06.888293 [info ] [MainThread]: 
[0m13:57:06.888819 [error] [MainThread]:   Database Error in model transformed_data (models/mart/transformed_data.sql)
  relation "public.stg_crime_reports" does not exist
  LINE 21: FROM public.stg_crime_reports AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m13:57:06.889276 [info ] [MainThread]: 
[0m13:57:06.889896 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:57:06.891233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3759297, "process_in_blocks": "0", "process_kernel_time": 0.103725, "process_mem_max_rss": "115396", "process_out_blocks": "2613", "process_user_time": 2.136347}
[0m13:57:06.891725 [debug] [MainThread]: Command `dbt run` failed at 13:57:06.891615 after 1.38 seconds
[0m13:57:06.892150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad900460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8eba60>]}
[0m13:57:06.892526 [debug] [MainThread]: Flushing usage events
[0m13:57:07.759415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:07.023702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cc1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe067f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe06850>]}


============================== 14:00:07.030650 | e77ad613-6c15-4774-aed6-57148ba95638 ==============================
[0m14:00:07.030650 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:00:07.031517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:00:07.121937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77ad613-6c15-4774-aed6-57148ba95638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffe19a0>]}
[0m14:00:07.132229 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:00:07.134145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:00:07.135246 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1639032, "process_in_blocks": "0", "process_kernel_time": 0.127007, "process_mem_max_rss": "91048", "process_out_blocks": "963", "process_user_time": 1.147099}
[0m14:00:07.135690 [debug] [MainThread]: Command `dbt deps` succeeded at 14:00:07.135609 after 0.16 seconds
[0m14:00:07.136036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cc1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd15cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffe19a0>]}
[0m14:00:07.136395 [debug] [MainThread]: Flushing usage events
[0m14:00:14.092229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:15.199639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fff10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f142610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1425b0>]}


============================== 14:00:15.202740 | 2771f6e0-b374-42e8-9496-c60febf000f5 ==============================
[0m14:00:15.202740 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:00:15.203502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:00:15.327217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1890d00>]}
[0m14:00:15.371708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f18f520>]}
[0m14:00:15.372501 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:00:15.428974 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:00:15.502964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:15.503645 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/mart/transformed_data.sql
[0m14:00:15.709595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df17130>]}
[0m14:00:15.765268 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:00:15.768011 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:00:15.780275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9deb3760>]}
[0m14:00:15.780770 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:00:15.781406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df25d60>]}
[0m14:00:15.782717 [info ] [MainThread]: 
[0m14:00:15.783171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:15.783871 [info ] [MainThread]: 
[0m14:00:15.784724 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:15.790650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:00:15.856757 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:00:15.857414 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:00:15.857929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:15.866893 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m14:00:15.868107 [debug] [ThreadPool]: On list_analytics: Close
[0m14:00:15.869639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:00:15.875003 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:00:15.875437 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:00:15.875805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:15.881848 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:00:15.882238 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:00:15.882556 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:00:15.885173 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:00:15.886280 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:00:15.886704 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:00:15.891196 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:15.891573 [debug] [MainThread]: On master: BEGIN
[0m14:00:15.891847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:15.898007 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:00:15.898365 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:15.898760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:15.901852 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:00:15.902964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17caee0>]}
[0m14:00:15.903401 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:15.903863 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:15.904162 [debug] [MainThread]: On master: BEGIN
[0m14:00:15.904634 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:00:15.904963 [debug] [MainThread]: On master: COMMIT
[0m14:00:15.905245 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:15.905508 [debug] [MainThread]: On master: COMMIT
[0m14:00:15.905867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:00:15.906143 [debug] [MainThread]: On master: Close
[0m14:00:15.914050 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:00:15.914462 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:00:15.916016 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:00:15.915437 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:00:15.914773 [debug] [Thread-3  ]: Began running node model.my_dbt_project.transformed_data
[0m14:00:15.916601 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:00:15.917028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:00:15.917492 [info ] [Thread-3  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:00:15.918002 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:00:15.918448 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:00:15.919043 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:00:15.925984 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:00:15.929730 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:00:15.930332 [debug] [Thread-3  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:00:15.933131 [debug] [Thread-3  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:00:15.935335 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:00:15.935638 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:00:15.948196 [debug] [Thread-3  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:00:15.968834 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:00:15.971081 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:00:15.988061 [debug] [Thread-3  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:00:15.989926 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:00:15.990287 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:00:15.990684 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:00:15.990915 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:00:15.991235 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:00:15.992361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:00:15.992046 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:00:15.991649 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:00:15.993481 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:00:16.007496 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m14:00:16.007932 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:00:16.008356 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:00:16.008677 [debug] [Thread-2  ]: SQL status: BEGIN in 0.017 seconds
[0m14:00:16.009245 [debug] [Thread-3  ]: SQL status: BEGIN in 0.016 seconds
[0m14:00:16.009723 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:00:16.010126 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:00:16.010599 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:00:16.010852 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:00:16.011209 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM ref('stg_crime_reports') AS scr
    LEFT JOIN ref('stg_districts') AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:00:16.017396 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:00:16.017668 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:00:16.018202 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:00:16.018542 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function ref(unknown) does not exist
LINE 21: FROM ref('stg_crime_reports') AS scr
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m14:00:16.021072 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:00:16.021737 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: ROLLBACK
[0m14:00:16.021939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:00:16.022377 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:00:16.023138 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: Close
[0m14:00:16.035187 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:00:16.036215 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:00:16.037747 [debug] [Thread-3  ]: Database Error in model transformed_data (models/mart/transformed_data.sql)
  function ref(unknown) does not exist
  LINE 21: FROM ref('stg_crime_reports') AS scr
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m14:00:16.038042 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:00:16.039452 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:00:16.041041 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3bf4f0>]}
[0m14:00:16.041467 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:00:16.041920 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:00:16.042589 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model public.transformed_data .................. [[31mERROR[0m in 0.12s]
[0m14:00:16.043556 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:00:16.044181 [debug] [Thread-3  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:00:16.044546 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:00:16.045295 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.transformed_data' to be skipped because of status 'error'.  Reason: Database Error in model transformed_data (models/mart/transformed_data.sql)
  function ref(unknown) does not exist
  LINE 21: FROM ref('stg_crime_reports') AS scr
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql.
[0m14:00:16.045616 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m14:00:16.050667 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:00:16.053274 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:00:16.057250 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:00:16.058851 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:00:16.059830 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:00:16.060492 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:00:16.061181 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:00:16.061663 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:00:16.063871 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:00:16.065329 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:00:16.066532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b5c610>]}
[0m14:00:16.067163 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2771f6e0-b374-42e8-9496-c60febf000f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e051100>]}
[0m14:00:16.067817 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:00:16.068756 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:00:16.069437 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:00:16.069982 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:00:16.071638 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:16.071995 [debug] [MainThread]: On master: BEGIN
[0m14:00:16.072274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:16.079330 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:00:16.079710 [debug] [MainThread]: On master: COMMIT
[0m14:00:16.080116 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:16.080460 [debug] [MainThread]: On master: COMMIT
[0m14:00:16.080915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:00:16.081294 [debug] [MainThread]: On master: Close
[0m14:00:16.081779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:16.082158 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:00:16.082447 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:00:16.082749 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:00:16.083172 [info ] [MainThread]: 
[0m14:00:16.083587 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:00:16.084651 [debug] [MainThread]: Command end result
[0m14:00:16.109599 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:00:16.111294 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:00:16.116785 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:00:16.117076 [info ] [MainThread]: 
[0m14:00:16.117482 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:00:16.117895 [info ] [MainThread]: 
[0m14:00:16.118343 [error] [MainThread]:   Database Error in model transformed_data (models/mart/transformed_data.sql)
  function ref(unknown) does not exist
  LINE 21: FROM ref('stg_crime_reports') AS scr
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m14:00:16.118775 [info ] [MainThread]: 
[0m14:00:16.119101 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:00:16.119842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9781862, "process_in_blocks": "0", "process_kernel_time": 0.138544, "process_mem_max_rss": "114940", "process_out_blocks": "2614", "process_user_time": 1.711723}
[0m14:00:16.120233 [debug] [MainThread]: Command `dbt run` failed at 14:00:16.120146 after 0.98 seconds
[0m14:00:16.120767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fff10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1890d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9deea760>]}
[0m14:00:16.121200 [debug] [MainThread]: Flushing usage events
[0m14:00:22.479474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:01.690542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f500460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e646790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6467f0>]}


============================== 14:01:01.697405 | 446b13da-32ff-4c2c-abe8-b16c41c6902a ==============================
[0m14:01:01.697405 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:01.698108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:01:01.778208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '446b13da-32ff-4c2c-abe8-b16c41c6902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d71be0>]}
[0m14:01:01.786517 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:01:01.788325 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:01:01.789242 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14226171, "process_in_blocks": "0", "process_kernel_time": 0.156192, "process_mem_max_rss": "90840", "process_out_blocks": "963", "process_user_time": 1.111369}
[0m14:01:01.789798 [debug] [MainThread]: Command `dbt deps` succeeded at 14:01:01.789688 after 0.14 seconds
[0m14:01:01.790186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f500460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e555cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d71be0>]}
[0m14:01:01.790545 [debug] [MainThread]: Flushing usage events
[0m14:01:04.510523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:05.611847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c81160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dc36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dc3640>]}


============================== 14:01:05.615231 | c34e05f2-2a81-43ff-b594-8f715a3efc85 ==============================
[0m14:01:05.615231 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:05.616078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:05.729575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f993d0>]}
[0m14:01:05.769767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944b8d30>]}
[0m14:01:05.770451 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:01:05.824445 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:01:05.909279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:05.910081 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/mart/transformed_data.sql
[0m14:01:06.087856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b96130>]}
[0m14:01:06.142718 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:01:06.145976 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:01:06.158840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b5c2e0>]}
[0m14:01:06.159249 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:01:06.159662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ce40d0>]}
[0m14:01:06.160863 [info ] [MainThread]: 
[0m14:01:06.161197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:06.161526 [info ] [MainThread]: 
[0m14:01:06.161972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:06.165405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:01:06.228000 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:01:06.228544 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:01:06.228911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:06.237083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:01:06.238085 [debug] [ThreadPool]: On list_analytics: Close
[0m14:01:06.239250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:01:06.244126 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:06.244463 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:01:06.244743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:06.250794 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:01:06.251247 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:06.251757 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:01:06.254509 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:01:06.255693 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:01:06.256099 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:01:06.260190 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.260532 [debug] [MainThread]: On master: BEGIN
[0m14:01:06.260809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:06.266993 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:01:06.267372 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.267716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:06.270925 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:01:06.271941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9641e1f0>]}
[0m14:01:06.272354 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:06.272752 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.273096 [debug] [MainThread]: On master: BEGIN
[0m14:01:06.273544 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:01:06.273883 [debug] [MainThread]: On master: COMMIT
[0m14:01:06.274154 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.274411 [debug] [MainThread]: On master: COMMIT
[0m14:01:06.274772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:01:06.275048 [debug] [MainThread]: On master: Close
[0m14:01:06.280836 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:01:06.281183 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:01:06.281559 [debug] [Thread-3  ]: Began running node model.my_dbt_project.transformed_data
[0m14:01:06.282093 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:01:06.282801 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:01:06.283439 [info ] [Thread-3  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:01:06.284082 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:01:06.284592 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:01:06.285181 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:01:06.285598 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:01:06.286079 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:01:06.286538 [debug] [Thread-3  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:01:06.292930 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.296019 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:01:06.298063 [debug] [Thread-3  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:01:06.301416 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:01:06.301800 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:01:06.309266 [debug] [Thread-3  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:01:06.333941 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:01:06.336088 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.352746 [debug] [Thread-3  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:01:06.357465 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.358364 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:01:06.358064 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:06.357827 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:06.358691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:06.359027 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:01:06.359347 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:01:06.360019 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:01:06.360637 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:01:06.377003 [debug] [Thread-2  ]: SQL status: BEGIN in 0.016 seconds
[0m14:01:06.377381 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m14:01:06.377793 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:06.378148 [debug] [Thread-3  ]: SQL status: BEGIN in 0.018 seconds
[0m14:01:06.379313 [debug] [Thread-3  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:06.378941 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:01:06.378507 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.380311 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:01:06.379699 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM { { ref('stg_crime_reports') } } AS scr
    LEFT JOIN { { ref('stg_districts') } } AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:01:06.381057 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 21: FROM { { ref('stg_crime_reports') } } AS scr
              ^

[0m14:01:06.381418 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:01:06.381791 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: ROLLBACK
[0m14:01:06.387849 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:01:06.388118 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:06.388612 [debug] [Thread-3  ]: On model.my_dbt_project.transformed_data: Close
[0m14:01:06.390942 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.391331 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:01:06.393099 [debug] [Thread-3  ]: Database Error in model transformed_data (models/mart/transformed_data.sql)
  syntax error at or near "{"
  LINE 21: FROM { { ref('stg_crime_reports') } } AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m14:01:06.393561 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:01:06.395661 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:01:06.396145 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fc0070>]}
[0m14:01:06.403094 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:01:06.408709 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:01:06.409345 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model public.transformed_data .................. [[31mERROR[0m in 0.11s]
[0m14:01:06.411531 [debug] [Thread-3  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:01:06.411048 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:06.410590 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:01:06.412003 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.transformed_data' to be skipped because of status 'error'.  Reason: Database Error in model transformed_data (models/mart/transformed_data.sql)
  syntax error at or near "{"
  LINE 21: FROM { { ref('stg_crime_reports') } } AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql.
[0m14:01:06.412429 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:01:06.412799 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.413573 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:01:06.414727 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m14:01:06.414994 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:01:06.419923 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:01:06.421837 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:01:06.425128 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:06.425681 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:06.426059 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:01:06.426385 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:01:06.426920 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:01:06.427372 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:01:06.429410 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:01:06.430500 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:01:06.431090 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964f0e80>]}
[0m14:01:06.431606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34e05f2-2a81-43ff-b594-8f715a3efc85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cc6790>]}
[0m14:01:06.432164 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:01:06.432818 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:01:06.433467 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:01:06.433912 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:01:06.435274 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.435587 [debug] [MainThread]: On master: BEGIN
[0m14:01:06.435882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:06.442394 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:01:06.442794 [debug] [MainThread]: On master: COMMIT
[0m14:01:06.443086 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.443350 [debug] [MainThread]: On master: COMMIT
[0m14:01:06.443718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:01:06.443990 [debug] [MainThread]: On master: Close
[0m14:01:06.444350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:06.444627 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:01:06.444909 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:01:06.445146 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:01:06.445486 [info ] [MainThread]: 
[0m14:01:06.445882 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:01:06.446754 [debug] [MainThread]: Command end result
[0m14:01:06.471898 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:01:06.473761 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:01:06.480701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:01:06.480984 [info ] [MainThread]: 
[0m14:01:06.481343 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:01:06.481702 [info ] [MainThread]: 
[0m14:01:06.482219 [error] [MainThread]:   Database Error in model transformed_data (models/mart/transformed_data.sql)
  syntax error at or near "{"
  LINE 21: FROM { { ref('stg_crime_reports') } } AS scr
                ^
  compiled code at target/run/my_dbt_project/models/mart/transformed_data.sql
[0m14:01:06.482692 [info ] [MainThread]: 
[0m14:01:06.483048 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:01:06.483852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9137649, "process_in_blocks": "0", "process_kernel_time": 0.118764, "process_mem_max_rss": "114896", "process_out_blocks": "2613", "process_user_time": 1.685847}
[0m14:01:06.484289 [debug] [MainThread]: Command `dbt run` failed at 14:01:06.484201 after 0.91 seconds
[0m14:01:06.484694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c81160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c0d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b6a730>]}
[0m14:01:06.484990 [debug] [MainThread]: Flushing usage events
[0m14:01:08.236341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:48.874017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803168b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80316910>]}


============================== 14:01:48.879798 | a2086368-3211-41be-80da-23dfc8950b52 ==============================
[0m14:01:48.879798 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:48.880541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:48.966486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2086368-3211-41be-80da-23dfc8950b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a69dc0>]}
[0m14:01:48.974303 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:01:48.976123 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:01:48.976991 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15301016, "process_in_blocks": "0", "process_kernel_time": 0.118487, "process_mem_max_rss": "90904", "process_out_blocks": "963", "process_user_time": 1.193916}
[0m14:01:48.977474 [debug] [MainThread]: Command `dbt deps` succeeded at 14:01:48.977357 after 0.15 seconds
[0m14:01:48.977897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80220cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80242430>]}
[0m14:01:48.978296 [debug] [MainThread]: Flushing usage events
[0m14:01:53.388995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:54.627175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839f10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b425e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b42580>]}


============================== 14:01:54.630545 | c0fc96b7-356f-4943-afe0-bab67e4451ed ==============================
[0m14:01:54.630545 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:54.631278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:01:54.750725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81eb9850>]}
[0m14:01:54.797126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e71a90>]}
[0m14:01:54.798086 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:01:54.855636 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:01:54.932455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:54.933066 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/mart/transformed_data.sql
[0m14:01:55.115720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8191b130>]}
[0m14:01:55.172317 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:01:55.175242 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:01:55.188440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818c00a0>]}
[0m14:01:55.188910 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:01:55.189278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818b69a0>]}
[0m14:01:55.190614 [info ] [MainThread]: 
[0m14:01:55.190958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:55.191266 [info ] [MainThread]: 
[0m14:01:55.191855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:55.195541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:01:55.262341 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:01:55.262952 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:01:55.263312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:55.273155 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:01:55.274346 [debug] [ThreadPool]: On list_analytics: Close
[0m14:01:55.275870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:01:55.281186 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:55.281520 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:01:55.281815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:55.288205 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:01:55.288840 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:55.289178 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:01:55.291805 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:01:55.293002 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:01:55.293400 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:01:55.297522 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.297877 [debug] [MainThread]: On master: BEGIN
[0m14:01:55.298145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:55.304323 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:01:55.304680 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.305048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:55.307955 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:01:55.309020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851ab8e0>]}
[0m14:01:55.309447 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:55.309879 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.310185 [debug] [MainThread]: On master: BEGIN
[0m14:01:55.310765 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:01:55.311227 [debug] [MainThread]: On master: COMMIT
[0m14:01:55.311637 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.312029 [debug] [MainThread]: On master: COMMIT
[0m14:01:55.312579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:01:55.313069 [debug] [MainThread]: On master: Close
[0m14:01:55.319412 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:01:55.319833 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:01:55.320398 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:01:55.321260 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:01:55.322134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:01:55.322927 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:01:55.324365 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:01:55.326251 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:01:55.339068 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.342819 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:01:55.345429 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:01:55.345888 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:01:55.382091 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.382771 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:01:55.384555 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.385538 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:01:55.385827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:55.385312 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:55.386404 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:01:55.386970 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:01:55.395658 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:01:55.396280 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.396688 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:01:55.397952 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m14:01:55.398497 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:55.399078 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:01:55.399514 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:01:55.405238 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.405934 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:01:55.405555 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:01:55.408754 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:55.409299 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:01:55.408979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:01:55.417646 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:01:55.421320 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:01:55.422400 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:01:55.422804 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.423287 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:55.423755 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:01:55.424149 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:01:55.425280 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:01:55.425518 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m14:01:55.431326 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:01:55.436399 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:01:55.436721 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:01:55.433228 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:01:55.437579 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:01:55.437896 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:01:55.437171 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:01:55.438320 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:01:55.441187 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:01:55.440209 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:01:55.443175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852da430>]}
[0m14:01:55.443788 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:01:55.444403 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:01:55.442636 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bca6a0>]}
[0m14:01:55.445161 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:01:55.445708 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:01:55.446491 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:01:55.447047 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:01:55.447571 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:01:55.448067 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:01:55.450956 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:01:55.452431 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:01:55.470479 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:01:55.471843 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:55.472179 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:01:55.472487 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:01:55.478903 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m14:01:55.479251 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:55.479531 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:01:55.487644 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m14:01:55.490470 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:55.490852 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m14:01:55.491408 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:01:55.493793 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:55.494137 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m14:01:55.494684 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:01:55.499922 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:01:55.500306 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:55.500644 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:01:55.501992 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m14:01:55.504984 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m14:01:55.506740 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:01:55.507021 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m14:01:55.508761 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:01:55.509722 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m14:01:55.510216 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0fc96b7-356f-4943-afe0-bab67e4451ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d28e20>]}
[0m14:01:55.510832 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m14:01:55.511350 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:01:55.512436 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.512746 [debug] [MainThread]: On master: BEGIN
[0m14:01:55.512969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:55.518838 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:01:55.519218 [debug] [MainThread]: On master: COMMIT
[0m14:01:55.519509 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.519792 [debug] [MainThread]: On master: COMMIT
[0m14:01:55.520189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:01:55.520458 [debug] [MainThread]: On master: Close
[0m14:01:55.520825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:55.521088 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:01:55.521343 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:01:55.521560 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:01:55.521897 [info ] [MainThread]: 
[0m14:01:55.522283 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:01:55.523184 [debug] [MainThread]: Command end result
[0m14:01:55.551169 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:01:55.553928 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:01:55.562805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:01:55.563238 [info ] [MainThread]: 
[0m14:01:55.563857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:55.564492 [info ] [MainThread]: 
[0m14:01:55.565162 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:01:55.566350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.98338914, "process_in_blocks": "0", "process_kernel_time": 0.103067, "process_mem_max_rss": "114340", "process_out_blocks": "2617", "process_user_time": 1.77517}
[0m14:01:55.566830 [debug] [MainThread]: Command `dbt run` succeeded at 14:01:55.566736 after 0.98 seconds
[0m14:01:55.567219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839f10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81eb9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81aef700>]}
[0m14:01:55.567679 [debug] [MainThread]: Flushing usage events
[0m14:02:01.751832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:02.993918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7f1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a942820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a942880>]}


============================== 14:02:02.997166 | 202c78df-1372-4338-b41b-6fac3713bb19 ==============================
[0m14:02:02.997166 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:02:02.998006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:02:03.119687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '202c78df-1372-4338-b41b-6fac3713bb19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9a8940>]}
[0m14:02:03.160359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '202c78df-1372-4338-b41b-6fac3713bb19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5fea90>]}
[0m14:02:03.161049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:02:03.214867 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:02:03.290919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:03.291327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:03.315392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '202c78df-1372-4338-b41b-6fac3713bb19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79834130>]}
[0m14:02:03.325416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '202c78df-1372-4338-b41b-6fac3713bb19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79867b20>]}
[0m14:02:03.325810 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:02:03.326201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '202c78df-1372-4338-b41b-6fac3713bb19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79867a60>]}
[0m14:02:03.327347 [info ] [MainThread]: 
[0m14:02:03.327793 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:03.328180 [info ] [MainThread]: 
[0m14:02:03.328773 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:03.332461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:02:03.364097 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:02:03.364545 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:02:03.364886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:03.375349 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:02:03.375790 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:02:03.376166 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:02:03.381936 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m14:02:03.383383 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:02:03.384401 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:02:03.389116 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:03.389694 [debug] [MainThread]: On master: BEGIN
[0m14:02:03.390121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:03.398398 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:02:03.398903 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:03.399370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:02:03.403272 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m14:02:03.404784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '202c78df-1372-4338-b41b-6fac3713bb19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79867d60>]}
[0m14:02:03.405207 [debug] [MainThread]: On master: ROLLBACK
[0m14:02:03.405616 [debug] [MainThread]: On master: Close
[0m14:02:03.408231 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:02:03.408579 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:02:03.409128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:02:03.409711 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:02:03.410095 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:02:03.410509 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:02:03.418319 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:02:03.420564 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:02:03.422033 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:02:03.422812 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:02:03.423252 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:02:03.424040 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:02:03.424715 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:02:03.425213 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:02:03.425518 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:02:03.428333 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:02:03.429239 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:02:03.429758 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:02:03.430610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:03.430919 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:02:03.431160 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:02:03.431349 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:02:03.432028 [debug] [MainThread]: Command end result
[0m14:02:03.486158 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:02:03.488690 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:02:03.494541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:02:03.498696 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:02:03.498975 [info ] [MainThread]: Building catalog
[0m14:02:03.506008 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:02:03.512083 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:02:03.512411 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:02:03.512739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:03.526567 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:02:03.530138 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:02:03.531567 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:02:03.545075 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.012 seconds
[0m14:02:03.559872 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:02:03.565136 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:02:03.601319 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m14:02:03.671770 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:02:03.673660 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:02:03.673958 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m14:02:03.675371 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.7244531, "process_in_blocks": "0", "process_kernel_time": 0.143278, "process_mem_max_rss": "108744", "process_out_blocks": "5027", "process_user_time": 1.493901}
[0m14:02:03.675948 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:02:03.675832 after 0.73 seconds
[0m14:02:03.676261 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:02:03.676492 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:02:03.676788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7f1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b684f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2af160>]}
[0m14:02:03.677113 [debug] [MainThread]: Flushing usage events
[0m14:02:07.434365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:47.459071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9901400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a46850>]}


============================== 14:03:47.465081 | 24a9fcec-2252-4fbb-84e7-3893fb5aca9c ==============================
[0m14:03:47.465081 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:47.465815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:47.547319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24a9fcec-2252-4fbb-84e7-3893fb5aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ee29a0>]}
[0m14:03:47.554642 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:03:47.556222 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:03:47.557167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14209667, "process_in_blocks": "0", "process_kernel_time": 0.112015, "process_mem_max_rss": "90996", "process_out_blocks": "963", "process_user_time": 1.098156}
[0m14:03:47.557674 [debug] [MainThread]: Command `dbt deps` succeeded at 14:03:47.557578 after 0.14 seconds
[0m14:03:47.558032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9901400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8955cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ee29a0>]}
[0m14:03:47.558385 [debug] [MainThread]: Flushing usage events
[0m14:03:50.851178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:52.060585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dff10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1425e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d142580>]}


============================== 14:03:52.063578 | fe4c05fb-4411-488f-ade2-4b03699a89f4 ==============================
[0m14:03:52.063578 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:52.064256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:52.177919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4b9850>]}
[0m14:03:52.218074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c470a90>]}
[0m14:03:52.218741 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:52.275845 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:03:52.349902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:52.350285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:52.374130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c032130>]}
[0m14:03:52.428783 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:03:52.431622 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:03:52.444371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c020160>]}
[0m14:03:52.444791 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:03:52.445285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c070af0>]}
[0m14:03:52.446636 [info ] [MainThread]: 
[0m14:03:52.447026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:03:52.447351 [info ] [MainThread]: 
[0m14:03:52.447818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:52.451298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:03:52.479742 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:03:52.480208 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:03:52.480630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:52.489511 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m14:03:52.490521 [debug] [ThreadPool]: On list_analytics: Close
[0m14:03:52.491931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:03:52.496749 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:03:52.497074 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:03:52.497366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:52.503837 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:03:52.504262 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:03:52.504563 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:52.507076 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:03:52.508041 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:03:52.508430 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:03:52.512350 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:52.512746 [debug] [MainThread]: On master: BEGIN
[0m14:03:52.513056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:52.519126 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:03:52.519553 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:52.519958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:52.523099 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:03:52.524204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0627c0>]}
[0m14:03:52.524649 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:52.525049 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:52.525319 [debug] [MainThread]: On master: BEGIN
[0m14:03:52.525844 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:03:52.526340 [debug] [MainThread]: On master: COMMIT
[0m14:03:52.526708 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:52.527025 [debug] [MainThread]: On master: COMMIT
[0m14:03:52.527457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:52.527788 [debug] [MainThread]: On master: Close
[0m14:03:52.533618 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:03:52.533891 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:03:52.534377 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:03:52.534840 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:03:52.535384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:03:52.535856 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:03:52.536169 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:03:52.536498 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:03:52.543511 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.545613 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:03:52.548128 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:03:52.548629 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:03:52.581264 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:03:52.583187 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.585213 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:03:52.585922 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:03:52.586336 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:03:52.585673 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.587008 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:03:52.587599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:52.596014 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m14:03:52.597547 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:03:52.597923 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:03:52.598463 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:03:52.598947 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.599404 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:03:52.599727 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:03:52.605163 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:03:52.605845 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:03:52.605462 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:03:52.609524 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.610177 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:03:52.609809 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:03:52.657413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.046 seconds
[0m14:03:52.670913 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:03:52.672668 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:03:52.673427 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:03:52.673877 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.674535 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:03:52.675063 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:03:52.676260 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:52.676552 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:52.684417 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:03:52.682031 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:03:52.688715 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:03:52.689125 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:03:52.688057 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:03:52.689961 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:03:52.689735 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:03:52.692553 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:03:52.694208 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8da430>]}
[0m14:03:52.690533 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:03:52.694893 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:03:52.697199 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:03:52.696562 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:03:52.698117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3c8730>]}
[0m14:03:52.698704 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:03:52.699360 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:03:52.700231 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:03:52.700781 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:03:52.701493 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:03:52.701939 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:03:52.704764 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:03:52.707153 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:03:52.725860 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:03:52.727238 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:03:52.727699 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:03:52.728113 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:03:52.735059 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m14:03:52.735526 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:03:52.735943 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:03:52.744493 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m14:03:52.747571 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:03:52.747975 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m14:03:52.748656 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:52.752417 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:03:52.752757 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m14:03:52.753208 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:52.758478 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:03:52.758844 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:03:52.759143 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:03:52.760040 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:52.762208 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m14:03:52.764060 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:03:52.764371 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m14:03:52.765957 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:03:52.766958 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m14:03:52.767491 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe4c05fb-4411-488f-ade2-4b03699a89f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3a8460>]}
[0m14:03:52.768033 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m14:03:52.768625 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:03:52.769749 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:52.770129 [debug] [MainThread]: On master: BEGIN
[0m14:03:52.770382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:52.776553 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:03:52.777055 [debug] [MainThread]: On master: COMMIT
[0m14:03:52.777432 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:52.777778 [debug] [MainThread]: On master: COMMIT
[0m14:03:52.778291 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:52.778602 [debug] [MainThread]: On master: Close
[0m14:03:52.779033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:52.779401 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:03:52.779669 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:03:52.779924 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:03:52.780351 [info ] [MainThread]: 
[0m14:03:52.780781 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:03:52.781737 [debug] [MainThread]: Command end result
[0m14:03:52.805505 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:03:52.807012 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:03:52.812595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:03:52.812862 [info ] [MainThread]: 
[0m14:03:52.813205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:52.813578 [info ] [MainThread]: 
[0m14:03:52.813954 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:03:52.814776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7967585, "process_in_blocks": "0", "process_kernel_time": 0.106834, "process_mem_max_rss": "111368", "process_out_blocks": "1793", "process_user_time": 1.540606}
[0m14:03:52.815174 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:52.815106 after 0.80 seconds
[0m14:03:52.815467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dff10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4f3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de8c7c0>]}
[0m14:03:52.815785 [debug] [MainThread]: Flushing usage events
[0m14:03:54.236123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:55.379361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd71190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae827f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae82850>]}


============================== 14:03:55.382427 | e2494ab7-8389-4ba0-a479-86f339ac98a3 ==============================
[0m14:03:55.382427 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:55.383204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:03:55.495308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2494ab7-8389-4ba0-a479-86f339ac98a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aeda190>]}
[0m14:03:55.535563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2494ab7-8389-4ba0-a479-86f339ac98a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a225fd0>]}
[0m14:03:55.536177 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:55.591168 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:03:55.664795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:55.665228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:55.689746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2494ab7-8389-4ba0-a479-86f339ac98a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79db39d0>]}
[0m14:03:55.698408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2494ab7-8389-4ba0-a479-86f339ac98a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79de5b80>]}
[0m14:03:55.698836 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:03:55.699244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2494ab7-8389-4ba0-a479-86f339ac98a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79de5ac0>]}
[0m14:03:55.700461 [info ] [MainThread]: 
[0m14:03:55.700787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:03:55.701079 [info ] [MainThread]: 
[0m14:03:55.701550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:55.705007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:03:55.732561 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:03:55.732941 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:03:55.733275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:55.740608 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:03:55.741069 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:03:55.741413 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:55.743430 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:03:55.744526 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:03:55.744933 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:03:55.749246 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.749566 [debug] [MainThread]: On master: BEGIN
[0m14:03:55.749841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:55.756001 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:03:55.756447 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.756823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:55.759540 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m14:03:55.760965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2494ab7-8389-4ba0-a479-86f339ac98a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79de5d30>]}
[0m14:03:55.761489 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:55.761959 [debug] [MainThread]: On master: Close
[0m14:03:55.764450 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:03:55.764774 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:03:55.765220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:03:55.765730 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:03:55.766092 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:03:55.766489 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:03:55.774114 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:03:55.775836 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:03:55.777116 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:03:55.777809 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:03:55.778070 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:03:55.778733 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:03:55.779381 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:03:55.779805 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:03:55.780129 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:03:55.782707 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:03:55.783451 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:03:55.783925 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:03:55.784775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:55.785059 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:03:55.785343 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:03:55.785566 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:03:55.786191 [debug] [MainThread]: Command end result
[0m14:03:55.840212 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:03:55.842883 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:03:55.848693 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:03:55.853772 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:03:55.854065 [info ] [MainThread]: Building catalog
[0m14:03:55.861309 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:03:55.867249 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:03:55.867692 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:03:55.868119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:55.874858 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:03:55.875292 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:03:55.875653 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:03:55.878607 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m14:03:55.881739 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:03:55.882144 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:03:55.891814 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m14:03:55.954770 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:03:55.956710 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:03:55.957119 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m14:03:55.958192 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.62216324, "process_in_blocks": "0", "process_kernel_time": 0.105145, "process_mem_max_rss": "108680", "process_out_blocks": "5027", "process_user_time": 1.401934}
[0m14:03:55.958789 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:03:55.958658 after 0.62 seconds
[0m14:03:55.959224 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:03:55.959533 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:03:55.959833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd71190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ed3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ed3550>]}
[0m14:03:55.960160 [debug] [MainThread]: Flushing usage events
[0m14:03:57.148782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:58.274760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9010d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba429a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba42a00>]}


============================== 14:03:58.277724 | 842dd899-80e8-49e1-9422-b413f2bc8947 ==============================
[0m14:03:58.277724 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:58.278530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:58.394880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842dd899-80e8-49e1-9422-b413f2bc8947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e16fd00>]}
[0m14:03:58.435296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '842dd899-80e8-49e1-9422-b413f2bc8947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfdcd90>]}
[0m14:17:56.545308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e316880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3168e0>]}


============================== 14:17:56.551085 | 64c11492-a955-4f1e-b67e-66ad8e3dc8ae ==============================
[0m14:17:56.551085 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:17:56.551767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:56.640137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64c11492-a955-4f1e-b67e-66ad8e3dc8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e382700>]}
[0m14:17:56.647556 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:17:56.649595 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:17:56.650567 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1466703, "process_in_blocks": "0", "process_kernel_time": 0.140142, "process_mem_max_rss": "90884", "process_out_blocks": "963", "process_user_time": 1.11213}
[0m14:17:56.651031 [debug] [MainThread]: Command `dbt deps` succeeded at 14:17:56.650943 after 0.15 seconds
[0m14:17:56.651383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e220cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e382700>]}
[0m14:17:56.651804 [debug] [MainThread]: Flushing usage events
[0m14:18:01.029872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:02.150734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82043640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820435e0>]}


============================== 14:18:02.153508 | f0414c86-d6ef-494d-b850-6205a14114e0 ==============================
[0m14:18:02.153508 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:18:02.154212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:18:02.269598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847d80a0>]}
[0m14:18:02.310185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8141e130>]}
[0m14:18:02.310941 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:18:02.367884 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:18:02.443596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:02.444079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:02.470466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f319a0>]}
[0m14:18:02.528556 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:18:02.531536 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:18:02.544807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f623d0>]}
[0m14:18:02.545254 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:18:02.545668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812b3640>]}
[0m14:18:02.547015 [info ] [MainThread]: 
[0m14:18:02.547390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:02.547723 [info ] [MainThread]: 
[0m14:18:02.548245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:02.551741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:18:02.580971 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:18:02.581486 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:18:02.581898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:02.590009 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:18:02.591170 [debug] [ThreadPool]: On list_analytics: Close
[0m14:18:02.592390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:18:02.597447 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:18:02.597769 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:18:02.598063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:02.604160 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:18:02.604657 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:18:02.605076 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:18:02.607517 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:18:02.608594 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:18:02.608994 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:18:02.613182 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:02.613491 [debug] [MainThread]: On master: BEGIN
[0m14:18:02.613769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:02.619616 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:18:02.620017 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:02.620443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:18:02.623522 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:18:02.624592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8034c190>]}
[0m14:18:02.625006 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:02.625420 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:02.625715 [debug] [MainThread]: On master: BEGIN
[0m14:18:02.626236 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:18:02.626667 [debug] [MainThread]: On master: COMMIT
[0m14:18:02.626995 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:02.627300 [debug] [MainThread]: On master: COMMIT
[0m14:18:02.627710 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:18:02.628057 [debug] [MainThread]: On master: Close
[0m14:18:02.638910 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:18:02.641233 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:18:02.643149 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:18:02.646085 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:18:02.650462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:18:02.653136 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:18:02.654534 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:18:02.656609 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:18:02.670558 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.672815 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:18:02.675067 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:18:02.681726 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:18:02.707093 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.707532 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:18:02.710148 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.711020 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:18:02.711426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:18:02.710713 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:18:02.712295 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:18:02.712981 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:18:02.719887 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:18:02.720376 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.720845 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:18:02.722067 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m14:18:02.722543 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:18:02.722917 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:18:02.723211 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:18:02.728450 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.729022 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:18:02.728714 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:18:02.732408 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:18:02.732955 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:18:02.732670 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:18:02.773907 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.040 seconds
[0m14:18:02.781664 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:18:02.782041 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:18:02.782387 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:18:02.780519 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:18:02.782900 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.783251 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:18:02.783521 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m14:18:02.788501 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:18:02.788744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m14:18:02.791879 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:18:02.793777 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:18:02.794129 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:18:02.794667 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:18:02.795523 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:18:02.795256 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:18:02.796056 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:18:02.799275 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:18:02.798022 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:18:02.801776 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84770ee0>]}
[0m14:18:02.801218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802c37f0>]}
[0m14:18:02.802399 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:18:02.803877 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:18:02.803191 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:18:02.804565 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:18:02.805340 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:18:02.805852 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:18:02.806474 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:18:02.806905 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:18:02.809751 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:18:02.811556 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:18:02.830112 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:18:02.831967 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:18:02.832331 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:18:02.832675 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:18:02.839257 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m14:18:02.839738 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:18:02.840101 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:18:02.847985 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.007 seconds
[0m14:18:02.850905 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:18:02.851246 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m14:18:02.851800 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:18:02.855422 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:18:02.855756 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m14:18:02.856223 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:18:02.861532 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:18:02.861945 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:18:02.862361 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:18:02.863820 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m14:18:02.865917 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m14:18:02.867773 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:18:02.868087 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m14:18:02.869784 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:18:02.870812 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m14:18:02.871365 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0414c86-d6ef-494d-b850-6205a14114e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801ff9a0>]}
[0m14:18:02.871890 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m14:18:02.872475 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:18:02.873503 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:02.873836 [debug] [MainThread]: On master: BEGIN
[0m14:18:02.874079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:02.880245 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:18:02.880726 [debug] [MainThread]: On master: COMMIT
[0m14:18:02.881089 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:02.881402 [debug] [MainThread]: On master: COMMIT
[0m14:18:02.881801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:18:02.882093 [debug] [MainThread]: On master: Close
[0m14:18:02.882484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:02.882777 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:18:02.883051 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:18:02.883321 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:18:02.883728 [info ] [MainThread]: 
[0m14:18:02.884150 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:18:02.885086 [debug] [MainThread]: Command end result
[0m14:18:02.910870 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:18:02.912573 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:18:02.918635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:18:02.918960 [info ] [MainThread]: 
[0m14:18:02.919367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:02.919792 [info ] [MainThread]: 
[0m14:18:02.920224 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:18:02.921118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.81130123, "process_in_blocks": "0", "process_kernel_time": 0.118271, "process_mem_max_rss": "111240", "process_out_blocks": "1793", "process_user_time": 1.539537}
[0m14:18:02.921514 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:02.921443 after 0.81 seconds
[0m14:18:02.921879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82df0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8141e130>]}
[0m14:18:02.922301 [debug] [MainThread]: Flushing usage events
[0m14:18:05.879429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:06.994713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af71100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a082880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0828e0>]}


============================== 14:18:06.997622 | 87b96592-07d9-4127-a104-e29586f7e12d ==============================
[0m14:18:06.997622 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:18:06.998175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:18:07.116090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87b96592-07d9-4127-a104-e29586f7e12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a549b80>]}
[0m14:18:07.156772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87b96592-07d9-4127-a104-e29586f7e12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893c0b20>]}
[0m14:18:07.157504 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:18:07.212505 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:18:07.285285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:07.285691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:07.310849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87b96592-07d9-4127-a104-e29586f7e12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fb4130>]}
[0m14:18:07.319666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87b96592-07d9-4127-a104-e29586f7e12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fe7ac0>]}
[0m14:18:07.320120 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:18:07.320614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b96592-07d9-4127-a104-e29586f7e12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fe7a00>]}
[0m14:18:07.322028 [info ] [MainThread]: 
[0m14:18:07.322470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:07.322789 [info ] [MainThread]: 
[0m14:18:07.323285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:07.326917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:18:07.356088 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:18:07.356458 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:18:07.356699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:07.363473 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:18:07.363885 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:18:07.364200 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:18:07.366094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:18:07.367190 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:18:07.367651 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:18:07.372111 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:07.372415 [debug] [MainThread]: On master: BEGIN
[0m14:18:07.372677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:07.378687 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:18:07.379155 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:07.379583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:18:07.382725 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m14:18:07.384092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b96592-07d9-4127-a104-e29586f7e12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fe7c40>]}
[0m14:18:07.384540 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:07.384955 [debug] [MainThread]: On master: Close
[0m14:18:07.387395 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:18:07.387702 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:18:07.388159 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:18:07.388692 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:18:07.389082 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:18:07.389467 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:18:07.396293 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:18:07.398086 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:18:07.399286 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:18:07.399953 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:18:07.400167 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:18:07.400920 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:18:07.401668 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:18:07.402207 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:18:07.402631 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:18:07.405289 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:18:07.406028 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:18:07.406634 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:18:07.407456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:07.407736 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:18:07.407959 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:18:07.408154 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:18:07.408774 [debug] [MainThread]: Command end result
[0m14:18:07.464037 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:18:07.466566 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:18:07.472748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:18:07.477446 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:18:07.477691 [info ] [MainThread]: Building catalog
[0m14:18:07.484797 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:18:07.490997 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:18:07.491371 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:18:07.491698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:07.498220 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:18:07.498601 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:18:07.498962 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:18:07.501742 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m14:18:07.504879 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:18:07.505292 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:18:07.515033 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m14:18:07.579038 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:18:07.580998 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:18:07.581325 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m14:18:07.582437 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.62985694, "process_in_blocks": "0", "process_kernel_time": 0.09644, "process_mem_max_rss": "108844", "process_out_blocks": "5027", "process_user_time": 1.399388}
[0m14:18:07.582988 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:18:07.582882 after 0.63 seconds
[0m14:18:07.583360 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:18:07.583667 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:18:07.583990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af71100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890d43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88400cd0>]}
[0m14:18:07.584331 [debug] [MainThread]: Flushing usage events
[0m14:18:09.633016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:10.721138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d571100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c683670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c683610>]}


============================== 14:18:10.723803 | f4aff3ef-893d-47ec-9b1e-3d47bd7ab803 ==============================
[0m14:18:10.723803 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:18:10.724511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:10.839525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4aff3ef-893d-47ec-9b1e-3d47bd7ab803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c72f250>]}
[0m14:18:10.883506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4aff3ef-893d-47ec-9b1e-3d47bd7ab803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7ba130>]}
[0m14:23:32.398133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad571400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac686820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac686880>]}


============================== 14:23:32.403684 | 38b318b0-30ed-43fe-9723-d5e494f7e508 ==============================
[0m14:23:32.403684 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:32.404318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:32.487281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38b318b0-30ed-43fe-9723-d5e494f7e508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd72940>]}
[0m14:23:32.495087 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:23:32.496892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:23:32.497770 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14395392, "process_in_blocks": "0", "process_kernel_time": 0.114036, "process_mem_max_rss": "90908", "process_out_blocks": "963", "process_user_time": 1.100355}
[0m14:23:32.498216 [debug] [MainThread]: Command `dbt deps` succeeded at 14:23:32.498134 after 0.14 seconds
[0m14:23:32.498620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad571400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac591cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd72940>]}
[0m14:23:32.498963 [debug] [MainThread]: Flushing usage events
[0m14:23:42.001992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:43.148615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da81130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbc2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbc25e0>]}


============================== 14:23:43.151760 | 17243b7e-6755-4f3e-a760-4c7d94b7c97e ==============================
[0m14:23:43.151760 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:43.152419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:43.332558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc29c10>]}
[0m14:23:43.378101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d93e280>]}
[0m14:23:43.379234 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:23:43.442410 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:23:43.523404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:43.523823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:43.549380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bab2130>]}
[0m14:23:43.606395 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:23:43.609516 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:23:43.623268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bae2490>]}
[0m14:23:43.623705 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:23:43.624046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bbce3a0>]}
[0m14:23:43.625420 [info ] [MainThread]: 
[0m14:23:43.625814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:43.626108 [info ] [MainThread]: 
[0m14:23:43.626622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:43.630195 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:23:43.659465 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:23:43.659919 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:23:43.660262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:43.668652 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:23:43.669692 [debug] [ThreadPool]: On list_analytics: Close
[0m14:23:43.670905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:23:43.675490 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:23:43.675813 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:23:43.676096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:43.682291 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:23:43.682874 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:23:43.683191 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:23:43.685547 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:23:43.686570 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:23:43.686952 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:23:43.693735 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:43.694427 [debug] [MainThread]: On master: BEGIN
[0m14:23:43.694816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:43.701404 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:23:43.702029 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:43.702445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:43.705387 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:23:43.706751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aec2220>]}
[0m14:23:43.707250 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:43.707689 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:43.707971 [debug] [MainThread]: On master: BEGIN
[0m14:23:43.708498 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:23:43.708950 [debug] [MainThread]: On master: COMMIT
[0m14:23:43.709248 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:43.709526 [debug] [MainThread]: On master: COMMIT
[0m14:23:43.709888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:43.710163 [debug] [MainThread]: On master: Close
[0m14:23:43.716435 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:23:43.716739 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:23:43.717266 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:23:43.717905 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:23:43.718504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:23:43.719174 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:23:43.719585 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:23:43.719971 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:23:43.727062 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.728730 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:23:43.731156 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:23:43.731666 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:23:43.762216 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:23:43.764193 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.766158 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.766573 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:23:43.767111 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:23:43.767389 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:23:43.766802 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:23:43.768062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:43.774965 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m14:23:43.775382 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:23:43.775801 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:23:43.777312 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:23:43.782393 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:23:43.782921 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:23:43.783287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m14:23:43.783787 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.784309 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:23:43.784011 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:43.794649 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:23:43.801340 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.801699 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:23:43.797550 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:23:43.802225 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:23:43.802762 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:23:43.802474 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:43.803963 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:23:43.804469 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.804776 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:23:43.804186 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m14:23:43.848602 [debug] [Thread-1  ]: SQL status: COMMIT in 0.043 seconds
[0m14:23:43.853323 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:23:43.855338 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:23:43.858678 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:23:43.859259 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:23:43.859600 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:23:43.859947 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:23:43.860584 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:23:43.860807 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:23:43.863832 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:23:43.862825 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:23:43.866043 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2efe50>]}
[0m14:23:43.866649 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:23:43.867265 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:23:43.865532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad50ee0>]}
[0m14:23:43.868118 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:23:43.868753 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:23:43.869737 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:23:43.870304 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:23:43.870881 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:23:43.871336 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:23:43.874201 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:23:43.876632 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:23:43.902637 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:23:43.904669 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:23:43.905170 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:23:43.905615 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:23:43.912687 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m14:23:43.913257 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:23:43.913684 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:23:43.922562 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m14:23:43.925663 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:23:43.925994 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m14:23:43.926624 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:43.930214 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:23:43.930568 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m14:23:43.931095 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:43.936430 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:23:43.936780 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:23:43.937065 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:23:43.938212 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m14:23:43.940160 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m14:23:43.941961 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:23:43.942287 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m14:23:43.943892 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:23:43.944949 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m14:23:43.945545 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17243b7e-6755-4f3e-a760-4c7d94b7c97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba63d00>]}
[0m14:23:43.946185 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m14:23:43.946857 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:23:43.948116 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:43.948455 [debug] [MainThread]: On master: BEGIN
[0m14:23:43.948732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:43.955574 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:23:43.955950 [debug] [MainThread]: On master: COMMIT
[0m14:23:43.956203 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:43.956417 [debug] [MainThread]: On master: COMMIT
[0m14:23:43.956732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:43.956971 [debug] [MainThread]: On master: Close
[0m14:23:43.957332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:43.957601 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:23:43.957939 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:23:43.958228 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:23:43.958594 [info ] [MainThread]: 
[0m14:23:43.958994 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:23:43.959880 [debug] [MainThread]: Command end result
[0m14:23:43.982805 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:23:43.984785 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:23:43.990646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:23:43.990988 [info ] [MainThread]: 
[0m14:23:43.991414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:43.991897 [info ] [MainThread]: 
[0m14:23:43.992336 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:23:43.993254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8889485, "process_in_blocks": "0", "process_kernel_time": 0.12348, "process_mem_max_rss": "111584", "process_out_blocks": "1793", "process_user_time": 1.623315}
[0m14:23:43.993670 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:43.993601 after 0.89 seconds
[0m14:23:43.994044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da81130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d93e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bae2490>]}
[0m14:23:43.994475 [debug] [MainThread]: Flushing usage events
[0m14:23:50.203511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:51.347977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b71130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c83820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c83880>]}


============================== 14:23:51.350723 | 495c23eb-2cb6-416a-9cc0-159d17ac22b8 ==============================
[0m14:23:51.350723 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:51.351425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:51.466283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '495c23eb-2cb6-416a-9cc0-159d17ac22b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ce8940>]}
[0m14:23:51.508371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '495c23eb-2cb6-416a-9cc0-159d17ac22b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb597ea90>]}
[0m14:23:51.509053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:23:51.563019 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:23:51.637168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:51.637643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:51.662635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '495c23eb-2cb6-416a-9cc0-159d17ac22b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bb4130>]}
[0m14:23:51.672790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '495c23eb-2cb6-416a-9cc0-159d17ac22b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3be6b20>]}
[0m14:23:51.673293 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:23:51.673766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '495c23eb-2cb6-416a-9cc0-159d17ac22b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3be6a60>]}
[0m14:23:51.675249 [info ] [MainThread]: 
[0m14:23:51.675647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:51.676019 [info ] [MainThread]: 
[0m14:23:51.676678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:51.680743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:23:51.709933 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:23:51.710368 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:23:51.710698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:51.717803 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:23:51.718217 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:23:51.718599 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:23:51.720760 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:23:51.721896 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:23:51.722397 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:23:51.727083 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:51.727407 [debug] [MainThread]: On master: BEGIN
[0m14:23:51.727674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:51.733897 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:23:51.734279 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:51.734634 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:51.737365 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m14:23:51.738607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '495c23eb-2cb6-416a-9cc0-159d17ac22b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3be6d60>]}
[0m14:23:51.739025 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:51.739452 [debug] [MainThread]: On master: Close
[0m14:23:51.741820 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:23:51.742145 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:23:51.742643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:23:51.743155 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:23:51.743584 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:23:51.743919 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:23:51.750708 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:23:51.752736 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:23:51.754292 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:23:51.754533 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:23:51.755680 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:23:51.755139 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:23:51.756313 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:23:51.756873 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:23:51.757188 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:23:51.759860 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:23:51.761021 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:23:51.761829 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:23:51.762822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:51.763181 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:23:51.763534 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:23:51.763814 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:23:51.764567 [debug] [MainThread]: Command end result
[0m14:23:51.820810 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:23:51.823819 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:23:51.829761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:23:51.834889 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:23:51.835156 [info ] [MainThread]: Building catalog
[0m14:23:51.842459 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:23:51.848578 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:23:51.848927 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:23:51.849224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:51.856127 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:23:51.856625 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:23:51.857004 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:23:51.859702 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m14:23:51.862817 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:23:51.863255 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:23:51.873093 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m14:23:51.929524 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:23:51.931452 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:23:51.931751 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m14:23:51.932761 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.62617, "process_in_blocks": "0", "process_kernel_time": 0.093883, "process_mem_max_rss": "108696", "process_out_blocks": "5027", "process_user_time": 1.407249}
[0m14:23:51.933299 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:23:51.933186 after 0.63 seconds
[0m14:23:51.933666 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:23:51.933932 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:23:51.934264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b71130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3cd3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2fa7f10>]}
[0m14:23:51.934650 [debug] [MainThread]: Flushing usage events
[0m14:23:58.136357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:59.355684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b71130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c83640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c835e0>]}


============================== 14:23:59.358986 | ce1df81b-15cb-4fc7-ac9f-ba74db4a58a1 ==============================
[0m14:23:59.358986 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:59.359751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:59.478032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce1df81b-15cb-4fc7-ac9f-ba74db4a58a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ff3f40>]}
[0m14:23:59.520246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce1df81b-15cb-4fc7-ac9f-ba74db4a58a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3043fa0>]}
[0m14:24:40.431558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf283790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf283730>]}


============================== 14:24:40.435151 | 852af4fd-78d8-4938-a548-5918a60b22b0 ==============================
[0m14:24:40.435151 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:24:40.435855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:40.557990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '852af4fd-78d8-4938-a548-5918a60b22b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae65c1c0>]}
[0m14:24:40.601949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '852af4fd-78d8-4938-a548-5918a60b22b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf972610>]}
[0m14:24:40.614147 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:24:40.615408 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/local/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:24:40.616428 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.22919625, "process_in_blocks": "0", "process_kernel_time": 0.098136, "process_mem_max_rss": "96416", "process_out_blocks": "3344", "process_user_time": 1.092523}
[0m14:24:40.616959 [debug] [MainThread]: Command `dbt docs serve` failed at 14:24:40.616864 after 0.23 seconds
[0m14:24:40.617328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb01711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4b33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae4bbd30>]}
[0m14:24:40.617730 [debug] [MainThread]: Flushing usage events
[0m14:24:44.756376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:21.507578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9b11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99acb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99acb610>]}


============================== 14:25:21.511199 | 260523da-6b63-434b-8147-6cba2fc24c4b ==============================
[0m14:25:21.511199 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:25:21.511845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:21.637886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '260523da-6b63-434b-8147-6cba2fc24c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e8ccd0>]}
[0m14:25:21.680618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '260523da-6b63-434b-8147-6cba2fc24c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e1feb0>]}
[0m14:27:31.160078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3713a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d486820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d486880>]}


============================== 14:27:31.165930 | 557180ae-5d6d-4682-934e-23ed24423c2e ==============================
[0m14:27:31.165930 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:27:31.166736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:31.245767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '557180ae-5d6d-4682-934e-23ed24423c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db56040>]}
[0m14:27:31.253528 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:27:31.255092 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:27:31.255981 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14722025, "process_in_blocks": "0", "process_kernel_time": 0.126265, "process_mem_max_rss": "90948", "process_out_blocks": "963", "process_user_time": 1.12225}
[0m14:27:31.256462 [debug] [MainThread]: Command `dbt deps` succeeded at 14:27:31.256382 after 0.15 seconds
[0m14:27:31.256783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3713a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d390cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db56040>]}
[0m14:27:31.257125 [debug] [MainThread]: Flushing usage events
[0m14:27:37.631972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:38.758394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb2410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba382610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3825b0>]}


============================== 14:27:38.761944 | b1cfa15b-a2cc-48e4-9e64-0c72db377e19 ==============================
[0m14:27:38.761944 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:27:38.762681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:27:38.884693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcac0d00>]}
[0m14:27:38.927949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3d0520>]}
[0m14:27:38.928838 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:38.987379 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:27:39.061122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:39.061518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:39.085474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9272130>]}
[0m14:27:39.141070 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:27:39.143978 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:27:39.156817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92a3550>]}
[0m14:27:39.157328 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:27:39.157759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9280bb0>]}
[0m14:27:39.159131 [info ] [MainThread]: 
[0m14:27:39.159498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:39.159924 [info ] [MainThread]: 
[0m14:27:39.160542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:39.164082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:27:39.193528 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:27:39.194123 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:27:39.194756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:39.206626 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m14:27:39.207730 [debug] [ThreadPool]: On list_analytics: Close
[0m14:27:39.209047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:27:39.214094 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:27:39.214467 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:27:39.214827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:39.220982 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:27:39.221460 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:27:39.221770 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:27:39.224277 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:27:39.225338 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:27:39.225752 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:27:39.229910 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:39.230342 [debug] [MainThread]: On master: BEGIN
[0m14:27:39.230675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:39.236919 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:27:39.237445 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:39.237873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:39.240939 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:27:39.242088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92b92e0>]}
[0m14:27:39.242605 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:39.243023 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:39.243315 [debug] [MainThread]: On master: BEGIN
[0m14:27:39.243794 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:27:39.244209 [debug] [MainThread]: On master: COMMIT
[0m14:27:39.244592 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:39.244972 [debug] [MainThread]: On master: COMMIT
[0m14:27:39.245382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:39.245664 [debug] [MainThread]: On master: Close
[0m14:27:39.250525 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:27:39.250831 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:27:39.251365 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:27:39.252007 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:27:39.252540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:27:39.253004 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:27:39.253351 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:27:39.253699 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:27:39.260553 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.262188 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:27:39.264417 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:27:39.264778 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:27:39.295174 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:27:39.295917 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.297859 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.298264 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:27:39.298807 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:27:39.299104 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:27:39.298488 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:27:39.299638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:39.306115 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m14:27:39.306547 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:27:39.306911 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:27:39.307354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:27:39.307692 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.308043 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:27:39.308599 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:27:39.314351 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:27:39.315017 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:27:39.314650 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:27:39.318795 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.319500 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:27:39.319087 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:27:39.368892 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.049 seconds
[0m14:27:39.375385 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:27:39.377005 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:27:39.377339 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:27:39.376613 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:27:39.377866 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.378169 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:27:39.379274 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m14:27:39.379494 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:27:39.384483 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:27:39.386523 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:27:39.389981 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:27:39.390564 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:27:39.390932 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:27:39.391316 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:27:39.391935 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:27:39.394225 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:27:39.392158 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:27:39.396776 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:27:39.397269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb860b760>]}
[0m14:27:39.397862 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:27:39.398489 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:27:39.395728 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcd8c610>]}
[0m14:27:39.399214 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:27:39.399776 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:27:39.400557 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:27:39.401052 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:27:39.401604 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:27:39.401961 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:27:39.404587 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:27:39.406441 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:27:39.423967 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:27:39.425224 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:27:39.425532 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:27:39.425821 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:27:39.432714 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m14:27:39.433097 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:27:39.433448 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:27:39.441777 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m14:27:39.444523 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:27:39.444848 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m14:27:39.445444 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:39.448865 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:27:39.449162 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m14:27:39.449599 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:39.455226 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:27:39.455633 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:27:39.455976 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:27:39.457309 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m14:27:39.460355 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m14:27:39.463030 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:27:39.463465 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m14:27:39.465293 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:27:39.466835 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m14:27:39.467523 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1cfa15b-a2cc-48e4-9e64-0c72db377e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85de9d0>]}
[0m14:27:39.468225 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m14:27:39.469028 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:27:39.470349 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:39.470705 [debug] [MainThread]: On master: BEGIN
[0m14:27:39.470967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:39.478820 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:27:39.479301 [debug] [MainThread]: On master: COMMIT
[0m14:27:39.479716 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:39.480140 [debug] [MainThread]: On master: COMMIT
[0m14:27:39.480684 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:39.481015 [debug] [MainThread]: On master: Close
[0m14:27:39.481470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:39.481761 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:27:39.481995 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:27:39.482256 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:27:39.482782 [info ] [MainThread]: 
[0m14:27:39.483281 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:27:39.484415 [debug] [MainThread]: Command end result
[0m14:27:39.510521 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:27:39.512412 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:27:39.520064 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:27:39.520488 [info ] [MainThread]: 
[0m14:27:39.520996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:39.521666 [info ] [MainThread]: 
[0m14:27:39.522345 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:27:39.523524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8171671, "process_in_blocks": "0", "process_kernel_time": 0.133049, "process_mem_max_rss": "111128", "process_out_blocks": "1793", "process_user_time": 1.527571}
[0m14:27:39.524064 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:39.523980 after 0.82 seconds
[0m14:27:39.524423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb2410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbdbfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa99e80>]}
[0m14:27:39.524792 [debug] [MainThread]: Flushing usage events
[0m14:27:41.845995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:42.980611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefc2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefc28e0>]}


============================== 14:27:42.983791 | 4e01053f-6c2c-4eea-ae9c-d403bbf3773e ==============================
[0m14:27:42.983791 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:27:42.984485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:27:43.096149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e01053f-6c2c-4eea-ae9c-d403bbf3773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16f0d00>]}
[0m14:27:43.136858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e01053f-6c2c-4eea-ae9c-d403bbf3773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf692790>]}
[0m14:27:43.137550 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:43.190513 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:27:43.262199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:43.262604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:43.286480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e01053f-6c2c-4eea-ae9c-d403bbf3773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadeb4130>]}
[0m14:27:43.295961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e01053f-6c2c-4eea-ae9c-d403bbf3773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadee6ac0>]}
[0m14:27:43.296408 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:27:43.296843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e01053f-6c2c-4eea-ae9c-d403bbf3773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadee6a00>]}
[0m14:27:43.298293 [info ] [MainThread]: 
[0m14:27:43.298697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:43.299058 [info ] [MainThread]: 
[0m14:27:43.299685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:43.303322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:27:43.331028 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:27:43.331413 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:27:43.331738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:43.338488 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:27:43.338909 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:27:43.339216 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:27:43.341300 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:27:43.342471 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:27:43.342869 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:27:43.347159 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:43.347500 [debug] [MainThread]: On master: BEGIN
[0m14:27:43.347773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:43.353870 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:27:43.354203 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:43.354574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:43.357269 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m14:27:43.358471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e01053f-6c2c-4eea-ae9c-d403bbf3773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadee6c40>]}
[0m14:27:43.358840 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:43.359191 [debug] [MainThread]: On master: Close
[0m14:27:43.361402 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:27:43.361675 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:27:43.362089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:27:43.362589 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:27:43.362936 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:27:43.363321 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:27:43.369750 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:27:43.371780 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:27:43.373136 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:27:43.373836 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:27:43.374182 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:27:43.374817 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:27:43.375413 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:27:43.375984 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:27:43.376321 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:27:43.379053 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:27:43.379892 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:27:43.380423 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:27:43.381169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:43.381463 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:27:43.381671 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:27:43.381857 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:27:43.382469 [debug] [MainThread]: Command end result
[0m14:27:43.437961 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:27:43.440595 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:27:43.446516 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:27:43.451646 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:27:43.451927 [info ] [MainThread]: Building catalog
[0m14:27:43.459130 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:27:43.465409 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:27:43.465770 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:27:43.466073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:43.472440 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:27:43.472813 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:27:43.473161 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:27:43.475773 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m14:27:43.478830 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:27:43.479252 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:27:43.488978 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m14:27:43.550160 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:27:43.552026 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:27:43.552307 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m14:27:43.553200 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.61386347, "process_in_blocks": "0", "process_kernel_time": 0.095048, "process_mem_max_rss": "108692", "process_out_blocks": "5027", "process_user_time": 1.397716}
[0m14:27:43.553726 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:27:43.553652 after 0.61 seconds
[0m14:27:43.554069 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:27:43.554361 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:27:43.554731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfd3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad24a760>]}
[0m14:27:43.555092 [debug] [MainThread]: Flushing usage events
[0m14:27:46.714370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:47.843171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82082130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811c3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811c35e0>]}


============================== 14:27:47.846740 | eb16855d-7811-49d9-857d-4859268125dd ==============================
[0m14:27:47.846740 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:27:47.847512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:47.963723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb16855d-7811-49d9-857d-4859268125dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804f2f40>]}
[0m14:27:48.005148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb16855d-7811-49d9-857d-4859268125dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80540fa0>]}
[0m14:34:03.129683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7b1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8c28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8c2940>]}


============================== 14:34:03.133622 | b06caaae-153a-4504-8576-4320436f8656 ==============================
[0m14:34:03.133622 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:03.134375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8080', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:03.261807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b06caaae-153a-4504-8576-4320436f8656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80029c70>]}
[0m14:34:03.307255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b06caaae-153a-4504-8576-4320436f8656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc33e20>]}
[0m14:34:03.321691 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:34:03.322980 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/local/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:34:03.324038 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.24091946, "process_in_blocks": "0", "process_kernel_time": 0.154433, "process_mem_max_rss": "96452", "process_out_blocks": "3344", "process_user_time": 1.12716}
[0m14:34:03.324501 [debug] [MainThread]: Command `dbt docs serve` failed at 14:34:03.324416 after 0.24 seconds
[0m14:34:03.324859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7b1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cae2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7caebd60>]}
[0m14:34:03.325197 [debug] [MainThread]: Flushing usage events
[0m14:34:08.024408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:33.698004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae881190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9c28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9c2940>]}


============================== 14:34:33.700688 | c110c827-8b5e-4a4a-8cd3-eb945f958e09 ==============================
[0m14:34:33.700688 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:33.701462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8081', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:33.816038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c110c827-8b5e-4a4a-8cd3-eb945f958e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00e9c70>]}
[0m14:34:33.859623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c110c827-8b5e-4a4a-8cd3-eb945f958e09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd03e20>]}
[0m14:35:57.850899 [error] [MainThread]: Encountered an error:

[0m14:35:57.858895 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:35:57.863902 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 84.207405, "process_in_blocks": "0", "process_kernel_time": 0.07402, "process_mem_max_rss": "96592", "process_out_blocks": "3344", "process_user_time": 1.090029}
[0m14:35:57.865356 [debug] [MainThread]: Command `dbt docs serve` failed at 14:35:57.865047 after 84.21 seconds
[0m14:35:57.867235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae881190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbbbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb6cd60>]}
[0m14:35:57.868467 [debug] [MainThread]: Flushing usage events
[0m14:36:57.167288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b01370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c468b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c46910>]}


============================== 14:36:57.173092 | 96e1cf7c-6073-466f-8146-e6d2c9dcf3a4 ==============================
[0m14:36:57.173092 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:36:57.173773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:57.263336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e1cf7c-6073-466f-8146-e6d2c9dcf3a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8cd24c0>]}
[0m14:36:57.271317 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:36:57.274281 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:36:57.275243 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15127037, "process_in_blocks": "0", "process_kernel_time": 0.13361, "process_mem_max_rss": "91044", "process_out_blocks": "963", "process_user_time": 1.088822}
[0m14:36:57.275765 [debug] [MainThread]: Command `dbt deps` succeeded at 14:36:57.275664 after 0.15 seconds
[0m14:36:57.276145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b01370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b50cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8cd24c0>]}
[0m14:36:57.276537 [debug] [MainThread]: Flushing usage events
[0m14:37:07.292040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:08.389578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aac2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aac25e0>]}


============================== 14:37:08.392335 | 73012066-7bc6-4ae0-8e92-3228ade7fca3 ==============================
[0m14:37:08.392335 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:08.393039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:37:08.513411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d228970>]}
[0m14:37:08.556275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd70d0>]}
[0m14:37:08.557134 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:08.613086 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:08.691094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:08.691585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:08.716377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899e3130>]}
[0m14:37:08.772290 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:37:08.774927 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:37:08.787647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a12640>]}
[0m14:37:08.788120 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:37:08.788544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd7070>]}
[0m14:37:08.789915 [info ] [MainThread]: 
[0m14:37:08.790344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:08.790739 [info ] [MainThread]: 
[0m14:37:08.791245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:08.794816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:37:08.822715 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:37:08.823176 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:37:08.823490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:08.831070 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:37:08.832238 [debug] [ThreadPool]: On list_analytics: Close
[0m14:37:08.833527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:37:08.838777 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:37:08.839148 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:37:08.839451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:08.845434 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:37:08.845784 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:37:08.846089 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:08.848381 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:37:08.849420 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:37:08.849802 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:37:08.853713 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:08.854020 [debug] [MainThread]: On master: BEGIN
[0m14:37:08.854318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:08.860613 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:37:08.860987 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:08.861360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:08.864369 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:37:08.865398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a2b190>]}
[0m14:37:08.865824 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:08.866221 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:08.866490 [debug] [MainThread]: On master: BEGIN
[0m14:37:08.866934 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:37:08.867236 [debug] [MainThread]: On master: COMMIT
[0m14:37:08.867523 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:08.867778 [debug] [MainThread]: On master: COMMIT
[0m14:37:08.868137 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:08.868453 [debug] [MainThread]: On master: Close
[0m14:37:08.874126 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:37:08.874425 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:37:08.874989 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m14:37:08.875590 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m14:37:08.876517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:37:08.877041 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:37:08.877584 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:37:08.878012 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:37:08.885655 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:37:08.887502 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:37:08.890099 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:37:08.897758 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:37:08.923991 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m14:37:08.925279 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m14:37:08.926840 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:37:08.927516 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m14:37:08.927846 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:37:08.927275 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:37:08.928522 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m14:37:08.929116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:37:08.937813 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m14:37:08.938317 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:37:08.938892 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m14:37:08.940014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:37:08.940816 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:37:08.941207 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m14:37:08.940470 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:37:08.946646 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:37:08.947205 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m14:37:08.946905 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:37:08.950872 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:37:08.951505 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m14:37:08.951149 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:37:08.993411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.041 seconds
[0m14:37:09.000395 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:37:09.002050 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:37:09.002465 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m14:37:09.001646 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:37:09.003080 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:37:09.003503 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m14:37:09.004402 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m14:37:09.004692 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:37:09.009900 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m14:37:09.012027 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m14:37:09.015461 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m14:37:09.016043 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m14:37:09.016424 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m14:37:09.016783 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m14:37:09.017377 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:37:09.017775 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:37:09.021140 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m14:37:09.019793 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m14:37:09.023387 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d230e80>]}
[0m14:37:09.022821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ca2130>]}
[0m14:37:09.024747 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:37:09.024016 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:37:09.025887 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:37:09.025391 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:37:09.026872 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:37:09.027373 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m14:37:09.027946 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:37:09.028334 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:37:09.031162 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:37:09.032720 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:37:09.050901 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m14:37:09.052305 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:37:09.052688 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m14:37:09.052999 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:37:09.059637 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m14:37:09.060064 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:37:09.060410 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m14:37:09.068293 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m14:37:09.071175 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:37:09.071523 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m14:37:09.072249 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:09.076438 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:37:09.076871 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m14:37:09.077464 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:37:09.083025 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:37:09.083453 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:37:09.083805 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m14:37:09.085223 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m14:37:09.087665 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m14:37:09.089573 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m14:37:09.089902 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m14:37:09.091406 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:37:09.092503 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m14:37:09.093058 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73012066-7bc6-4ae0-8e92-3228ade7fca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cb6dc0>]}
[0m14:37:09.093630 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m14:37:09.094285 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:37:09.095336 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:09.095649 [debug] [MainThread]: On master: BEGIN
[0m14:37:09.095886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:09.101994 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:37:09.102368 [debug] [MainThread]: On master: COMMIT
[0m14:37:09.102672 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:09.102902 [debug] [MainThread]: On master: COMMIT
[0m14:37:09.103283 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:37:09.103552 [debug] [MainThread]: On master: Close
[0m14:37:09.103880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:09.104117 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:37:09.104325 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:37:09.104511 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:37:09.104787 [info ] [MainThread]: 
[0m14:37:09.105214 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:37:09.106040 [debug] [MainThread]: Command end result
[0m14:37:09.129379 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:37:09.130874 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:37:09.136628 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:37:09.136924 [info ] [MainThread]: 
[0m14:37:09.137370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:09.137742 [info ] [MainThread]: 
[0m14:37:09.138042 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:37:09.138881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.79014844, "process_in_blocks": "0", "process_kernel_time": 0.112395, "process_mem_max_rss": "111116", "process_out_blocks": "1793", "process_user_time": 1.510871}
[0m14:37:09.139285 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:09.139216 after 0.79 seconds
[0m14:37:09.139665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e5c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a12610>]}
[0m14:37:09.140032 [debug] [MainThread]: Flushing usage events
[0m14:37:19.157417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:20.297596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ec1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3002850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30028b0>]}


============================== 14:37:20.300699 | 9c926301-15b0-4f8f-8d58-40e07a3c9966 ==============================
[0m14:37:20.300699 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:20.301381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:20.420621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c926301-15b0-4f8f-8d58-40e07a3c9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3dbf3a0>]}
[0m14:37:20.461386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c926301-15b0-4f8f-8d58-40e07a3c9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb232da60>]}
[0m14:37:20.462156 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:20.518929 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:20.592060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:20.592441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:20.616366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c926301-15b0-4f8f-8d58-40e07a3c9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f13130>]}
[0m14:37:20.626448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c926301-15b0-4f8f-8d58-40e07a3c9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f46af0>]}
[0m14:37:20.626877 [info ] [MainThread]: Found 3 models, 433 macros
[0m14:37:20.627377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c926301-15b0-4f8f-8d58-40e07a3c9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f46a30>]}
[0m14:37:20.628690 [info ] [MainThread]: 
[0m14:37:20.629068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:20.629477 [info ] [MainThread]: 
[0m14:37:20.630058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:20.633500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:37:20.660807 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:37:20.661204 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:37:20.661515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:20.668104 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:37:20.668469 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:37:20.668761 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:20.670703 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:37:20.671721 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:37:20.672113 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:37:20.676314 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:20.676639 [debug] [MainThread]: On master: BEGIN
[0m14:37:20.676905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:20.682824 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:37:20.683306 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:20.683712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:20.686411 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m14:37:20.687711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c926301-15b0-4f8f-8d58-40e07a3c9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f46d00>]}
[0m14:37:20.688112 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:20.688492 [debug] [MainThread]: On master: Close
[0m14:37:20.690644 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m14:37:20.690931 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m14:37:20.691348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m14:37:20.691833 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m14:37:20.692218 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m14:37:20.692596 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m14:37:20.698957 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m14:37:20.700618 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m14:37:20.702892 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m14:37:20.703594 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m14:37:20.703814 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m14:37:20.704505 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m14:37:20.705154 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m14:37:20.705608 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m14:37:20.705931 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m14:37:20.708441 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m14:37:20.709229 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m14:37:20.709690 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m14:37:20.710631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:20.710899 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m14:37:20.711113 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m14:37:20.711310 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m14:37:20.711894 [debug] [MainThread]: Command end result
[0m14:37:20.766985 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:37:20.769766 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:37:20.775907 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:37:20.780870 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:37:20.781174 [info ] [MainThread]: Building catalog
[0m14:37:20.788296 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:37:20.794053 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:37:20.794389 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:37:20.794801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:20.801537 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:37:20.802038 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:37:20.802419 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:37:20.805283 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m14:37:20.808408 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:37:20.808819 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:37:20.819163 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m14:37:20.881593 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:37:20.883489 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:37:20.883967 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m14:37:20.885073 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6299922, "process_in_blocks": "0", "process_kernel_time": 0.097063, "process_mem_max_rss": "108888", "process_out_blocks": "5027", "process_user_time": 1.399921}
[0m14:37:20.885626 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:37:20.885491 after 0.63 seconds
[0m14:37:20.886001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:37:20.886357 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:37:20.886749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ec1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb208b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb208b490>]}
[0m14:37:20.887145 [debug] [MainThread]: Flushing usage events
[0m14:37:33.069586 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:34.191458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85482100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845c3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845c3610>]}


============================== 14:37:34.194437 | 7d08b253-a09d-4df9-b9f3-67301beab3fa ==============================
[0m14:37:34.194437 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:34.195128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:34.313627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d08b253-a09d-4df9-b9f3-67301beab3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8466f250>]}
[0m14:37:34.354926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d08b253-a09d-4df9-b9f3-67301beab3fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856ca130>]}
[0m15:44:29.529419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ff1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0146910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0146970>]}


============================== 15:44:29.534757 | 3d80a25b-b140-4285-b549-fe23deb9a109 ==============================
[0m15:44:29.534757 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:29.535469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:44:29.615701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d80a25b-b140-4285-b549-fe23deb9a109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2899550>]}
[0m15:44:29.623502 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:44:29.625277 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:44:29.626329 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13913988, "process_in_blocks": "0", "process_kernel_time": 0.114608, "process_mem_max_rss": "91088", "process_out_blocks": "963", "process_user_time": 1.120953}
[0m15:44:29.626816 [debug] [MainThread]: Command `dbt deps` succeeded at 15:44:29.626735 after 0.14 seconds
[0m15:44:29.627203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ff1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0050cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2899550>]}
[0m15:44:29.627577 [debug] [MainThread]: Flushing usage events
[0m15:44:34.836368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:35.965889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3711c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c482640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4825e0>]}


============================== 15:44:35.969014 | b7bb0062-6d82-4188-b340-7f23f9e82cb9 ==============================
[0m15:44:35.969014 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:35.969529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:44:36.081081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec580a0>]}
[0m15:44:36.122812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b89e130>]}
[0m15:44:36.123755 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:36.183059 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:44:36.262200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:36.262703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:36.287706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3b19a0>]}
[0m15:44:36.345104 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:44:36.348125 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:44:36.361020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3e23d0>]}
[0m15:44:36.361462 [info ] [MainThread]: Found 3 models, 433 macros
[0m15:44:36.361940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b733640>]}
[0m15:44:36.363418 [info ] [MainThread]: 
[0m15:44:36.363774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:36.364095 [info ] [MainThread]: 
[0m15:44:36.364615 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:36.368105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m15:44:36.397703 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m15:44:36.398202 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:44:36.398520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:36.407281 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m15:44:36.408239 [debug] [ThreadPool]: On list_analytics: Close
[0m15:44:36.409872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m15:44:36.415232 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m15:44:36.415666 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m15:44:36.415975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:36.422525 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:44:36.423014 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m15:44:36.423352 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:44:36.425842 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:44:36.426960 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m15:44:36.427342 [debug] [ThreadPool]: On list_analytics_public: Close
[0m15:44:36.431347 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:36.431694 [debug] [MainThread]: On master: BEGIN
[0m15:44:36.431990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:36.438390 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:44:36.438754 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:36.439112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:36.442128 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:44:36.443190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a7cc190>]}
[0m15:44:36.443611 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:36.443998 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:36.444279 [debug] [MainThread]: On master: BEGIN
[0m15:44:36.444861 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:44:36.445279 [debug] [MainThread]: On master: COMMIT
[0m15:44:36.445608 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:36.445872 [debug] [MainThread]: On master: COMMIT
[0m15:44:36.446259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:36.446540 [debug] [MainThread]: On master: Close
[0m15:44:36.452429 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m15:44:36.452715 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m15:44:36.453228 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m15:44:36.453905 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m15:44:36.454505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m15:44:36.455032 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m15:44:36.455591 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m15:44:36.456052 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m15:44:36.463407 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.465384 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m15:44:36.467719 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m15:44:36.468011 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m15:44:36.499190 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.500136 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m15:44:36.501821 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.502576 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m15:44:36.502856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:36.502317 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m15:44:36.503482 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m15:44:36.504053 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:44:36.512291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m15:44:36.512870 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.514336 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m15:44:36.515170 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m15:44:36.515703 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m15:44:36.516161 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m15:44:36.516604 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:44:36.521958 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.522216 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:44:36.522581 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m15:44:36.526066 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m15:44:36.526678 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m15:44:36.526893 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:36.570055 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.043 seconds
[0m15:44:36.577122 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m15:44:36.578667 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.579050 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m15:44:36.578243 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m15:44:36.579689 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m15:44:36.580245 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m15:44:36.579961 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m15:44:36.585770 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m15:44:36.586073 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m15:44:36.589741 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m15:44:36.592122 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m15:44:36.592506 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m15:44:36.593073 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m15:44:36.593813 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m15:44:36.593601 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m15:44:36.596248 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m15:44:36.597861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebf0ee0>]}
[0m15:44:36.598506 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:44:36.599128 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m15:44:36.594221 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m15:44:36.600670 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m15:44:36.601196 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a745850>]}
[0m15:44:36.601822 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:44:36.602490 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m15:44:36.603172 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m15:44:36.603866 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m15:44:36.604443 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m15:44:36.604824 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m15:44:36.607741 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m15:44:36.609421 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m15:44:36.628636 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m15:44:36.630163 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m15:44:36.630600 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m15:44:36.630955 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:44:36.638080 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m15:44:36.638513 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m15:44:36.638833 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m15:44:36.647183 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m15:44:36.650336 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m15:44:36.650726 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m15:44:36.651607 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:36.656238 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m15:44:36.656658 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m15:44:36.657207 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:44:36.662506 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m15:44:36.662879 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m15:44:36.663181 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m15:44:36.664148 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m15:44:36.666161 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m15:44:36.668094 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m15:44:36.668437 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m15:44:36.670039 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m15:44:36.671137 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m15:44:36.671753 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7bb0062-6d82-4188-b340-7f23f9e82cb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6719a0>]}
[0m15:44:36.672402 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m15:44:36.673038 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m15:44:36.674111 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:36.674437 [debug] [MainThread]: On master: BEGIN
[0m15:44:36.674693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:36.681194 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:44:36.681495 [debug] [MainThread]: On master: COMMIT
[0m15:44:36.681773 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:36.682020 [debug] [MainThread]: On master: COMMIT
[0m15:44:36.682316 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:36.682533 [debug] [MainThread]: On master: Close
[0m15:44:36.682829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:36.683060 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m15:44:36.683271 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m15:44:36.683486 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m15:44:36.683788 [info ] [MainThread]: 
[0m15:44:36.684138 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:44:36.685136 [debug] [MainThread]: Command end result
[0m15:44:36.708084 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:44:36.709660 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:44:36.715148 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:44:36.715406 [info ] [MainThread]: 
[0m15:44:36.715798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:36.716183 [info ] [MainThread]: 
[0m15:44:36.716665 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:44:36.717641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7926082, "process_in_blocks": "0", "process_kernel_time": 0.128975, "process_mem_max_rss": "111420", "process_out_blocks": "1793", "process_user_time": 1.543708}
[0m15:44:36.718060 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:36.717984 after 0.79 seconds
[0m15:44:36.718410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3711c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3e23d0>]}
[0m15:44:36.718714 [debug] [MainThread]: Flushing usage events
[0m15:44:37.834583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:38.962395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab702100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa842850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8428b0>]}


============================== 15:44:38.965148 | aade636a-e38f-45f3-bff9-6e2bbc2b12e4 ==============================
[0m15:44:38.965148 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:38.965809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:44:39.089941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aade636a-e38f-45f3-bff9-6e2bbc2b12e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5ff3a0>]}
[0m15:44:39.321547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aade636a-e38f-45f3-bff9-6e2bbc2b12e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b7da60>]}
[0m15:44:39.323153 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:39.395997 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:44:39.480454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:39.480874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:39.508641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aade636a-e38f-45f3-bff9-6e2bbc2b12e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9734130>]}
[0m15:44:39.520350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aade636a-e38f-45f3-bff9-6e2bbc2b12e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9766af0>]}
[0m15:44:39.520861 [info ] [MainThread]: Found 3 models, 433 macros
[0m15:44:39.521288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aade636a-e38f-45f3-bff9-6e2bbc2b12e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9766a30>]}
[0m15:44:39.522944 [info ] [MainThread]: 
[0m15:44:39.523369 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:39.523813 [info ] [MainThread]: 
[0m15:44:39.524576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:39.528446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m15:44:39.560410 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m15:44:39.560874 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m15:44:39.561218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:39.569721 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:44:39.570256 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m15:44:39.570685 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:44:39.573124 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m15:44:39.574389 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m15:44:39.574840 [debug] [ThreadPool]: On list_analytics_public: Close
[0m15:44:39.579794 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:39.580143 [debug] [MainThread]: On master: BEGIN
[0m15:44:39.580426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:39.588149 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:44:39.588591 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:39.589030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:39.592017 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m15:44:39.593430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aade636a-e38f-45f3-bff9-6e2bbc2b12e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9766d00>]}
[0m15:44:39.593843 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:39.594252 [debug] [MainThread]: On master: Close
[0m15:44:39.596780 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m15:44:39.597111 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m15:44:39.597621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m15:44:39.598128 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m15:44:39.598563 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m15:44:39.599025 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m15:44:39.605952 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m15:44:39.607642 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m15:44:39.609081 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m15:44:39.609372 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m15:44:39.610912 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m15:44:39.610125 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m15:44:39.611849 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m15:44:39.612403 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m15:44:39.612870 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m15:44:39.615798 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m15:44:39.616869 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m15:44:39.617549 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m15:44:39.618547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:39.618858 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m15:44:39.619124 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m15:44:39.619404 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m15:44:39.620149 [debug] [MainThread]: Command end result
[0m15:44:39.677785 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:44:39.681086 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:44:39.687971 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:44:39.693196 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m15:44:39.693536 [info ] [MainThread]: Building catalog
[0m15:44:39.701149 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m15:44:39.707464 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m15:44:39.707837 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m15:44:39.708157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:39.715008 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:44:39.715419 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m15:44:39.715760 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m15:44:39.718818 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m15:44:39.722050 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m15:44:39.722460 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m15:44:39.735610 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m15:44:39.802168 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:44:39.804179 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:44:39.804533 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m15:44:39.805746 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8840141, "process_in_blocks": "0", "process_kernel_time": 0.111289, "process_mem_max_rss": "108704", "process_out_blocks": "5027", "process_user_time": 1.632593}
[0m15:44:39.806301 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:44:39.806201 after 0.88 seconds
[0m15:44:39.806689 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:44:39.806983 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m15:44:39.807323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab702100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad18f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98534c0>]}
[0m15:44:39.807730 [debug] [MainThread]: Flushing usage events
[0m15:44:41.381953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:42.645653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85371130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84483640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844835e0>]}


============================== 15:44:42.648806 | 30bb3dda-1e68-468b-9781-89f09546cf0f ==============================
[0m15:44:42.648806 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:42.649512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:44:42.770223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30bb3dda-1e68-468b-9781-89f09546cf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837f3f40>]}
[0m15:44:42.817013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30bb3dda-1e68-468b-9781-89f09546cf0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83840fa0>]}
[0m16:06:34.002825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d70430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e84850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e848b0>]}


============================== 16:06:34.008769 | a28b15c3-ad80-4e6b-95bf-bd01a4adcc6b ==============================
[0m16:06:34.008769 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:06:34.009436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:34.090583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a28b15c3-ad80-4e6b-95bf-bd01a4adcc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65f11c0>]}
[0m16:06:34.098346 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:06:34.100348 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:06:34.101413 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15568724, "process_in_blocks": "0", "process_kernel_time": 0.14286, "process_mem_max_rss": "90960", "process_out_blocks": "963", "process_user_time": 1.25959}
[0m16:06:34.101936 [debug] [MainThread]: Command `dbt deps` succeeded at 16:06:34.101835 after 0.16 seconds
[0m16:06:34.102330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d70430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d95cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65f11c0>]}
[0m16:06:34.102737 [debug] [MainThread]: Flushing usage events
[0m16:06:41.081612 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:42.314633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954c36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954c3640>]}


============================== 16:06:42.318237 | 51b5d9be-f6ac-4590-ba86-00a1ae902632 ==============================
[0m16:06:42.318237 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:06:42.318991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:06:42.449548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959893d0>]}
[0m16:06:42.495402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95be8d30>]}
[0m16:06:42.496345 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:42.552762 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:06:42.638064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:42.638493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:42.663788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943e2130>]}
[0m16:06:42.722071 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:06:42.724999 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:06:42.738332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94412550>]}
[0m16:06:42.738766 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:06:42.739156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943f1670>]}
[0m16:06:42.740423 [info ] [MainThread]: 
[0m16:06:42.740735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:42.741244 [info ] [MainThread]: 
[0m16:06:42.741836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:42.745437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m16:06:42.774068 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m16:06:42.774541 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:06:42.774864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:42.784259 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m16:06:42.785203 [debug] [ThreadPool]: On list_analytics: Close
[0m16:06:42.786579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m16:06:42.791534 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:06:42.791934 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:06:42.792276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:42.798480 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:06:42.798906 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:06:42.799252 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:06:42.804987 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m16:06:42.806787 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:06:42.807395 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:06:42.811851 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:42.812269 [debug] [MainThread]: On master: BEGIN
[0m16:06:42.812547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:42.823560 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:06:42.827728 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:42.828814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:42.847708 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m16:06:42.850511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93806040>]}
[0m16:06:42.852419 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:42.854205 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:42.854758 [debug] [MainThread]: On master: BEGIN
[0m16:06:42.855858 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:06:42.856989 [debug] [MainThread]: On master: COMMIT
[0m16:06:42.857644 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:42.858196 [debug] [MainThread]: On master: COMMIT
[0m16:06:42.858858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:42.859326 [debug] [MainThread]: On master: Close
[0m16:06:42.869811 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:06:42.870646 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:06:42.871954 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m16:06:42.873627 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m16:06:42.875554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:06:42.876459 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:06:42.877226 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:06:42.877764 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:06:42.920575 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:06:42.922634 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:06:42.946155 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:06:42.940470 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:06:43.020728 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m16:06:43.022267 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m16:06:43.024221 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:06:43.024855 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m16:06:43.025197 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:06:43.024645 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:06:43.026119 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m16:06:43.027037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:06:43.037568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m16:06:43.038222 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:06:43.038574 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m16:06:43.039492 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:06:43.039838 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m16:06:43.039027 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m16:06:43.042337 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:06:43.042653 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:06:43.050390 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:06:43.106044 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m16:06:43.105469 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:06:43.106881 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m16:06:43.107278 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:43.117122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.009 seconds
[0m16:06:43.121249 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:06:43.121604 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:06:43.121950 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:06:43.120120 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:06:43.122542 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:06:43.123165 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:06:43.122845 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m16:06:43.128816 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m16:06:43.129201 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m16:06:43.132807 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:06:43.135322 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m16:06:43.134934 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m16:06:43.136054 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:06:43.136592 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m16:06:43.136309 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m16:06:43.139069 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m16:06:43.137038 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m16:06:43.141771 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m16:06:43.142309 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93689dc0>]}
[0m16:06:43.142996 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:06:43.143660 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:06:43.140740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93747a00>]}
[0m16:06:43.144537 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m16:06:43.145135 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:06:43.145992 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:06:43.146459 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m16:06:43.147081 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:06:43.147563 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:06:43.150428 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:06:43.152106 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:06:43.170233 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m16:06:43.171534 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:06:43.171994 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m16:06:43.172410 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:06:43.179337 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m16:06:43.179776 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:06:43.180191 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m16:06:43.189787 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.009 seconds
[0m16:06:43.192881 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:06:43.193252 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m16:06:43.193855 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:06:43.197510 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:06:43.197825 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m16:06:43.198360 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:06:43.203653 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:06:43.204005 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:06:43.204314 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:06:43.205514 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m16:06:43.207472 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m16:06:43.209354 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:06:43.209655 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m16:06:43.211933 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m16:06:43.212882 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m16:06:43.213488 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b5d9be-f6ac-4590-ba86-00a1ae902632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93661f40>]}
[0m16:06:43.214188 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m16:06:43.214838 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:06:43.215995 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:43.216313 [debug] [MainThread]: On master: BEGIN
[0m16:06:43.216557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:43.222709 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:06:43.223054 [debug] [MainThread]: On master: COMMIT
[0m16:06:43.223296 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:43.223509 [debug] [MainThread]: On master: COMMIT
[0m16:06:43.223856 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:43.224153 [debug] [MainThread]: On master: Close
[0m16:06:43.224532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:43.224819 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:06:43.225114 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:06:43.225385 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:06:43.225779 [info ] [MainThread]: 
[0m16:06:43.226165 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:06:43.227033 [debug] [MainThread]: Command end result
[0m16:06:43.249902 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:06:43.252140 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:06:43.263285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:06:43.263627 [info ] [MainThread]: 
[0m16:06:43.264181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:43.264545 [info ] [MainThread]: 
[0m16:06:43.264950 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:06:43.265981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99457586, "process_in_blocks": "0", "process_kernel_time": 0.155342, "process_mem_max_rss": "111512", "process_out_blocks": "1793", "process_user_time": 1.756483}
[0m16:06:43.266377 [debug] [MainThread]: Command `dbt run` succeeded at 16:06:43.266306 after 1.00 seconds
[0m16:06:43.266712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94860400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96237a30>]}
[0m16:06:43.267053 [debug] [MainThread]: Flushing usage events
[0m16:06:46.008881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:47.602200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d71070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe828e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe82940>]}


============================== 16:06:47.605953 | 8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990 ==============================
[0m16:06:47.605953 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:06:47.606924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:47.742524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff22a60>]}
[0m16:06:47.787202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bee3d0>]}
[0m16:06:47.788135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:47.844818 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:06:47.935081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:47.935539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:47.960630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edb4130>]}
[0m16:06:47.970308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ede7a60>]}
[0m16:06:47.970783 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:06:47.971319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ede79a0>]}
[0m16:06:47.972911 [info ] [MainThread]: 
[0m16:06:47.973451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:47.973809 [info ] [MainThread]: 
[0m16:06:47.974388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:47.978040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m16:06:48.010001 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:06:48.010460 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:06:48.010876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:48.020569 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:06:48.021119 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:06:48.021531 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:06:48.024803 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m16:06:48.026031 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:06:48.026474 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:06:48.031430 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:48.031753 [debug] [MainThread]: On master: BEGIN
[0m16:06:48.032031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:48.039588 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:06:48.041376 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:48.041821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:48.046009 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m16:06:48.047468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b0c199a-53bf-4fe3-bcf8-c4f6cda3d990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed7edf0>]}
[0m16:06:48.047916 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:48.048325 [debug] [MainThread]: On master: Close
[0m16:06:48.051052 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:06:48.051344 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:06:48.051844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:06:48.052389 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:06:48.052788 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:06:48.053189 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:06:48.059821 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:06:48.061681 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:06:48.063368 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:06:48.064385 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:06:48.065075 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:06:48.065853 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:06:48.066667 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:06:48.067193 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:06:48.067638 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:06:48.070341 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:06:48.071275 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:06:48.071902 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:06:48.072708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:48.073092 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:06:48.073432 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:06:48.073757 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:06:48.074692 [debug] [MainThread]: Command end result
[0m16:06:48.135339 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:06:48.138396 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:06:48.144831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:06:48.149976 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:06:48.150253 [info ] [MainThread]: Building catalog
[0m16:06:48.157587 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m16:06:48.163729 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:06:48.164129 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m16:06:48.164466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:48.171414 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:06:48.171922 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:06:48.172350 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:06:48.175784 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m16:06:48.179074 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m16:06:48.179491 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m16:06:48.190454 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m16:06:48.250243 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:06:48.252318 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:06:48.252643 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m16:06:48.253744 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.69872224, "process_in_blocks": "0", "process_kernel_time": 0.142826, "process_mem_max_rss": "108888", "process_out_blocks": "5027", "process_user_time": 1.520156}
[0m16:06:48.254341 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:06:48.254250 after 0.70 seconds
[0m16:06:48.254684 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:06:48.254997 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m16:06:48.255334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d71070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eed3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e15aaf0>]}
[0m16:06:48.255674 [debug] [MainThread]: Flushing usage events
[0m16:06:50.972722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:52.179564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838c2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a036d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a03670>]}


============================== 16:06:52.182673 | 9c1c21ed-9edb-44a7-b910-6ede91f42f0c ==============================
[0m16:06:52.182673 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:06:52.183395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:06:52.422998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c1c21ed-9edb-44a7-b910-6ede91f42f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bd94c0>]}
[0m16:06:52.464698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c1c21ed-9edb-44a7-b910-6ede91f42f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a45dc0>]}
[0m16:09:50.945263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebb13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcc6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcc6880>]}


============================== 16:09:50.951765 | ba8290d7-9bce-4986-995c-7911130a97ef ==============================
[0m16:09:50.951765 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:09:50.953471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:51.038584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba8290d7-9bce-4986-995c-7911130a97ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e396040>]}
[0m16:09:51.046078 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:09:51.047905 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:09:51.048948 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1495482, "process_in_blocks": "0", "process_kernel_time": 0.111504, "process_mem_max_rss": "91052", "process_out_blocks": "963", "process_user_time": 1.110022}
[0m16:09:51.049509 [debug] [MainThread]: Command `dbt deps` succeeded at 16:09:51.049396 after 0.15 seconds
[0m16:09:51.049924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebb13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dbd0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e396040>]}
[0m16:09:51.050292 [debug] [MainThread]: Flushing usage events
[0m16:09:52.329457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:53.416708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4571160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36836a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3683640>]}


============================== 16:09:53.419597 | e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8 ==============================
[0m16:09:53.419597 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:09:53.420217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:53.537046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b493d0>]}
[0m16:09:53.578515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3da8d30>]}
[0m16:09:53.579457 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:09:53.636406 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:09:53.713975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:53.714408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:53.739450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25b3130>]}
[0m16:09:53.794177 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:09:53.796969 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:09:53.809708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25e2550>]}
[0m16:09:53.810122 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:09:53.810539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25c0670>]}
[0m16:09:53.811873 [info ] [MainThread]: 
[0m16:09:53.812264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:53.812700 [info ] [MainThread]: 
[0m16:09:53.813337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:53.816846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m16:09:53.845111 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m16:09:53.845568 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:09:53.845983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:53.853454 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m16:09:53.854664 [debug] [ThreadPool]: On list_analytics: Close
[0m16:09:53.855924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m16:09:53.861207 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:09:53.861545 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:09:53.861872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:53.867743 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:09:53.868036 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:09:53.868352 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:09:53.870816 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:09:53.871864 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:09:53.872370 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:09:53.876536 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:53.876944 [debug] [MainThread]: On master: BEGIN
[0m16:09:53.877329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:53.883773 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:09:53.884183 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:53.884563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:53.887529 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:09:53.888605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19c4040>]}
[0m16:09:53.888979 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:53.889365 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:53.889592 [debug] [MainThread]: On master: BEGIN
[0m16:09:53.890104 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:09:53.890568 [debug] [MainThread]: On master: COMMIT
[0m16:09:53.890830 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:53.891084 [debug] [MainThread]: On master: COMMIT
[0m16:09:53.891438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:53.891777 [debug] [MainThread]: On master: Close
[0m16:09:53.897410 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:09:53.897795 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:09:53.898423 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m16:09:53.899247 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m16:09:53.900717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:09:53.901496 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:09:53.902090 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:09:53.902636 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:09:53.913408 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:09:53.915512 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:09:53.918357 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:09:53.918675 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:09:53.951459 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m16:09:53.953020 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m16:09:53.955031 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:09:53.955653 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m16:09:53.955909 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:09:53.955437 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:09:53.956865 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m16:09:53.957257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:53.962565 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m16:09:53.963077 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:09:53.963455 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m16:09:53.964907 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:09:53.965220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m16:09:53.970851 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:09:53.971310 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m16:09:53.970415 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:09:53.971964 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m16:09:53.972702 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:53.982459 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:09:53.988843 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:09:53.989347 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m16:09:53.985148 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:09:53.989940 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:09:53.990546 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:09:53.990221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:53.991995 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:09:53.992640 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:09:53.993007 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:09:53.992255 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m16:09:54.032209 [debug] [Thread-1  ]: SQL status: COMMIT in 0.039 seconds
[0m16:09:54.037473 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m16:09:54.039567 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m16:09:54.043080 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:09:54.043709 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:09:54.044413 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m16:09:54.044087 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m16:09:54.045140 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m16:09:54.045418 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m16:09:54.047546 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m16:09:54.050060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5de6e80>]}
[0m16:09:54.050769 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:09:54.048605 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m16:09:54.052005 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1862dc0>]}
[0m16:09:54.052539 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:09:54.053056 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:09:54.051439 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:09:54.053964 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:09:54.054473 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m16:09:54.055048 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:09:54.055437 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:09:54.058337 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:09:54.060095 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:09:54.079120 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m16:09:54.080588 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:09:54.080931 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m16:09:54.081205 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:09:54.087367 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m16:09:54.087730 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:09:54.088024 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m16:09:54.095970 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m16:09:54.098907 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:09:54.099333 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m16:09:54.100056 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:54.104290 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:09:54.104752 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m16:09:54.105365 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:54.110799 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:09:54.111238 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:09:54.111717 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:09:54.112848 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m16:09:54.115037 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m16:09:54.117226 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:09:54.117578 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m16:09:54.118958 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m16:09:54.120087 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m16:09:54.120660 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0efd816-b4a0-4cd0-86f3-b4c7e94dfde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2562d60>]}
[0m16:09:54.121226 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m16:09:54.121857 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:09:54.123001 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.123353 [debug] [MainThread]: On master: BEGIN
[0m16:09:54.123612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:54.129615 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:09:54.129984 [debug] [MainThread]: On master: COMMIT
[0m16:09:54.130364 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:54.130704 [debug] [MainThread]: On master: COMMIT
[0m16:09:54.131066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:54.131319 [debug] [MainThread]: On master: Close
[0m16:09:54.131712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:54.132046 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:09:54.132285 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:09:54.132515 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:09:54.132853 [info ] [MainThread]: 
[0m16:09:54.133201 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m16:09:54.134036 [debug] [MainThread]: Command end result
[0m16:09:54.164803 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:09:54.167993 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:09:54.173274 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:09:54.173571 [info ] [MainThread]: 
[0m16:09:54.174083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:54.174566 [info ] [MainThread]: 
[0m16:09:54.174968 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:09:54.175821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80167806, "process_in_blocks": "0", "process_kernel_time": 0.106691, "process_mem_max_rss": "111520", "process_out_blocks": "1793", "process_user_time": 1.518615}
[0m16:09:54.176237 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:54.176157 after 0.80 seconds
[0m16:09:54.176642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4571160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25e2520>]}
[0m16:09:54.177021 [debug] [MainThread]: Flushing usage events
[0m16:09:55.244114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:56.491989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c41160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d827f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d82850>]}


============================== 16:09:56.495141 | 7ac10402-5b94-4792-8b6b-96505ed318c6 ==============================
[0m16:09:56.495141 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:09:56.495887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:56.642813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac10402-5b94-4792-8b6b-96505ed318c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4ba970>]}
[0m16:09:56.687811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac10402-5b94-4792-8b6b-96505ed318c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9815f640>]}
[0m16:09:56.688750 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:09:56.744940 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:09:56.818076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:56.818459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:56.841983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac10402-5b94-4792-8b6b-96505ed318c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c739a0>]}
[0m16:09:56.850388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac10402-5b94-4792-8b6b-96505ed318c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ca5b50>]}
[0m16:09:56.850804 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:09:56.851190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac10402-5b94-4792-8b6b-96505ed318c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ca5a90>]}
[0m16:09:56.852411 [info ] [MainThread]: 
[0m16:09:56.852768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:56.853062 [info ] [MainThread]: 
[0m16:09:56.853535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:56.856894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m16:09:56.885524 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:09:56.885961 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:09:56.886268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:56.893984 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:09:56.894406 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:09:56.894726 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:09:56.897087 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:09:56.898196 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:09:56.898681 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:09:56.903342 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:56.903697 [debug] [MainThread]: On master: BEGIN
[0m16:09:56.903963 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:56.910575 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:09:56.910925 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:56.911263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:56.913991 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m16:09:56.915245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac10402-5b94-4792-8b6b-96505ed318c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ca5d30>]}
[0m16:09:56.915632 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:56.916044 [debug] [MainThread]: On master: Close
[0m16:09:56.918378 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:09:56.918644 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:09:56.919055 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:09:56.919604 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:09:56.919982 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:09:56.920364 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:09:56.926979 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:09:56.928744 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:09:56.930011 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:09:56.930629 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:09:56.930966 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:09:56.931581 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:09:56.932214 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:09:56.932690 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:09:56.932979 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:09:56.935412 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:09:56.936134 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:09:56.936656 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:09:56.937478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:56.937778 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:09:56.938001 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:09:56.938186 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:09:56.938805 [debug] [MainThread]: Command end result
[0m16:09:56.993495 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:09:56.996119 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:09:57.002366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:09:57.007541 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:09:57.007816 [info ] [MainThread]: Building catalog
[0m16:09:57.014808 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m16:09:57.020978 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:09:57.021387 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m16:09:57.021799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:57.028771 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:09:57.029238 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:09:57.029637 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:09:57.032543 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m16:09:57.035729 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m16:09:57.036149 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m16:09:57.046713 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m16:09:57.110070 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:09:57.111988 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:09:57.112343 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m16:09:57.113383 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6660669, "process_in_blocks": "0", "process_kernel_time": 0.108603, "process_mem_max_rss": "108828", "process_out_blocks": "5027", "process_user_time": 1.463652}
[0m16:09:57.113913 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:09:57.113813 after 0.67 seconds
[0m16:09:57.114310 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:09:57.114686 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m16:09:57.115124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c41160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d94520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ed2c40>]}
[0m16:09:57.115603 [debug] [MainThread]: Flushing usage events
[0m16:09:58.350784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:59.488446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8731160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7852940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78529a0>]}


============================== 16:09:59.491797 | e3d5cd6d-e7b8-4448-8c9b-3eefe41707aa ==============================
[0m16:09:59.491797 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:09:59.492508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:09:59.618927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d5cd6d-e7b8-4448-8c9b-3eefe41707aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d094c0>]}
[0m16:09:59.659592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d5cd6d-e7b8-4448-8c9b-3eefe41707aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7896dc0>]}
[0m16:36:34.897962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc41400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad867f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad86850>]}


============================== 16:36:34.903720 | 1c3ba549-af7d-4f65-b950-75c962f6730f ==============================
[0m16:36:34.903720 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:36:34.904434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:34.983733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c3ba549-af7d-4f65-b950-75c962f6730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf629a0>]}
[0m16:36:34.991660 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:36:34.993471 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:36:34.994412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1387005, "process_in_blocks": "0", "process_kernel_time": 0.111969, "process_mem_max_rss": "90852", "process_out_blocks": "963", "process_user_time": 1.139688}
[0m16:36:34.994960 [debug] [MainThread]: Command `dbt deps` succeeded at 16:36:34.994852 after 0.14 seconds
[0m16:36:34.995359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc41400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac95cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf629a0>]}
[0m16:36:34.995731 [debug] [MainThread]: Flushing usage events
[0m16:36:39.012563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:40.090680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f331100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4525b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e452550>]}


============================== 16:36:40.093456 | 48155864-3b59-4c2d-978c-d6ba26138e15 ==============================
[0m16:36:40.093456 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:36:40.094132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:36:40.206019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7ca8e0>]}
[0m16:36:40.251525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4fe280>]}
[0m16:36:40.252706 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:36:40.307276 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:36:40.380640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:40.381057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:40.404484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d362130>]}
[0m16:36:40.460545 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:36:40.463559 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:36:40.475551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d392460>]}
[0m16:36:40.475941 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:36:40.476297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3330d0>]}
[0m16:36:40.477592 [info ] [MainThread]: 
[0m16:36:40.478119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:40.478591 [info ] [MainThread]: 
[0m16:36:40.479112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:40.482637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m16:36:40.510487 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m16:36:40.510921 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:36:40.511251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:40.518500 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m16:36:40.519432 [debug] [ThreadPool]: On list_analytics: Close
[0m16:36:40.520571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m16:36:40.525792 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:36:40.526167 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:36:40.526483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:40.532822 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:36:40.533237 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:36:40.533530 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:36:40.536002 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:36:40.537018 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:36:40.537527 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:36:40.542026 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:40.542437 [debug] [MainThread]: On master: BEGIN
[0m16:36:40.542773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:40.549496 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:36:40.550109 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:40.550574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:40.558045 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:36:40.559377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7841c0>]}
[0m16:36:40.559936 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:40.560509 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:40.560910 [debug] [MainThread]: On master: BEGIN
[0m16:36:40.561739 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:36:40.562435 [debug] [MainThread]: On master: COMMIT
[0m16:36:40.562871 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:40.563256 [debug] [MainThread]: On master: COMMIT
[0m16:36:40.563742 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:40.564192 [debug] [MainThread]: On master: Close
[0m16:36:40.569733 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:36:40.570061 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:36:40.570615 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m16:36:40.571297 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m16:36:40.572000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:36:40.572551 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:36:40.572937 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:36:40.573353 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:36:40.580410 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.582281 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:36:40.584604 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:36:40.584960 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:36:40.757686 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.758899 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m16:36:40.760942 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.761756 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m16:36:40.762065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:40.761525 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:36:40.762751 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m16:36:40.763395 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:36:40.769584 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m16:36:40.771915 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.773104 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m16:36:40.773832 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m16:36:40.774242 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:36:40.774656 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m16:36:40.775582 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:36:40.780989 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.781700 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m16:36:40.781307 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:36:40.823528 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.041 seconds
[0m16:36:40.824136 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:36:40.837930 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m16:36:40.837376 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:36:40.838526 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.839022 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:36:40.838787 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:40.840361 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:36:40.840887 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:36:40.841136 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:36:40.840624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m16:36:40.846854 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m16:36:40.847137 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m16:36:40.852291 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m16:36:40.852801 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:36:40.853082 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m16:36:40.850328 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:36:40.853479 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m16:36:40.853691 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m16:36:40.855851 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m16:36:40.856090 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m16:36:40.858947 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m16:36:40.859513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6381c0>]}
[0m16:36:40.857861 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6c7880>]}
[0m16:36:40.861126 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:36:40.860308 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:36:40.862292 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:36:40.861793 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:36:40.863308 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:36:40.863879 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m16:36:40.864418 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:36:40.864892 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:36:40.867805 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:36:40.869797 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:36:40.888697 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m16:36:40.890079 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:36:40.890501 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m16:36:40.890894 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:36:40.897517 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m16:36:40.897993 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:36:40.898349 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m16:36:40.916612 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.018 seconds
[0m16:36:40.919878 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:36:40.920258 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m16:36:40.920886 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:36:40.924755 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:36:40.925097 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m16:36:40.925539 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:36:40.930974 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:36:40.931423 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:36:40.931823 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:36:40.932828 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m16:36:40.935262 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m16:36:40.937374 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:36:40.937692 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m16:36:40.939540 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m16:36:40.940653 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m16:36:40.941261 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48155864-3b59-4c2d-978c-d6ba26138e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5dff40>]}
[0m16:36:40.941949 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.08s]
[0m16:36:40.942621 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:36:40.943847 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:40.944260 [debug] [MainThread]: On master: BEGIN
[0m16:36:40.944585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:40.951102 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:36:40.951525 [debug] [MainThread]: On master: COMMIT
[0m16:36:40.951829 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:40.952161 [debug] [MainThread]: On master: COMMIT
[0m16:36:40.952620 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:36:40.952934 [debug] [MainThread]: On master: Close
[0m16:36:40.953390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:40.953751 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:36:40.954080 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:36:40.954365 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:36:40.954792 [info ] [MainThread]: 
[0m16:36:40.955187 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:36:40.956219 [debug] [MainThread]: Command end result
[0m16:36:40.981651 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:36:40.983382 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:36:40.989025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:36:40.989312 [info ] [MainThread]: 
[0m16:36:40.989758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:40.990028 [info ] [MainThread]: 
[0m16:36:40.990379 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:36:40.991327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9415229, "process_in_blocks": "0", "process_kernel_time": 0.12574, "process_mem_max_rss": "111248", "process_out_blocks": "1793", "process_user_time": 1.62112}
[0m16:36:40.991737 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:40.991678 after 0.94 seconds
[0m16:36:40.992025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f331100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1e2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d392430>]}
[0m16:36:40.992327 [debug] [MainThread]: Flushing usage events
[0m16:36:42.260560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:43.478169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e081130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1c2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1c2880>]}


============================== 16:36:43.481271 | e8f92a0c-c32f-4e16-b770-941e8f6399cd ==============================
[0m16:36:43.481271 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:36:43.482035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:43.599528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8f92a0c-c32f-4e16-b770-941e8f6399cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d228940>]}
[0m16:36:43.649197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8f92a0c-c32f-4e16-b770-941e8f6399cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de8ea90>]}
[0m16:36:43.650082 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:36:43.707853 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:36:43.781381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:43.781775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:43.805427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8f92a0c-c32f-4e16-b770-941e8f6399cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0b3130>]}
[0m16:36:43.814002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8f92a0c-c32f-4e16-b770-941e8f6399cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0e6b20>]}
[0m16:36:43.814437 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:36:43.814854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8f92a0c-c32f-4e16-b770-941e8f6399cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0e6a60>]}
[0m16:36:43.816199 [info ] [MainThread]: 
[0m16:36:43.816644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:43.816958 [info ] [MainThread]: 
[0m16:36:43.817478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:43.820977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m16:36:43.850445 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:36:43.850834 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:36:43.851155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:43.858663 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:36:43.859132 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:36:43.859626 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:36:43.862102 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:36:43.863216 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:36:43.863634 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:36:43.868329 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:43.868636 [debug] [MainThread]: On master: BEGIN
[0m16:36:43.868926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:43.875436 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:36:43.875812 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:43.876317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:43.879745 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m16:36:43.881115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8f92a0c-c32f-4e16-b770-941e8f6399cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0e6d60>]}
[0m16:36:43.881523 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:43.881957 [debug] [MainThread]: On master: Close
[0m16:36:43.884481 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:36:43.884791 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:36:43.885267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:36:43.885743 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:36:43.886161 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:36:43.886483 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:36:43.893366 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:36:43.895322 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:36:43.896757 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:36:43.897055 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:36:43.898210 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:36:43.897632 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:36:43.899117 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:36:43.899690 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:36:43.900014 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:36:43.902724 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:36:43.903807 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:36:43.904445 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:36:43.905428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:43.905723 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:36:43.905953 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:36:43.906184 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:36:43.906854 [debug] [MainThread]: Command end result
[0m16:36:43.965180 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:36:43.967912 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:36:43.973888 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:36:43.978552 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:36:43.978836 [info ] [MainThread]: Building catalog
[0m16:36:43.986128 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m16:36:43.992474 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:36:43.992911 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m16:36:43.993212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:44.000184 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:36:44.000673 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:36:44.001234 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:36:44.004208 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m16:36:44.007523 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m16:36:44.008016 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m16:36:44.017845 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m16:36:44.089677 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:36:44.092138 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:36:44.092465 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m16:36:44.093841 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.66891295, "process_in_blocks": "0", "process_kernel_time": 0.132641, "process_mem_max_rss": "108816", "process_out_blocks": "5027", "process_user_time": 1.442106}
[0m16:36:44.094356 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:36:44.094264 after 0.67 seconds
[0m16:36:44.094728 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:36:44.095018 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m16:36:44.095420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e081130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1d3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4a6550>]}
[0m16:36:44.095829 [debug] [MainThread]: Flushing usage events
[0m16:36:45.502556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:46.690237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cc1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e02940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e029a0>]}


============================== 16:36:46.693406 | 04e0f152-84ab-443c-bf51-c6f24cf6eb1c ==============================
[0m16:36:46.693406 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:36:46.694166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8081', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:46.817385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e0f152-84ab-443c-bf51-c6f24cf6eb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fd94c0>]}
[0m16:36:46.860606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04e0f152-84ab-443c-bf51-c6f24cf6eb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e46dc0>]}
[0m16:41:40.676440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7f0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a946850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9468b0>]}


============================== 16:41:40.682546 | c6fbc1ee-770c-4794-86bb-b2986282b5a8 ==============================
[0m16:41:40.682546 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:41:40.683183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:41:40.767143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6fbc1ee-770c-4794-86bb-b2986282b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0911c0>]}
[0m16:41:40.774522 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:41:40.776202 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:41:40.777168 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14721063, "process_in_blocks": "0", "process_kernel_time": 0.120927, "process_mem_max_rss": "91064", "process_out_blocks": "963", "process_user_time": 1.207212}
[0m16:41:40.777663 [debug] [MainThread]: Command `dbt deps` succeeded at 16:41:40.777557 after 0.15 seconds
[0m16:41:40.778035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7f0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a855cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0911c0>]}
[0m16:41:40.778468 [debug] [MainThread]: Flushing usage events
[0m16:41:48.223017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:49.359663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12425b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1242550>]}


============================== 16:41:49.362860 | 87d9a72a-41f7-41aa-acae-58b578a5385f ==============================
[0m16:41:49.362860 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:41:49.363832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:49.489732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12f2bb0>]}
[0m16:41:49.534894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19032e0>]}
[0m16:41:49.535904 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:41:49.593757 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:41:49.673370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:49.673834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:49.699473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0138eb0>]}
[0m16:41:49.755788 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:41:49.758700 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:41:49.771430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0162430>]}
[0m16:41:49.771844 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:41:49.772240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0102100>]}
[0m16:41:49.773564 [info ] [MainThread]: 
[0m16:41:49.773942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:49.774369 [info ] [MainThread]: 
[0m16:41:49.774985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:49.778592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m16:41:49.805752 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m16:41:49.806223 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m16:41:49.806548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:49.813705 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m16:41:49.814695 [debug] [ThreadPool]: On list_analytics: Close
[0m16:41:49.815843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m16:41:49.820910 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:41:49.821278 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:41:49.821577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:49.827440 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:41:49.827830 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:41:49.828126 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:41:49.830325 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:41:49.831360 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:41:49.831762 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:41:49.835526 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:49.835855 [debug] [MainThread]: On master: BEGIN
[0m16:41:49.836138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:49.842251 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:41:49.842620 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:49.842992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:41:49.845937 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:41:49.846921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb018cdc0>]}
[0m16:41:49.847326 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:49.847741 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:49.848030 [debug] [MainThread]: On master: BEGIN
[0m16:41:49.848476 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:41:49.848780 [debug] [MainThread]: On master: COMMIT
[0m16:41:49.849059 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:49.849315 [debug] [MainThread]: On master: COMMIT
[0m16:41:49.849721 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:41:49.850010 [debug] [MainThread]: On master: Close
[0m16:41:49.856557 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:41:49.856826 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:41:49.857279 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m16:41:49.857952 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m16:41:49.858507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:41:49.858968 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:41:49.859298 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:41:49.859620 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:41:49.866322 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.868147 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:41:49.869836 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:41:49.870350 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:41:49.901121 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m16:41:49.902226 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.903727 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.904291 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:41:49.904858 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m16:41:49.905143 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:41:49.904516 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m16:41:49.905695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:49.911374 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m16:41:49.914012 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:41:49.914412 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m16:41:49.915394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m16:41:49.915791 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.916137 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m16:41:49.916391 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:41:49.921764 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:41:49.922411 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m16:41:49.922044 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:41:49.926354 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.926956 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m16:41:49.926644 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:41:49.968795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.041 seconds
[0m16:41:49.976261 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:41:49.976645 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.976971 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m16:41:49.975084 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:41:49.977499 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:41:49.977888 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m16:41:49.978274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m16:41:49.983294 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m16:41:49.986650 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m16:41:49.986971 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m16:41:49.983560 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m16:41:49.989055 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m16:41:49.989720 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m16:41:49.990018 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m16:41:49.989282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m16:41:49.992813 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m16:41:49.990557 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m16:41:49.995850 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m16:41:49.996330 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3e3fd0>]}
[0m16:41:49.994565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39ba430>]}
[0m16:41:49.997691 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:41:49.998274 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:41:49.996958 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m16:41:49.998952 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:41:49.999790 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:41:50.000269 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m16:41:50.000836 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:41:50.001217 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:41:50.004040 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:41:50.005712 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:41:50.023393 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m16:41:50.024663 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:41:50.025000 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m16:41:50.025311 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:41:50.031673 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m16:41:50.032029 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:41:50.032341 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m16:41:50.039775 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.007 seconds
[0m16:41:50.042542 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:41:50.042839 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m16:41:50.043275 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:41:50.046665 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:41:50.046975 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m16:41:50.047391 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:41:50.052454 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:41:50.052785 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:41:50.053112 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m16:41:50.054124 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m16:41:50.056120 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m16:41:50.057955 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m16:41:50.058259 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m16:41:50.059638 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m16:41:50.060616 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m16:41:50.061139 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d9a72a-41f7-41aa-acae-58b578a5385f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4a91c0>]}
[0m16:41:50.061671 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m16:41:50.062228 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:41:50.063239 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:50.063612 [debug] [MainThread]: On master: BEGIN
[0m16:41:50.063865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:50.069823 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:41:50.070137 [debug] [MainThread]: On master: COMMIT
[0m16:41:50.070408 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:50.070712 [debug] [MainThread]: On master: COMMIT
[0m16:41:50.071078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:41:50.071350 [debug] [MainThread]: On master: Close
[0m16:41:50.071727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:50.072007 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:41:50.072280 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:41:50.072522 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:41:50.072905 [info ] [MainThread]: 
[0m16:41:50.073317 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m16:41:50.074246 [debug] [MainThread]: Command end result
[0m16:41:50.096578 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:41:50.098075 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:41:50.103194 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:41:50.103462 [info ] [MainThread]: 
[0m16:41:50.103865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:50.104199 [info ] [MainThread]: 
[0m16:41:50.104604 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:41:50.105404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7886702, "process_in_blocks": "0", "process_kernel_time": 0.094776, "process_mem_max_rss": "111140", "process_out_blocks": "1793", "process_user_time": 1.540371}
[0m16:41:50.105852 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:50.105767 after 0.79 seconds
[0m16:41:50.106184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fa1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0476640>]}
[0m16:41:50.106503 [debug] [MainThread]: Flushing usage events
[0m16:41:51.464761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:52.637105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5f320a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50528b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5052910>]}


============================== 16:41:52.640196 | 67d7c0bb-b375-462e-ab56-bbf9ad39f668 ==============================
[0m16:41:52.640196 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:41:52.640925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:52.754830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67d7c0bb-b375-462e-ab56-bbf9ad39f668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50b90d0>]}
[0m16:41:52.797774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67d7c0bb-b375-462e-ab56-bbf9ad39f668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4340280>]}
[0m16:41:52.798562 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:41:52.852779 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:41:52.961596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:52.962220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:53.022536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67d7c0bb-b375-462e-ab56-bbf9ad39f668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f64130>]}
[0m16:41:53.032289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67d7c0bb-b375-462e-ab56-bbf9ad39f668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f97a90>]}
[0m16:41:53.032837 [info ] [MainThread]: Found 3 models, 433 macros
[0m16:41:53.033254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d7c0bb-b375-462e-ab56-bbf9ad39f668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f979d0>]}
[0m16:41:53.034772 [info ] [MainThread]: 
[0m16:41:53.035229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:53.035703 [info ] [MainThread]: 
[0m16:41:53.036494 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:53.040444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m16:41:53.069101 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:41:53.069594 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m16:41:53.069998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:53.077523 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:41:53.078006 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m16:41:53.078378 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:41:53.080921 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m16:41:53.082146 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m16:41:53.082559 [debug] [ThreadPool]: On list_analytics_public: Close
[0m16:41:53.087016 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:53.087429 [debug] [MainThread]: On master: BEGIN
[0m16:41:53.087678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:53.093840 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:41:53.094278 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:53.094688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:41:53.097713 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m16:41:53.099215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d7c0bb-b375-462e-ab56-bbf9ad39f668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f2ef70>]}
[0m16:41:53.099674 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:53.100174 [debug] [MainThread]: On master: Close
[0m16:41:53.102720 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m16:41:53.103084 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m16:41:53.103619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m16:41:53.104180 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m16:41:53.104669 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m16:41:53.105184 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m16:41:53.112021 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m16:41:53.114067 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m16:41:53.115469 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m16:41:53.116157 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m16:41:53.116552 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m16:41:53.117269 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m16:41:53.118018 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m16:41:53.118636 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m16:41:53.118960 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m16:41:53.121589 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m16:41:53.122506 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m16:41:53.123129 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m16:41:53.123996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:53.124270 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m16:41:53.124528 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m16:41:53.124733 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m16:41:53.125341 [debug] [MainThread]: Command end result
[0m16:41:53.184549 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:41:53.187157 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:41:53.193009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:41:53.200121 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:41:53.200489 [info ] [MainThread]: Building catalog
[0m16:41:53.208003 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m16:41:53.214609 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:41:53.214964 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m16:41:53.215297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:53.222153 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:41:53.222646 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m16:41:53.223106 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:41:53.225878 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m16:41:53.229608 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m16:41:53.230228 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m16:41:53.240818 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m16:41:53.305320 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:41:53.307463 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:41:53.307784 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m16:41:53.308784 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.7143972, "process_in_blocks": "0", "process_kernel_time": 0.111959, "process_mem_max_rss": "108688", "process_out_blocks": "5027", "process_user_time": 1.508936}
[0m16:41:53.309162 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:41:53.309092 after 0.71 seconds
[0m16:41:53.309463 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:41:53.309707 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m16:41:53.309967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5f320a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4083460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb33095e0>]}
[0m16:41:53.310260 [debug] [MainThread]: Flushing usage events
[0m16:41:54.456051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:55.629768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a41130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b829d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b82a30>]}


============================== 16:41:55.632878 | 66f58b12-5aa9-4fd0-8072-b2d5dec3c191 ==============================
[0m16:41:55.632878 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:41:55.633556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8081', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:55.749622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f58b12-5aa9-4fd0-8072-b2d5dec3c191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85eaa3d0>]}
[0m16:41:55.790517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f58b12-5aa9-4fd0-8072-b2d5dec3c191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d64a30>]}
[0m17:06:51.033958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71713d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb62868b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6286910>]}


============================== 17:06:51.040856 | e95298a1-ae61-4d15-a020-2e77235022a3 ==============================
[0m17:06:51.040856 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:06:51.041667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:51.127996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e95298a1-ae61-4d15-a020-2e77235022a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89f9dc0>]}
[0m17:06:51.136282 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:06:51.138468 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:06:51.139531 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15203938, "process_in_blocks": "0", "process_kernel_time": 0.119193, "process_mem_max_rss": "90936", "process_out_blocks": "963", "process_user_time": 1.157591}
[0m17:06:51.139933 [debug] [MainThread]: Command `dbt deps` succeeded at 17:06:51.139861 after 0.15 seconds
[0m17:06:51.140265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71713d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6190cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61b2430>]}
[0m17:06:51.140610 [debug] [MainThread]: Flushing usage events
[0m17:06:56.176575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:57.802623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e681190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7c36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7c3670>]}


============================== 17:06:57.807236 | 85c9e143-e6a9-4ebf-b6d5-ce594a258b28 ==============================
[0m17:06:57.807236 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:06:57.808254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:58.043707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e51c7c0>]}
[0m17:06:58.091589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d849430>]}
[0m17:06:58.093507 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:06:58.167724 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:06:58.250260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:58.250806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:58.276369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6b3130>]}
[0m17:06:58.334615 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:06:58.338391 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:06:58.354338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6e2550>]}
[0m17:06:58.354935 [info ] [MainThread]: Found 3 models, 433 macros
[0m17:06:58.355404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6c1760>]}
[0m17:06:58.358726 [info ] [MainThread]: 
[0m17:06:58.359451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:58.360125 [info ] [MainThread]: 
[0m17:06:58.360824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:58.366694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:06:58.401606 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:06:58.402445 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:06:58.402943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:58.416223 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m17:06:58.417677 [debug] [ThreadPool]: On list_analytics: Close
[0m17:06:58.419431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m17:06:58.424707 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:06:58.425158 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m17:06:58.425527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:58.433410 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:06:58.433847 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:06:58.434497 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:06:58.438222 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m17:06:58.439470 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m17:06:58.440031 [debug] [ThreadPool]: On list_analytics_public: Close
[0m17:06:58.444665 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.445129 [debug] [MainThread]: On master: BEGIN
[0m17:06:58.445547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:58.453532 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:06:58.453983 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.454443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:58.458627 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m17:06:58.460075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7badf070>]}
[0m17:06:58.460838 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:58.461428 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.461816 [debug] [MainThread]: On master: BEGIN
[0m17:06:58.462409 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:06:58.462835 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.463157 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.463491 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.463951 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:58.464365 [debug] [MainThread]: On master: Close
[0m17:06:58.474011 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m17:06:58.474562 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m17:06:58.475583 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m17:06:58.476662 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m17:06:58.478251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m17:06:58.478962 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m17:06:58.479505 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m17:06:58.480496 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m17:06:58.501995 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.514711 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m17:06:58.517894 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m17:06:58.526733 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m17:06:58.557300 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m17:06:58.559431 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.561229 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:06:58.562189 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m17:06:58.562596 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:06:58.561939 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.563491 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m17:06:58.564239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:58.572296 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m17:06:58.572844 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:06:58.573678 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m17:06:58.574298 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m17:06:58.574794 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.575280 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m17:06:58.575860 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:06:58.581434 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:06:58.582104 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m17:06:58.581715 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m17:06:58.585905 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.586513 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m17:06:58.586174 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:06:58.648280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.061 seconds
[0m17:06:58.657057 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m17:06:58.657569 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.658047 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m17:06:58.655649 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m17:06:58.658946 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:06:58.659593 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m17:06:58.659297 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m17:06:58.664973 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m17:06:58.665247 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m17:06:58.668914 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:06:58.671656 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m17:06:58.671313 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m17:06:58.672578 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:06:58.672852 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m17:06:58.672174 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m17:06:58.675365 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m17:06:58.673229 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m17:06:58.678038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fef0eb0>]}
[0m17:06:58.679833 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m17:06:58.680814 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m17:06:58.682693 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m17:06:58.681890 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b95ef70>]}
[0m17:06:58.683857 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m17:06:58.684641 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m17:06:58.685618 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m17:06:58.686238 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m17:06:58.686944 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m17:06:58.687424 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m17:06:58.690651 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m17:06:58.692756 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m17:06:58.711357 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m17:06:58.712994 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:06:58.713451 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m17:06:58.713817 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:06:58.721120 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m17:06:58.721577 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:06:58.722027 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m17:06:58.731755 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.009 seconds
[0m17:06:58.734818 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:06:58.735269 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m17:06:58.735921 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:06:58.739656 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:06:58.740046 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m17:06:58.740523 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:06:58.746099 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m17:06:58.746600 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:06:58.747039 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m17:06:58.748343 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m17:06:58.750781 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m17:06:58.752854 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:06:58.753255 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m17:06:58.755823 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m17:06:58.756995 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m17:06:58.757600 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c9e143-e6a9-4ebf-b6d5-ce594a258b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800d5400>]}
[0m17:06:58.758214 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m17:06:58.758833 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m17:06:58.759892 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.760260 [debug] [MainThread]: On master: BEGIN
[0m17:06:58.760646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:58.767364 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:06:58.767732 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.768077 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:58.768383 [debug] [MainThread]: On master: COMMIT
[0m17:06:58.768757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:58.769040 [debug] [MainThread]: On master: Close
[0m17:06:58.769407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:58.769823 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m17:06:58.770058 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m17:06:58.770331 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m17:06:58.770756 [info ] [MainThread]: 
[0m17:06:58.771112 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m17:06:58.772239 [debug] [MainThread]: Command end result
[0m17:06:58.796806 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:06:58.798902 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:06:58.805213 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:06:58.805521 [info ] [MainThread]: 
[0m17:06:58.805928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:58.806542 [info ] [MainThread]: 
[0m17:06:58.807438 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:06:58.809335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0632805, "process_in_blocks": "0", "process_kernel_time": 0.191522, "process_mem_max_rss": "111232", "process_out_blocks": "1793", "process_user_time": 2.13069}
[0m17:06:58.810502 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:58.810377 after 1.06 seconds
[0m17:06:58.810982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e681190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6e2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb398e0>]}
[0m17:06:58.815219 [debug] [MainThread]: Flushing usage events
[0m17:06:59.997051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:01.283021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57f1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49427f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4942850>]}


============================== 17:07:01.286272 | 0690d29b-e287-4bab-80bb-1790f1c80ae8 ==============================
[0m17:07:01.286272 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:07:01.286904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m17:07:01.417199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0690d29b-e287-4bab-80bb-1790f1c80ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7089970>]}
[0m17:07:01.460311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0690d29b-e287-4bab-80bb-1790f1c80ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d1f640>]}
[0m17:07:01.461194 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:07:01.517666 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:07:01.592299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:01.592749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:01.617461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0690d29b-e287-4bab-80bb-1790f1c80ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb38329a0>]}
[0m17:07:01.627490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0690d29b-e287-4bab-80bb-1790f1c80ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3866b50>]}
[0m17:07:01.628031 [info ] [MainThread]: Found 3 models, 433 macros
[0m17:07:01.628460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0690d29b-e287-4bab-80bb-1790f1c80ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3866a90>]}
[0m17:07:01.629844 [info ] [MainThread]: 
[0m17:07:01.630258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:01.630666 [info ] [MainThread]: 
[0m17:07:01.631255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:01.634949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m17:07:01.665015 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:07:01.665502 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m17:07:01.665839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:01.674400 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:07:01.674874 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:07:01.675201 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:07:01.677512 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m17:07:01.678675 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m17:07:01.679120 [debug] [ThreadPool]: On list_analytics_public: Close
[0m17:07:01.683828 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:01.684154 [debug] [MainThread]: On master: BEGIN
[0m17:07:01.684435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:01.691481 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:07:01.691929 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:01.692325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:01.695646 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m17:07:01.697040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0690d29b-e287-4bab-80bb-1790f1c80ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3866d30>]}
[0m17:07:01.697514 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:01.697982 [debug] [MainThread]: On master: Close
[0m17:07:01.700237 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m17:07:01.700550 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m17:07:01.701014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m17:07:01.701509 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m17:07:01.701898 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m17:07:01.702349 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m17:07:01.709975 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m17:07:01.711997 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m17:07:01.715069 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m17:07:01.717129 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m17:07:01.717379 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m17:07:01.719164 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m17:07:01.720211 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m17:07:01.721056 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m17:07:01.721563 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m17:07:01.724468 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m17:07:01.726344 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m17:07:01.727202 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m17:07:01.728317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:01.728707 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m17:07:01.729110 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m17:07:01.729354 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m17:07:01.730030 [debug] [MainThread]: Command end result
[0m17:07:01.788729 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:07:01.791833 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:07:01.798039 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:07:01.802184 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:07:01.802454 [info ] [MainThread]: Building catalog
[0m17:07:01.809702 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m17:07:01.815719 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m17:07:01.816178 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m17:07:01.816579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:01.823602 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:07:01.823970 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m17:07:01.824413 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:07:01.827811 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m17:07:01.831251 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m17:07:01.831756 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m17:07:01.843012 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m17:07:01.904063 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:07:01.906275 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:07:01.906672 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m17:07:01.907798 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.66948557, "process_in_blocks": "0", "process_kernel_time": 0.117222, "process_mem_max_rss": "108756", "process_out_blocks": "5027", "process_user_time": 1.518886}
[0m17:07:01.908397 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:07:01.908277 after 0.67 seconds
[0m17:07:01.908807 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:07:01.909074 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m17:07:01.909404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57f1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3953520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2bcc4f0>]}
[0m17:07:01.909795 [debug] [MainThread]: Flushing usage events
[0m17:07:03.017915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:04.281652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc81100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adc29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adc2a00>]}


============================== 17:07:04.284906 | 1b098d06-2b9a-4e94-93d7-819cdd22c82b ==============================
[0m17:07:04.284906 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:07:04.285574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8081', 'send_anonymous_usage_stats': 'True'}
[0m17:07:04.402372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b098d06-2b9a-4e94-93d7-819cdd22c82b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae70250>]}
[0m17:07:04.445901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b098d06-2b9a-4e94-93d7-819cdd22c82b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7beca130>]}
[0m17:14:55.891424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bb10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cc9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cc9430>]}


============================== 17:14:55.895409 | 623aafc3-475b-47a0-bea5-769f495d2653 ==============================
[0m17:14:55.895409 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:14:55.896096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:55.988583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '623aafc3-475b-47a0-bea5-769f495d2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cc99d0>]}
[0m17:14:56.000884 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:56.002802 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:14:56.004126 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15743066, "process_in_blocks": "60432", "process_kernel_time": 0.160569, "process_mem_max_rss": "90388", "process_out_blocks": "3", "process_user_time": 1.187211}
[0m17:14:56.004538 [debug] [MainThread]: Command `dbt deps` succeeded at 17:14:56.004454 after 0.16 seconds
[0m17:14:56.004844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bb10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bcec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cc99d0>]}
[0m17:14:56.005142 [debug] [MainThread]: Flushing usage events
[0m17:15:01.146583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:02.375629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf01130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b042a30>]}


============================== 17:15:02.378690 | d8d022e1-1159-4ca2-b11c-db8a2acb24be ==============================
[0m17:15:02.378690 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:15:02.379429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:02.498479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d76b940>]}
[0m17:15:02.541446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd26df0>]}
[0m17:15:02.542372 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:02.603827 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:15:02.691813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:02.692286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:02.718809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f39eb0>]}
[0m17:15:02.777063 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:15:02.780320 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:15:02.790637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a327a60>]}
[0m17:15:02.791123 [info ] [MainThread]: Found 3 models, 433 macros
[0m17:15:02.791600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2bf880>]}
[0m17:15:02.793066 [info ] [MainThread]: 
[0m17:15:02.793518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:02.793949 [info ] [MainThread]: 
[0m17:15:02.794499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:02.798212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m17:15:02.831538 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m17:15:02.831991 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:15:02.832258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:02.840639 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m17:15:02.841620 [debug] [ThreadPool]: On list_analytics: Close
[0m17:15:02.842843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m17:15:02.848009 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:15:02.848294 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m17:15:02.848550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:02.854636 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:15:02.855052 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:15:02.855391 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:15:02.861508 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m17:15:02.862550 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m17:15:02.863023 [debug] [ThreadPool]: On list_analytics_public: Close
[0m17:15:02.866994 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:02.867316 [debug] [MainThread]: On master: BEGIN
[0m17:15:02.867570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:02.873444 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:15:02.873812 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:02.874188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:02.878331 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m17:15:02.879336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8c4760>]}
[0m17:15:02.879780 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:02.880201 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:02.880438 [debug] [MainThread]: On master: BEGIN
[0m17:15:02.880884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:15:02.881243 [debug] [MainThread]: On master: COMMIT
[0m17:15:02.881511 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:02.881772 [debug] [MainThread]: On master: COMMIT
[0m17:15:02.882106 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:02.882357 [debug] [MainThread]: On master: Close
[0m17:15:02.885029 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m17:15:02.885279 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m17:15:02.885749 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m17:15:02.886317 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m17:15:02.886868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m17:15:02.887311 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m17:15:02.887683 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m17:15:02.887974 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m17:15:02.895522 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m17:15:02.897360 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m17:15:02.901017 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m17:15:02.910518 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m17:15:02.945917 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m17:15:02.947486 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m17:15:02.949866 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:15:02.950604 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m17:15:02.950893 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:15:02.950367 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:15:02.951627 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m17:15:02.952281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:02.961488 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m17:15:02.961961 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:15:02.962457 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m17:15:02.962837 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m17:15:02.963375 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:15:02.963823 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m17:15:02.965336 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:15:02.971426 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:15:02.971969 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m17:15:02.971703 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:15:02.975279 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:15:02.975749 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m17:15:02.975502 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:15:03.019013 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.043 seconds
[0m17:15:03.027168 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m17:15:03.028742 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:15:03.029106 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m17:15:03.028308 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m17:15:03.029758 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:15:03.030301 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m17:15:03.030096 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m17:15:03.035773 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m17:15:03.036078 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m17:15:03.039258 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m17:15:03.041341 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m17:15:03.042293 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m17:15:03.042608 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m17:15:03.041749 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m17:15:03.043176 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m17:15:03.043394 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m17:15:03.045417 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m17:15:03.046537 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m17:15:03.048677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3dda60>]}
[0m17:15:03.049447 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:15:03.050021 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m17:15:03.048943 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791c13a0>]}
[0m17:15:03.050640 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:15:03.051127 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m17:15:03.051729 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m17:15:03.052252 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m17:15:03.052823 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m17:15:03.053254 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m17:15:03.056021 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m17:15:03.057471 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m17:15:03.074769 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m17:15:03.076345 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:15:03.076668 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m17:15:03.076941 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:15:03.082965 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m17:15:03.083334 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:15:03.083652 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m17:15:03.092102 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m17:15:03.094970 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:15:03.095323 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m17:15:03.095796 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:15:03.099077 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:15:03.099492 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m17:15:03.100077 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:15:03.108377 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m17:15:03.109095 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:15:03.109718 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m17:15:03.110969 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m17:15:03.113326 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m17:15:03.115363 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m17:15:03.115754 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m17:15:03.117336 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m17:15:03.118467 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m17:15:03.118992 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d022e1-1159-4ca2-b11c-db8a2acb24be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79320f70>]}
[0m17:15:03.119543 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m17:15:03.120114 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m17:15:03.121137 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:03.121502 [debug] [MainThread]: On master: BEGIN
[0m17:15:03.121758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:03.127880 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:15:03.128366 [debug] [MainThread]: On master: COMMIT
[0m17:15:03.128667 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:03.128941 [debug] [MainThread]: On master: COMMIT
[0m17:15:03.129376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:03.129672 [debug] [MainThread]: On master: Close
[0m17:15:03.130072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:03.130363 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m17:15:03.130628 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m17:15:03.130893 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m17:15:03.131255 [info ] [MainThread]: 
[0m17:15:03.131593 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:15:03.132418 [debug] [MainThread]: Command end result
[0m17:15:03.155802 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:15:03.157390 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:15:03.162941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:15:03.163220 [info ] [MainThread]: 
[0m17:15:03.163599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:03.164006 [info ] [MainThread]: 
[0m17:15:03.164452 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:15:03.165338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8317657, "process_in_blocks": "4688", "process_kernel_time": 0.126363, "process_mem_max_rss": "110540", "process_out_blocks": "1705", "process_user_time": 1.58456}
[0m17:15:03.165774 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:03.165672 after 0.83 seconds
[0m17:15:03.166146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf01130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b794ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a12b400>]}
[0m17:15:03.166478 [debug] [MainThread]: Flushing usage events
[0m17:15:04.309032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:05.619308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f01160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80427f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8042850>]}


============================== 17:15:05.622762 | fdf8a875-028e-420b-921e-9317afec7cd9 ==============================
[0m17:15:05.622762 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:15:05.623414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:15:05.745570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf8a875-028e-420b-921e-9317afec7cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba76a970>]}
[0m17:15:05.788549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf8a875-028e-420b-921e-9317afec7cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb741f640>]}
[0m17:15:05.789389 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:05.844433 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:15:05.921324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:05.921811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:05.947274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdf8a875-028e-420b-921e-9317afec7cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f339a0>]}
[0m17:15:05.958632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf8a875-028e-420b-921e-9317afec7cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f65b50>]}
[0m17:15:05.959188 [info ] [MainThread]: Found 3 models, 433 macros
[0m17:15:05.959654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf8a875-028e-420b-921e-9317afec7cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f65a90>]}
[0m17:15:05.961076 [info ] [MainThread]: 
[0m17:15:05.961459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:15:05.961792 [info ] [MainThread]: 
[0m17:15:05.962355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:05.966276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m17:15:05.996784 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:15:05.997209 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m17:15:05.997459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:06.004309 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:15:06.004774 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m17:15:06.005155 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:15:06.007218 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m17:15:06.008322 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m17:15:06.008725 [debug] [ThreadPool]: On list_analytics_public: Close
[0m17:15:06.013149 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:06.013554 [debug] [MainThread]: On master: BEGIN
[0m17:15:06.013856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:06.019905 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:15:06.020330 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:06.020675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:06.023411 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m17:15:06.024667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf8a875-028e-420b-921e-9317afec7cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f65d30>]}
[0m17:15:06.025095 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:06.025484 [debug] [MainThread]: On master: Close
[0m17:15:06.027752 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m17:15:06.028033 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m17:15:06.028484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m17:15:06.028944 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m17:15:06.029361 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m17:15:06.029721 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m17:15:06.036481 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m17:15:06.038299 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m17:15:06.039497 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m17:15:06.040182 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m17:15:06.040407 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m17:15:06.041088 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m17:15:06.041756 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m17:15:06.042260 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m17:15:06.042561 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m17:15:06.045349 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m17:15:06.046054 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m17:15:06.046545 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m17:15:06.047346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:06.047623 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m17:15:06.047907 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m17:15:06.048141 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m17:15:06.048727 [debug] [MainThread]: Command end result
[0m17:15:06.107395 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:15:06.110009 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:15:06.116033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:15:06.121133 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:15:06.121413 [info ] [MainThread]: Building catalog
[0m17:15:06.128763 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m17:15:06.134899 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m17:15:06.135256 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m17:15:06.135534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:06.142670 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:15:06.143095 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m17:15:06.143473 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:15:06.153331 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.009 seconds
[0m17:15:06.156820 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m17:15:06.157324 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m17:15:06.167926 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m17:15:06.229450 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:15:06.231404 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:15:06.231827 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m17:15:06.232922 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6578832, "process_in_blocks": "3392", "process_kernel_time": 0.117869, "process_mem_max_rss": "108504", "process_out_blocks": "5027", "process_user_time": 1.489352}
[0m17:15:06.233472 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:15:06.233372 after 0.66 seconds
[0m17:15:06.233843 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:15:06.234155 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m17:15:06.234488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f01160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7053520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb62ce5e0>]}
[0m17:15:06.234830 [debug] [MainThread]: Flushing usage events
[0m17:15:07.386453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:08.656196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853f10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8454a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8454a520>]}


============================== 17:15:08.659262 | c08b0839-dc69-40be-ad43-b0fed811c04f ==============================
[0m17:15:08.659262 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:15:08.659883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8081', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:15:08.789248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c08b0839-dc69-40be-ad43-b0fed811c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838d17c0>]}
[0m17:15:08.832954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c08b0839-dc69-40be-ad43-b0fed811c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8470e9d0>]}
[0m18:38:10.752542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ff1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96146820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96146880>]}


============================== 18:38:10.756475 | 99fb10f8-074f-43dd-8db6-d271cc9eff4b ==============================
[0m18:38:10.756475 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:10.756920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:10.815752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99fb10f8-074f-43dd-8db6-d271cc9eff4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967f2940>]}
[0m18:38:10.821475 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:38:10.822961 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:38:10.823644 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10179287, "process_in_blocks": "1160", "process_kernel_time": 0.119917, "process_mem_max_rss": "91004", "process_out_blocks": "963", "process_user_time": 0.898384}
[0m18:38:10.824059 [debug] [MainThread]: Command `dbt deps` succeeded at 18:38:10.823961 after 0.10 seconds
[0m18:38:10.824348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ff1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96051cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967f2940>]}
[0m18:38:10.824620 [debug] [MainThread]: Flushing usage events
[0m18:38:18.245088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:19.135100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03c2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03c25b0>]}


============================== 18:38:19.137322 | 61b58efd-bb47-45e9-b0be-d78589ac515d ==============================
[0m18:38:19.137322 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:19.137865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:38:19.229962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2af0d00>]}
[0m18:38:19.262934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0410520>]}
[0m18:38:19.263768 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:38:19.305270 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:38:19.365498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:19.365894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:19.384076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2b2130>]}
[0m18:38:19.423669 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:38:19.426217 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:38:19.436493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2e2550>]}
[0m18:38:19.436914 [info ] [MainThread]: Found 3 models, 433 macros
[0m18:38:19.437374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2c0bb0>]}
[0m18:38:19.438447 [info ] [MainThread]: 
[0m18:38:19.438875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:38:19.439143 [info ] [MainThread]: 
[0m18:38:19.439569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:38:19.442182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:38:19.464102 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:38:19.464412 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:38:19.464599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:19.476278 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m18:38:19.485495 [debug] [ThreadPool]: On list_analytics: Close
[0m18:38:19.486744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m18:38:19.490908 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:38:19.491219 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m18:38:19.491465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:19.496926 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:38:19.497301 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:38:19.497658 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:38:19.500254 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m18:38:19.501083 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m18:38:19.501410 [debug] [ThreadPool]: On list_analytics_public: Close
[0m18:38:19.504451 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:19.504714 [debug] [MainThread]: On master: BEGIN
[0m18:38:19.504938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:19.511357 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:38:19.511720 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:19.512051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:19.514720 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:38:19.515547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2fa2e0>]}
[0m18:38:19.515882 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:19.516338 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:19.516635 [debug] [MainThread]: On master: BEGIN
[0m18:38:19.517040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:38:19.517287 [debug] [MainThread]: On master: COMMIT
[0m18:38:19.517511 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:19.517717 [debug] [MainThread]: On master: COMMIT
[0m18:38:19.517991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:38:19.518229 [debug] [MainThread]: On master: Close
[0m18:38:19.522864 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m18:38:19.523098 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m18:38:19.523486 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m18:38:19.524417 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m18:38:19.524951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m18:38:19.525434 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m18:38:19.525711 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m18:38:19.526034 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m18:38:19.530703 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.532000 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m18:38:19.533526 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m18:38:19.542649 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m18:38:19.552920 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.555507 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m18:38:19.557123 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.557675 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m18:38:19.557891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:19.557462 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:38:19.558389 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m18:38:19.558868 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:38:19.569214 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:38:19.570556 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.571000 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m18:38:19.571230 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m18:38:19.571763 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:38:19.572449 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m18:38:19.577256 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:38:19.577467 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:38:19.582524 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:38:19.585537 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m18:38:19.585256 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.585970 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m18:38:19.586177 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:38:19.618558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.032 seconds
[0m18:38:19.623265 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m18:38:19.624494 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:38:19.624745 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m18:38:19.624186 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m18:38:19.625218 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.625642 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m18:38:19.625864 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m18:38:19.629538 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m18:38:19.629736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m18:38:19.633801 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m18:38:19.634310 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:38:19.634577 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m18:38:19.632325 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:38:19.634945 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m18:38:19.635138 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:38:19.635428 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:38:19.637216 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m18:38:19.638193 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m18:38:19.639736 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae55b820>]}
[0m18:38:19.639348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dbc610>]}
[0m18:38:19.641306 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:38:19.641795 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m18:38:19.640607 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:38:19.642386 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m18:38:19.643202 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m18:38:19.643760 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m18:38:19.644200 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m18:38:19.644554 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m18:38:19.647851 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m18:38:19.649074 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m18:38:19.669864 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m18:38:19.671189 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:38:19.671453 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m18:38:19.671774 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:38:19.678039 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m18:38:19.678426 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:38:19.678653 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m18:38:19.685624 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.007 seconds
[0m18:38:19.687889 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:38:19.688240 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m18:38:19.688719 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:38:19.691623 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m18:38:19.691979 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:38:19.692362 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m18:38:19.693375 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m18:38:19.695765 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m18:38:19.697435 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:38:19.697677 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m18:38:19.698015 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.000 seconds
[0m18:38:19.698814 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m18:38:19.699230 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b58efd-bb47-45e9-b0be-d78589ac515d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae573700>]}
[0m18:38:19.699688 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m18:38:19.700206 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m18:38:19.700991 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:19.701231 [debug] [MainThread]: On master: BEGIN
[0m18:38:19.701408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:19.707863 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:38:19.709270 [debug] [MainThread]: On master: COMMIT
[0m18:38:19.710234 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:19.710677 [debug] [MainThread]: On master: COMMIT
[0m18:38:19.711389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:38:19.711823 [debug] [MainThread]: On master: Close
[0m18:38:19.712873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:19.713726 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m18:38:19.714684 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m18:38:19.715969 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m18:38:19.716323 [info ] [MainThread]: 
[0m18:38:19.716979 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m18:38:19.718203 [debug] [MainThread]: Command end result
[0m18:38:19.735933 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:38:19.737461 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:38:19.741900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:38:19.742129 [info ] [MainThread]: 
[0m18:38:19.742432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:19.742716 [info ] [MainThread]: 
[0m18:38:19.743069 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:38:19.743827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6447143, "process_in_blocks": "112", "process_kernel_time": 0.117245, "process_mem_max_rss": "111088", "process_out_blocks": "1792", "process_user_time": 1.156561}
[0m18:38:19.744100 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:19.744055 after 0.65 seconds
[0m18:38:19.744361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae6eefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2e2520>]}
[0m18:38:19.744577 [debug] [MainThread]: Flushing usage events
[0m18:38:25.694118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:26.508306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f71100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84082850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840828b0>]}


============================== 18:38:26.510679 | 469fc213-3724-4b0a-b46f-85c8eb20cf77 ==============================
[0m18:38:26.510679 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:26.511232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:26.596256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '469fc213-3724-4b0a-b46f-85c8eb20cf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e6f3a0>]}
[0m18:38:26.626020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '469fc213-3724-4b0a-b46f-85c8eb20cf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833efa60>]}
[0m18:38:26.626624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:38:26.665650 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:38:26.721389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:26.721704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:26.739777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '469fc213-3724-4b0a-b46f-85c8eb20cf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fb4130>]}
[0m18:38:26.748287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '469fc213-3724-4b0a-b46f-85c8eb20cf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fe6af0>]}
[0m18:38:26.748715 [info ] [MainThread]: Found 3 models, 433 macros
[0m18:38:26.749100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '469fc213-3724-4b0a-b46f-85c8eb20cf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fe6a30>]}
[0m18:38:26.750303 [info ] [MainThread]: 
[0m18:38:26.750666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:38:26.751034 [info ] [MainThread]: 
[0m18:38:26.751559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:38:26.755083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m18:38:26.785713 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:38:26.786104 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m18:38:26.786425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:26.791539 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:38:26.791926 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:38:26.792242 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:38:26.793870 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m18:38:26.794793 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m18:38:26.795125 [debug] [ThreadPool]: On list_analytics_public: Close
[0m18:38:26.798442 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:26.798716 [debug] [MainThread]: On master: BEGIN
[0m18:38:26.798922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:26.803588 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:38:26.804002 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:26.804417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:26.806381 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m18:38:26.807495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '469fc213-3724-4b0a-b46f-85c8eb20cf77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fe6d00>]}
[0m18:38:26.807850 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:26.808211 [debug] [MainThread]: On master: Close
[0m18:38:26.810032 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m18:38:26.810266 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m18:38:26.810647 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m18:38:26.811149 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m18:38:26.811465 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m18:38:26.811752 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m18:38:26.816446 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m18:38:26.817794 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m18:38:26.818779 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m18:38:26.819256 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m18:38:26.819616 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m18:38:26.820161 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m18:38:26.820818 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m18:38:26.821158 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m18:38:26.821366 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m18:38:26.823222 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m18:38:26.823811 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m18:38:26.824175 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m18:38:26.824779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:26.825054 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m18:38:26.825242 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m18:38:26.825400 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m18:38:26.825856 [debug] [MainThread]: Command end result
[0m18:38:26.865944 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:38:26.868067 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:38:26.872441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:38:26.875761 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:38:26.875945 [info ] [MainThread]: Building catalog
[0m18:38:26.881547 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m18:38:26.886195 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:38:26.886506 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m18:38:26.886732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:26.891602 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:38:26.891927 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:38:26.892250 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:38:26.894047 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.001 seconds
[0m18:38:26.896145 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m18:38:26.896437 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m18:38:26.903364 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m18:38:26.946906 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:38:26.947984 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:38:26.948178 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m18:38:26.948857 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.4731177, "process_in_blocks": "0", "process_kernel_time": 0.080105, "process_mem_max_rss": "108656", "process_out_blocks": "5027", "process_user_time": 1.014337}
[0m18:38:26.949152 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:38:26.949084 after 0.47 seconds
[0m18:38:26.949372 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:38:26.949532 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m18:38:26.949714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f71100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830d3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830d3490>]}
[0m18:38:26.949918 [debug] [MainThread]: Flushing usage events
[0m18:39:05.768539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93301400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92446850>]}


============================== 18:39:05.772522 | 73827076-f876-4286-aef9-a55902da7b6d ==============================
[0m18:39:05.772522 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:39:05.772917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:39:05.830050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73827076-f876-4286-aef9-a55902da7b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928e29a0>]}
[0m18:39:05.835430 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:39:05.836797 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:39:05.837520 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.105317704, "process_in_blocks": "0", "process_kernel_time": 0.100791, "process_mem_max_rss": "90836", "process_out_blocks": "963", "process_user_time": 0.875562}
[0m18:39:05.837958 [debug] [MainThread]: Command `dbt deps` succeeded at 18:39:05.837857 after 0.11 seconds
[0m18:39:05.838300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93301400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92355cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928e29a0>]}
[0m18:39:05.838565 [debug] [MainThread]: Flushing usage events
[0m18:39:10.634256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:11.479486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa771160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98846a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9884640>]}


============================== 18:39:11.481949 | 3152b8d3-4f26-41ae-b866-d582acd254b7 ==============================
[0m18:39:11.481949 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:39:11.482353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:39:11.570081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d493d0>]}
[0m18:39:11.600744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fa8d30>]}
[0m18:39:11.601462 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:39:11.647274 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:39:11.705335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:39:11.705737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:39:11.724016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87b2130>]}
[0m18:39:11.765636 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:39:11.768058 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:39:11.777223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87e3550>]}
[0m18:39:11.777625 [info ] [MainThread]: Found 3 models, 433 macros
[0m18:39:11.777955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87c1670>]}
[0m18:39:11.779049 [info ] [MainThread]: 
[0m18:39:11.779426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:39:11.779829 [info ] [MainThread]: 
[0m18:39:11.780380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:11.783264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m18:39:11.803840 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m18:39:11.804250 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:39:11.804466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:11.810367 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m18:39:11.811262 [debug] [ThreadPool]: On list_analytics: Close
[0m18:39:11.812479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m18:39:11.816172 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:39:11.816520 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m18:39:11.816776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:11.821662 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:39:11.822076 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:39:11.822391 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:39:11.824228 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m18:39:11.825126 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m18:39:11.825461 [debug] [ThreadPool]: On list_analytics_public: Close
[0m18:39:11.828920 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:11.829226 [debug] [MainThread]: On master: BEGIN
[0m18:39:11.829444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:11.834125 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:39:11.834485 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:11.834821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:11.836972 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:39:11.837981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bc6040>]}
[0m18:39:11.838384 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:11.838749 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:11.838952 [debug] [MainThread]: On master: BEGIN
[0m18:39:11.839330 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:39:11.839603 [debug] [MainThread]: On master: COMMIT
[0m18:39:11.839965 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:11.840231 [debug] [MainThread]: On master: COMMIT
[0m18:39:11.840536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:39:11.840750 [debug] [MainThread]: On master: Close
[0m18:39:11.845360 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m18:39:11.845680 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m18:39:11.846227 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m18:39:11.846724 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m18:39:11.847222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m18:39:11.847563 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m18:39:11.847826 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m18:39:11.848089 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m18:39:11.853089 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.854635 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m18:39:11.856591 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m18:39:11.863194 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m18:39:11.878766 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m18:39:11.881925 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.883620 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:39:11.884191 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m18:39:11.884422 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:39:11.884027 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.885023 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m18:39:11.885544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:11.896585 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m18:39:11.897426 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:39:11.897804 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m18:39:11.897208 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m18:39:11.898351 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.898695 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m18:39:11.899232 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:39:11.902965 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:39:11.903543 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m18:39:11.903212 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:39:11.906724 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.907179 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m18:39:11.906944 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:39:11.939603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.032 seconds
[0m18:39:11.944122 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m18:39:11.945570 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:39:11.945827 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m18:39:11.945208 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m18:39:11.946300 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.946701 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m18:39:11.947433 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m18:39:11.947613 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:39:11.953473 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m18:39:11.951574 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m18:39:11.956556 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m18:39:11.956803 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m18:39:11.956091 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m18:39:11.957469 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m18:39:11.957272 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:39:11.959328 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m18:39:11.957893 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:39:11.960463 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b003d0>]}
[0m18:39:11.961710 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:39:11.962175 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m18:39:11.961320 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m18:39:11.962686 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a5c8b0>]}
[0m18:39:11.963074 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m18:39:11.963518 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m18:39:11.964139 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m18:39:11.964502 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m18:39:11.964944 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m18:39:11.965228 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m18:39:11.967073 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m18:39:11.968255 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m18:39:11.981273 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m18:39:11.982278 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:39:11.982583 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m18:39:11.982881 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:39:11.987782 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m18:39:11.988255 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:39:11.988614 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m18:39:11.994609 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.006 seconds
[0m18:39:11.996615 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:39:11.996864 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m18:39:11.997294 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:39:12.000143 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m18:39:12.000463 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:39:12.000734 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m18:39:12.001679 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m18:39:12.004118 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m18:39:12.005755 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m18:39:12.006028 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m18:39:12.006385 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.000 seconds
[0m18:39:12.007215 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m18:39:12.007594 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3152b8d3-4f26-41ae-b866-d582acd254b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a75d60>]}
[0m18:39:12.007999 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.04s]
[0m18:39:12.008445 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m18:39:12.009368 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:12.009639 [debug] [MainThread]: On master: BEGIN
[0m18:39:12.009864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:12.014688 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:39:12.015114 [debug] [MainThread]: On master: COMMIT
[0m18:39:12.015389 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:12.015690 [debug] [MainThread]: On master: COMMIT
[0m18:39:12.016022 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:39:12.016268 [debug] [MainThread]: On master: Close
[0m18:39:12.016626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:12.016871 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m18:39:12.017161 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m18:39:12.017374 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m18:39:12.017638 [info ] [MainThread]: 
[0m18:39:12.018041 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:39:12.018707 [debug] [MainThread]: Command end result
[0m18:39:12.035378 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:39:12.037023 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:39:12.041138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:39:12.041381 [info ] [MainThread]: 
[0m18:39:12.041779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:39:12.042139 [info ] [MainThread]: 
[0m18:39:12.042484 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:39:12.043224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5963539, "process_in_blocks": "0", "process_kernel_time": 0.086054, "process_mem_max_rss": "111112", "process_out_blocks": "1792", "process_user_time": 1.136722}
[0m18:39:12.043570 [debug] [MainThread]: Command `dbt run` succeeded at 18:39:12.043500 after 0.60 seconds
[0m18:39:12.043845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa771160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fa8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87e3550>]}
[0m18:39:12.044134 [debug] [MainThread]: Flushing usage events
[0m18:39:13.477238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:14.361818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bf1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d12850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d128b0>]}


============================== 18:39:14.364080 | 1d31a01a-2dee-44a4-9ad5-8894e80c3954 ==============================
[0m18:39:14.364080 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:39:14.364579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:39:14.446213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d31a01a-2dee-44a4-9ad5-8894e80c3954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1aef3a0>]}
[0m18:39:14.476327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d31a01a-2dee-44a4-9ad5-8894e80c3954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb006da60>]}
[0m18:39:14.476991 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:39:14.516779 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:39:14.571682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:39:14.572051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:39:14.596201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d31a01a-2dee-44a4-9ad5-8894e80c3954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc23130>]}
[0m18:39:14.603802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d31a01a-2dee-44a4-9ad5-8894e80c3954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc56af0>]}
[0m18:39:14.604220 [info ] [MainThread]: Found 3 models, 433 macros
[0m18:39:14.604571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d31a01a-2dee-44a4-9ad5-8894e80c3954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc56a30>]}
[0m18:39:14.605718 [info ] [MainThread]: 
[0m18:39:14.606122 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:39:14.606429 [info ] [MainThread]: 
[0m18:39:14.606817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:14.609421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m18:39:14.632108 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:39:14.632516 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m18:39:14.632769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:14.638637 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:39:14.638961 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m18:39:14.639191 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:39:14.641174 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m18:39:14.641978 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m18:39:14.642300 [debug] [ThreadPool]: On list_analytics_public: Close
[0m18:39:14.645867 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:14.646125 [debug] [MainThread]: On master: BEGIN
[0m18:39:14.646358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:14.650971 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:39:14.651256 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:14.651504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:14.653693 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m18:39:14.654582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d31a01a-2dee-44a4-9ad5-8894e80c3954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc56d00>]}
[0m18:39:14.654869 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:14.655227 [debug] [MainThread]: On master: Close
[0m18:39:14.657129 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m18:39:14.657395 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m18:39:14.657764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m18:39:14.658260 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m18:39:14.658602 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m18:39:14.658942 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m18:39:14.663596 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m18:39:14.665106 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m18:39:14.666034 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m18:39:14.666509 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m18:39:14.666680 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m18:39:14.667151 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m18:39:14.667618 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m18:39:14.668029 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m18:39:14.668279 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m18:39:14.670042 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m18:39:14.670549 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m18:39:14.670889 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m18:39:14.671414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:14.671606 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m18:39:14.671756 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m18:39:14.671893 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m18:39:14.672337 [debug] [MainThread]: Command end result
[0m18:39:14.713449 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:39:14.715439 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:39:14.720062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:39:14.723656 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:39:14.723838 [info ] [MainThread]: Building catalog
[0m18:39:14.729350 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m18:39:14.733664 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:39:14.733941 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m18:39:14.734125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:14.738890 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:39:14.739243 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m18:39:14.739508 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:39:14.741705 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m18:39:14.743919 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m18:39:14.744230 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m18:39:14.751052 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m18:39:14.817630 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:39:14.818940 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:39:14.819156 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m18:39:14.819894 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.4878246, "process_in_blocks": "0", "process_kernel_time": 0.095804, "process_mem_max_rss": "108656", "process_out_blocks": "5027", "process_user_time": 1.021913}
[0m18:39:14.820227 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:39:14.820172 after 0.49 seconds
[0m18:39:14.820435 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:39:14.820599 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m18:39:14.820784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bf1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd43400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd43490>]}
[0m18:39:14.821045 [debug] [MainThread]: Flushing usage events
[0m18:39:16.601012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:17.515625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0931100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa529a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa52a00>]}


============================== 18:39:17.517974 | 833460a7-f54a-43e5-a41d-9d229e404a42 ==============================
[0m18:39:17.517974 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:39:17.518487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8081', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:39:17.602002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '833460a7-f54a-43e5-a41d-9d229e404a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb00250>]}
[0m18:39:17.630751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '833460a7-f54a-43e5-a41d-9d229e404a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b7a130>]}
[0m03:49:36.474672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80701400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f846820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f846880>]}


============================== 03:49:36.480105 | eca65d01-7b08-4329-a35d-7fd0a7f1c0b9 ==============================
[0m03:49:36.480105 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:49:36.480844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:49:36.598597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eca65d01-7b08-4329-a35d-7fd0a7f1c0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff02940>]}
[0m03:49:36.608127 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:49:36.610934 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:49:36.613959 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1854375, "process_in_blocks": "0", "process_kernel_time": 0.303481, "process_mem_max_rss": "90840", "process_out_blocks": "963", "process_user_time": 1.236106}
[0m03:49:36.614502 [debug] [MainThread]: Command `dbt deps` succeeded at 03:49:36.614400 after 0.19 seconds
[0m03:49:36.614873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80701400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f751cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff02940>]}
[0m03:49:36.615205 [debug] [MainThread]: Flushing usage events
[0m03:49:37.928190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:49:39.033240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879f2100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b125e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b12580>]}


============================== 03:49:39.036109 | a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b ==============================
[0m03:49:39.036109 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:49:39.036849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:49:39.154349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8925c880>]}
[0m03:49:39.195136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872af610>]}
[0m03:49:39.195866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:49:39.250632 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:49:39.329846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:49:39.330218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:49:39.356884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a22130>]}
[0m03:49:39.412649 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m03:49:39.415212 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m03:49:39.427878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a524c0>]}
[0m03:49:39.428329 [info ] [MainThread]: Found 3 models, 433 macros
[0m03:49:39.428841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a11820>]}
[0m03:49:39.430110 [info ] [MainThread]: 
[0m03:49:39.430572 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:49:39.431001 [info ] [MainThread]: 
[0m03:49:39.431538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:49:39.435051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m03:49:39.466044 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m03:49:39.466437 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m03:49:39.466679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:39.473970 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m03:49:39.474964 [debug] [ThreadPool]: On list_analytics: Close
[0m03:49:39.476057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m03:49:39.480820 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m03:49:39.481111 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m03:49:39.481338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:39.487494 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m03:49:39.488067 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m03:49:39.488412 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:49:39.491346 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m03:49:39.492433 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m03:49:39.492801 [debug] [ThreadPool]: On list_analytics_public: Close
[0m03:49:39.496654 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:39.496968 [debug] [MainThread]: On master: BEGIN
[0m03:49:39.497238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:49:39.503331 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m03:49:39.503850 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:39.504312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:49:39.510802 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m03:49:39.512165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e424f0>]}
[0m03:49:39.512717 [debug] [MainThread]: On master: ROLLBACK
[0m03:49:39.513203 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:39.513462 [debug] [MainThread]: On master: BEGIN
[0m03:49:39.513927 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:49:39.514425 [debug] [MainThread]: On master: COMMIT
[0m03:49:39.514773 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:39.515069 [debug] [MainThread]: On master: COMMIT
[0m03:49:39.515392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:49:39.515630 [debug] [MainThread]: On master: Close
[0m03:49:39.521583 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m03:49:39.521927 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m03:49:39.522449 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m03:49:39.523332 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m03:49:39.523982 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m03:49:39.524470 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m03:49:39.524842 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m03:49:39.525164 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m03:49:39.532147 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.533894 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m03:49:39.535594 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m03:49:39.535941 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m03:49:39.567396 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.567720 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m03:49:39.569503 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.570111 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m03:49:39.570406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:49:39.569909 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m03:49:39.571128 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m03:49:39.571829 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:49:39.578443 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m03:49:39.578826 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.579143 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m03:49:39.581900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m03:49:39.582269 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m03:49:39.587485 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m03:49:39.587870 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m03:49:39.587084 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.588325 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m03:49:39.588940 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:49:39.597063 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m03:49:39.600711 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m03:49:39.637611 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.638009 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m03:49:39.637118 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m03:49:39.638653 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m03:49:39.639471 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m03:49:39.639769 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:49:39.644990 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m03:49:39.646176 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m03:49:39.649460 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m03:49:39.649865 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m03:49:39.650625 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m03:49:39.650297 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m03:49:39.651413 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m03:49:39.651665 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m03:49:39.653816 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m03:49:39.655879 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m03:49:39.657973 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m03:49:39.658270 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m03:49:39.657403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89260e20>]}
[0m03:49:39.659097 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m03:49:39.658666 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m03:49:39.659671 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m03:49:39.660909 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m03:49:39.661615 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cd7e50>]}
[0m03:49:39.662252 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m03:49:39.663010 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m03:49:39.663838 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m03:49:39.664455 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m03:49:39.665091 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m03:49:39.665602 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m03:49:39.668431 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m03:49:39.670085 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m03:49:39.688306 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m03:49:39.689790 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m03:49:39.690207 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m03:49:39.690586 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:49:39.697474 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m03:49:39.697883 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m03:49:39.698190 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m03:49:39.706718 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m03:49:39.709741 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m03:49:39.710089 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m03:49:39.710594 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:49:39.714169 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m03:49:39.714492 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m03:49:39.714937 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:49:39.720199 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m03:49:39.720561 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m03:49:39.720906 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m03:49:39.722852 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m03:49:39.724885 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m03:49:39.726720 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m03:49:39.727036 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m03:49:39.728346 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m03:49:39.729350 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m03:49:39.729920 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a32d3ec9-8dbb-41bd-b0c1-27af32eb7e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859905b0>]}
[0m03:49:39.730509 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m03:49:39.731225 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m03:49:39.732543 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:39.732911 [debug] [MainThread]: On master: BEGIN
[0m03:49:39.733163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:49:39.739592 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m03:49:39.740038 [debug] [MainThread]: On master: COMMIT
[0m03:49:39.740488 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:39.740817 [debug] [MainThread]: On master: COMMIT
[0m03:49:39.741396 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:49:39.742063 [debug] [MainThread]: On master: Close
[0m03:49:39.742496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:39.742957 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m03:49:39.743501 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m03:49:39.744077 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m03:49:39.744743 [info ] [MainThread]: 
[0m03:49:39.745450 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m03:49:39.746627 [debug] [MainThread]: Command end result
[0m03:49:39.768199 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m03:49:39.770159 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m03:49:39.775917 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m03:49:39.776348 [info ] [MainThread]: 
[0m03:49:39.777092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:49:39.777536 [info ] [MainThread]: 
[0m03:49:39.778071 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m03:49:39.779064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.78642064, "process_in_blocks": "0", "process_kernel_time": 0.120359, "process_mem_max_rss": "111088", "process_out_blocks": "1793", "process_user_time": 1.511515}
[0m03:49:39.779529 [debug] [MainThread]: Command `dbt run` succeeded at 03:49:39.779427 after 0.79 seconds
[0m03:49:39.779962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879f2100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878f0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877d1a30>]}
[0m03:49:39.780402 [debug] [MainThread]: Flushing usage events
[0m03:49:40.925230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:49:42.096829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00428b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0042910>]}


============================== 03:49:42.099805 | 3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926 ==============================
[0m03:49:42.099805 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:49:42.100522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m03:49:42.221668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00aa0d0>]}
[0m03:49:42.262944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf340280>]}
[0m03:49:42.263619 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:49:42.316786 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m03:49:42.390956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:49:42.391432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:49:42.416181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef33130>]}
[0m03:49:42.426084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef66a90>]}
[0m03:49:42.426539 [info ] [MainThread]: Found 3 models, 433 macros
[0m03:49:42.426934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef669d0>]}
[0m03:49:42.428195 [info ] [MainThread]: 
[0m03:49:42.428632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:49:42.429182 [info ] [MainThread]: 
[0m03:49:42.429717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:49:42.433470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m03:49:42.461107 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m03:49:42.461592 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m03:49:42.461970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:42.468512 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m03:49:42.468967 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m03:49:42.469362 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:49:42.471220 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m03:49:42.472433 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m03:49:42.472870 [debug] [ThreadPool]: On list_analytics_public: Close
[0m03:49:42.477345 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:42.477684 [debug] [MainThread]: On master: BEGIN
[0m03:49:42.477995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:49:42.484236 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m03:49:42.484609 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:42.484977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:49:42.487693 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m03:49:42.489084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c0ec7ad-8ccc-4de6-bfa4-d0131e06b926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeefef70>]}
[0m03:49:42.489490 [debug] [MainThread]: On master: ROLLBACK
[0m03:49:42.489893 [debug] [MainThread]: On master: Close
[0m03:49:42.492338 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m03:49:42.492640 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m03:49:42.493107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m03:49:42.493592 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m03:49:42.493924 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m03:49:42.494272 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m03:49:42.501246 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m03:49:42.503317 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m03:49:42.504502 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m03:49:42.505158 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m03:49:42.505555 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m03:49:42.506315 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m03:49:42.507051 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m03:49:42.507549 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m03:49:42.507830 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m03:49:42.510522 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m03:49:42.511323 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m03:49:42.511861 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m03:49:42.512638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:42.512943 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m03:49:42.513146 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m03:49:42.513331 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m03:49:42.513967 [debug] [MainThread]: Command end result
[0m03:49:42.571728 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m03:49:42.574561 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m03:49:42.580785 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m03:49:42.590739 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m03:49:42.591069 [info ] [MainThread]: Building catalog
[0m03:49:42.599574 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m03:49:42.605783 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m03:49:42.606225 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m03:49:42.606581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:42.613866 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m03:49:42.614359 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m03:49:42.614785 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m03:49:42.617788 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m03:49:42.621214 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m03:49:42.621635 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m03:49:42.632311 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m03:49:42.692884 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m03:49:42.694624 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m03:49:42.695044 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m03:49:42.696217 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.64169145, "process_in_blocks": "0", "process_kernel_time": 0.099159, "process_mem_max_rss": "108560", "process_out_blocks": "5027", "process_user_time": 1.445322}
[0m03:49:42.696715 [debug] [MainThread]: Command `dbt docs generate` succeeded at 03:49:42.696615 after 0.64 seconds
[0m03:49:42.697047 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m03:49:42.697273 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m03:49:42.697536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf053460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae381d00>]}
[0m03:49:42.697864 [debug] [MainThread]: Flushing usage events
[0m03:49:43.776251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:49:44.856823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9f2100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb1a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb1a4f0>]}


============================== 03:49:44.859669 | 3e17e4ef-555f-43c5-ab5a-2516015144ee ==============================
[0m03:49:44.859669 [info ] [MainThread]: Running with dbt=1.9.3
[0m03:49:44.860420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8081', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:49:45.004491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e17e4ef-555f-43c5-ab5a-2516015144ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8ef3a0>]}
[0m03:49:45.046329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e17e4ef-555f-43c5-ab5a-2516015144ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2ae820>]}
[0m09:38:47.252762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94283070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933c9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933c9c10>]}


============================== 09:38:47.258698 | c46b011d-58f3-4d28-8c56-b0f2d00679d1 ==============================
[0m09:38:47.258698 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:47.259491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:47.339689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c46b011d-58f3-4d28-8c56-b0f2d00679d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95afa2b0>]}
[0m09:38:47.349914 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:38:47.352327 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:38:47.353245 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14646083, "process_in_blocks": "0", "process_kernel_time": 0.321722, "process_mem_max_rss": "91004", "process_out_blocks": "963", "process_user_time": 1.372409}
[0m09:38:47.353752 [debug] [MainThread]: Command `dbt deps` succeeded at 09:38:47.353640 after 0.15 seconds
[0m09:38:47.354088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94283070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932d7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95afa2b0>]}
[0m09:38:47.354426 [debug] [MainThread]: Flushing usage events
[0m09:38:50.450550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:51.779452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebecd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc8a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc8a400>]}


============================== 09:38:51.782662 | b14843ec-ae8f-4f88-bab4-f28c124a2aa5 ==============================
[0m09:38:51.782662 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:51.783504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:38:51.910541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803f85e0>]}
[0m09:38:51.956946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dcca4c0>]}
[0m09:38:51.958768 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:52.022032 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:38:52.105680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:38:52.106314 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/python_model/python.sql
[0m09:38:52.106757 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/models/incremental/merge.sql
[0m09:38:52.192964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbc1130>]}
[0m09:38:52.248670 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m09:38:52.251547 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m09:38:52.264961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cba3a00>]}
[0m09:38:52.265506 [info ] [MainThread]: Found 3 models, 433 macros
[0m09:38:52.265946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cefc940>]}
[0m09:38:52.267389 [info ] [MainThread]: 
[0m09:38:52.267757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:38:52.268189 [info ] [MainThread]: 
[0m09:38:52.268776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:52.272336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m09:38:52.310094 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m09:38:52.310631 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m09:38:52.310908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:52.319883 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m09:38:52.321224 [debug] [ThreadPool]: On list_analytics: Close
[0m09:38:52.323007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m09:38:52.328287 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m09:38:52.328693 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m09:38:52.328996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:52.335919 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:38:52.336406 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m09:38:52.336708 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:38:52.339217 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m09:38:52.340271 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m09:38:52.340715 [debug] [ThreadPool]: On list_analytics_public: Close
[0m09:38:52.344873 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:52.345212 [debug] [MainThread]: On master: BEGIN
[0m09:38:52.345511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:52.352665 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:38:52.352997 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:52.353375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:52.356905 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m09:38:52.357939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77ed2790>]}
[0m09:38:52.358483 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:52.358909 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:52.359201 [debug] [MainThread]: On master: BEGIN
[0m09:38:52.359703 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:38:52.360114 [debug] [MainThread]: On master: COMMIT
[0m09:38:52.360491 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:52.360775 [debug] [MainThread]: On master: COMMIT
[0m09:38:52.361183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:52.361484 [debug] [MainThread]: On master: Close
[0m09:38:52.368877 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m09:38:52.369236 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m09:38:52.369830 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m09:38:52.370620 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m09:38:52.372004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m09:38:52.373002 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m09:38:52.373695 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m09:38:52.374074 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m09:38:52.380294 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.382249 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m09:38:52.384466 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m09:38:52.384989 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m09:38:52.458433 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.461026 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m09:38:52.464246 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.465610 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m09:38:52.466013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:38:52.465345 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m09:38:52.466852 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m09:38:52.467471 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:38:52.476514 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m09:38:52.477170 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.477678 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m09:38:52.477998 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m09:38:52.478554 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m09:38:52.479000 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m09:38:52.480289 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:38:52.480535 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:38:52.485783 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.488840 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m09:38:52.488488 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m09:38:52.489292 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m09:38:52.489511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:52.499529 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:38:52.503780 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m09:38:52.504222 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m09:38:52.504583 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m09:38:52.502637 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m09:38:52.505149 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.505543 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m09:38:52.505770 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m09:38:52.512362 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m09:38:52.512660 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m09:38:52.516226 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m09:38:52.518811 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m09:38:52.518456 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m09:38:52.519778 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m09:38:52.520101 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m09:38:52.519356 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m09:38:52.522487 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m09:38:52.520643 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m09:38:52.525012 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m09:38:52.525468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb0dfa0>]}
[0m09:38:52.523948 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77f3a400>]}
[0m09:38:52.526700 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:38:52.526048 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:38:52.527919 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m09:38:52.527425 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m09:38:52.528681 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m09:38:52.529267 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m09:38:52.529803 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m09:38:52.530258 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m09:38:52.533208 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m09:38:52.534868 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m09:38:52.552772 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m09:38:52.554121 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m09:38:52.554526 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m09:38:52.554970 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:38:52.561324 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m09:38:52.561735 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m09:38:52.562040 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m09:38:52.573282 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.011 seconds
[0m09:38:52.576404 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m09:38:52.576884 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m09:38:52.577631 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:38:52.581864 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m09:38:52.582259 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m09:38:52.582605 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m09:38:52.583658 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m09:38:52.585841 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m09:38:52.587660 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m09:38:52.587986 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m09:38:52.588412 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.000 seconds
[0m09:38:52.589487 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m09:38:52.590306 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b14843ec-ae8f-4f88-bab4-f28c124a2aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb0dfa0>]}
[0m09:38:52.591163 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m09:38:52.591817 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m09:38:52.593155 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:52.593620 [debug] [MainThread]: On master: BEGIN
[0m09:38:52.593926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:52.605830 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:38:52.606670 [debug] [MainThread]: On master: COMMIT
[0m09:38:52.607057 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:52.607398 [debug] [MainThread]: On master: COMMIT
[0m09:38:52.607841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:52.608562 [debug] [MainThread]: On master: Close
[0m09:38:52.609859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:52.610815 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m09:38:52.611296 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m09:38:52.611631 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m09:38:52.612189 [info ] [MainThread]: 
[0m09:38:52.612679 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m09:38:52.614081 [debug] [MainThread]: Command end result
[0m09:38:52.643037 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m09:38:52.645082 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m09:38:52.652958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m09:38:52.653424 [info ] [MainThread]: 
[0m09:38:52.653948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:52.654587 [info ] [MainThread]: 
[0m09:38:52.655151 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:38:52.656548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92092454, "process_in_blocks": "0", "process_kernel_time": 0.134133, "process_mem_max_rss": "111332", "process_out_blocks": "2620", "process_user_time": 1.717512}
[0m09:38:52.657073 [debug] [MainThread]: Command `dbt run` succeeded at 09:38:52.656949 after 0.92 seconds
[0m09:38:52.657509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebecd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77e6b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cba3a30>]}
[0m09:38:52.657905 [debug] [MainThread]: Flushing usage events
[0m09:38:53.528629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:54.762886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b57bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a64e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a64e400>]}


============================== 09:38:54.765947 | a9dd0ad9-2ec9-4879-9ae0-30076dd376f9 ==============================
[0m09:38:54.765947 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:54.766771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:54.896750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9dd0ad9-2ec9-4879-9ae0-30076dd376f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999afe20>]}
[0m09:38:54.940009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9dd0ad9-2ec9-4879-9ae0-30076dd376f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aae7b20>]}
[0m09:38:54.940913 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:55.007356 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:38:55.087118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:38:55.087592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:38:55.112087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9dd0ad9-2ec9-4879-9ae0-30076dd376f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9953fe20>]}
[0m09:38:55.121349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9dd0ad9-2ec9-4879-9ae0-30076dd376f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9959d5b0>]}
[0m09:38:55.121827 [info ] [MainThread]: Found 3 models, 433 macros
[0m09:38:55.122327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dd0ad9-2ec9-4879-9ae0-30076dd376f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9959d5e0>]}
[0m09:38:55.123834 [info ] [MainThread]: 
[0m09:38:55.124199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:38:55.124552 [info ] [MainThread]: 
[0m09:38:55.125046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:55.128814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m09:38:55.159711 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m09:38:55.160196 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m09:38:55.160578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:55.168787 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:38:55.169276 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m09:38:55.169635 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:38:55.172082 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m09:38:55.173209 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m09:38:55.173628 [debug] [ThreadPool]: On list_analytics_public: Close
[0m09:38:55.178460 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:55.178834 [debug] [MainThread]: On master: BEGIN
[0m09:38:55.179120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:55.186492 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:38:55.186909 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:55.187369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:55.190441 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m09:38:55.192006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dd0ad9-2ec9-4879-9ae0-30076dd376f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9999f8b0>]}
[0m09:38:55.192477 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:55.192955 [debug] [MainThread]: On master: Close
[0m09:38:55.195578 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m09:38:55.195925 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m09:38:55.196440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m09:38:55.197026 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m09:38:55.197501 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m09:38:55.197945 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m09:38:55.204860 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m09:38:55.206914 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m09:38:55.208343 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m09:38:55.209045 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m09:38:55.209436 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m09:38:55.210191 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m09:38:55.210943 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m09:38:55.211508 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m09:38:55.211807 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m09:38:55.214427 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m09:38:55.215304 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m09:38:55.215830 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m09:38:55.216567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:55.216836 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m09:38:55.217169 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m09:38:55.217379 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m09:38:55.217993 [debug] [MainThread]: Command end result
[0m09:38:55.282905 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m09:38:55.285868 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m09:38:55.292022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m09:38:55.300210 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m09:38:55.300557 [info ] [MainThread]: Building catalog
[0m09:38:55.307983 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m09:38:55.314183 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m09:38:55.314589 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m09:38:55.314905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:55.322823 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:38:55.323543 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m09:38:55.324008 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m09:38:55.327753 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m09:38:55.330881 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m09:38:55.331397 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m09:38:55.341358 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m09:38:55.401673 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m09:38:55.403467 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m09:38:55.403826 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m09:38:55.404784 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6850841, "process_in_blocks": "0", "process_kernel_time": 0.117575, "process_mem_max_rss": "108752", "process_out_blocks": "5029", "process_user_time": 1.519515}
[0m09:38:55.405213 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:38:55.405113 after 0.69 seconds
[0m09:38:55.405520 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:38:55.405741 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m09:38:55.406019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b57bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9963c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988d0be0>]}
[0m09:38:55.406332 [debug] [MainThread]: Flushing usage events
[0m09:38:56.273815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:57.523473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934bbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92581ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92581d00>]}


============================== 09:38:57.526551 | 65afcef2-c5dd-401c-8b01-af8ce94d52c9 ==============================
[0m09:38:57.526551 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:38:57.527296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 9090', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:57.650871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65afcef2-c5dd-401c-8b01-af8ce94d52c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cc8400>]}
[0m09:38:57.694087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65afcef2-c5dd-401c-8b01-af8ce94d52c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927592e0>]}
[0m10:38:42.881741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb01400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac46850>]}


============================== 10:38:42.888494 | aab90091-9931-4820-a493-14642ec327a9 ==============================
[0m10:38:42.888494 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:38:42.889151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:42.970405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab90091-9931-4820-a493-14642ec327a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0e29a0>]}
[0m10:38:42.978570 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:38:42.981505 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:38:42.982353 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14563096, "process_in_blocks": "0", "process_kernel_time": 0.120937, "process_mem_max_rss": "91012", "process_out_blocks": "963", "process_user_time": 1.171076}
[0m10:38:42.982847 [debug] [MainThread]: Command `dbt deps` succeeded at 10:38:42.982753 after 0.15 seconds
[0m10:38:42.983151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb01400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab55cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0e29a0>]}
[0m10:38:42.983439 [debug] [MainThread]: Flushing usage events
[0m10:38:47.842803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:48.951813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c571130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b682640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6825e0>]}


============================== 10:38:48.954639 | f264b327-5e1f-4f11-a4e1-8d3dbb8f181d ==============================
[0m10:38:48.954639 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:38:48.955270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:49.067413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddec940>]}
[0m10:38:49.110047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3a3df0>]}
[0m10:38:49.110786 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:49.167110 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:38:49.251736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:38:49.252440 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/models/incremental/merge.sql
[0m10:38:49.252823 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/python_model/python.sql
[0m10:38:49.333579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5b7130>]}
[0m10:38:49.389325 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:38:49.392228 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:38:49.404428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5cb7c0>]}
[0m10:38:49.404847 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:38:49.405172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5b4280>]}
[0m10:38:49.406354 [info ] [MainThread]: 
[0m10:38:49.406744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:49.407064 [info ] [MainThread]: 
[0m10:38:49.407550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:49.410993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:38:49.440863 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:38:49.441294 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:38:49.441687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:49.449727 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m10:38:49.450771 [debug] [ThreadPool]: On list_analytics: Close
[0m10:38:49.451972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m10:38:49.456839 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:38:49.457171 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:38:49.457462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:49.463794 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:38:49.464297 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:38:49.464649 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:38:49.467348 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m10:38:49.468446 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:38:49.468865 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:38:49.472870 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:49.473214 [debug] [MainThread]: On master: BEGIN
[0m10:38:49.473525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:49.479952 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:38:49.480304 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:49.480659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:49.483496 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:38:49.484442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a7ac5e0>]}
[0m10:38:49.484833 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:49.485233 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:49.485537 [debug] [MainThread]: On master: BEGIN
[0m10:38:49.486082 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:38:49.486503 [debug] [MainThread]: On master: COMMIT
[0m10:38:49.486818 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:49.487083 [debug] [MainThread]: On master: COMMIT
[0m10:38:49.487455 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:49.487733 [debug] [MainThread]: On master: Close
[0m10:38:49.494580 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:38:49.494910 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:38:49.495429 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m10:38:49.496002 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m10:38:49.496492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:38:49.496875 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_analytics, now model.my_dbt_project.stg_districts)
[0m10:38:49.497183 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:38:49.497521 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:38:49.503498 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.505594 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:38:49.507794 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:38:49.508176 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:38:49.586020 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m10:38:49.587459 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.589584 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.590163 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:38:49.590801 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m10:38:49.591128 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:38:49.590417 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m10:38:49.591944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:38:49.601984 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m10:38:49.602517 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:38:49.602982 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m10:38:49.603577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m10:38:49.604126 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.604587 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m10:38:49.604923 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:38:49.610789 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:38:49.611090 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:38:49.611561 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m10:38:49.614366 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.614929 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m10:38:49.615180 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:38:49.627036 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:38:49.627774 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:38:49.628199 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:38:49.627365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:38:49.629768 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:38:49.630254 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.630519 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:38:49.630002 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m10:38:49.636440 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m10:38:49.636697 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:38:49.640260 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:38:49.643060 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m10:38:49.642687 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m10:38:49.644150 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:38:49.644527 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m10:38:49.643622 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:38:49.647053 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m10:38:49.644967 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:38:49.649708 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m10:38:49.650216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8f4610>]}
[0m10:38:49.650913 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:38:49.648635 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79945400>]}
[0m10:38:49.652169 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:38:49.652791 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:38:49.651617 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:38:49.653869 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:38:49.654425 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m10:38:49.654980 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:38:49.655406 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:38:49.658483 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:38:49.660303 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:38:49.678798 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m10:38:49.680077 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:38:49.680452 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m10:38:49.680767 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:38:49.687555 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m10:38:49.688013 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:38:49.688350 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m10:38:49.696064 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.007 seconds
[0m10:38:49.698965 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:38:49.699270 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m10:38:49.699844 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:38:49.702599 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:38:49.703067 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m10:38:49.703713 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:38:49.709303 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:38:49.709668 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:38:49.709988 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:38:49.711290 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m10:38:49.714633 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m10:38:49.716614 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:38:49.717021 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m10:38:49.718738 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m10:38:49.719743 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m10:38:49.720247 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f264b327-5e1f-4f11-a4e1-8d3dbb8f181d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ff73d0>]}
[0m10:38:49.720832 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m10:38:49.721408 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:38:49.722464 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:49.722790 [debug] [MainThread]: On master: BEGIN
[0m10:38:49.723019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:49.729599 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:38:49.730108 [debug] [MainThread]: On master: COMMIT
[0m10:38:49.730546 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:49.730942 [debug] [MainThread]: On master: COMMIT
[0m10:38:49.731457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:49.731935 [debug] [MainThread]: On master: Close
[0m10:38:49.732383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:49.732759 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:38:49.733130 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:38:49.733518 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:38:49.733987 [info ] [MainThread]: 
[0m10:38:49.734427 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m10:38:49.735387 [debug] [MainThread]: Command end result
[0m10:38:49.761212 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:38:49.762915 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:38:49.769060 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:38:49.769347 [info ] [MainThread]: 
[0m10:38:49.769804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:49.770319 [info ] [MainThread]: 
[0m10:38:49.770747 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:38:49.771565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86024606, "process_in_blocks": "0", "process_kernel_time": 0.123857, "process_mem_max_rss": "111292", "process_out_blocks": "2616", "process_user_time": 1.584171}
[0m10:38:49.771890 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:49.771828 after 0.86 seconds
[0m10:38:49.772183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c571130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3bb160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddec940>]}
[0m10:38:49.772510 [debug] [MainThread]: Flushing usage events
[0m10:38:50.657283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:51.873808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a931100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a52850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a528b0>]}


============================== 10:38:51.877029 | 397bd501-04e5-4a13-ac22-e46e4f9294d4 ==============================
[0m10:38:51.877029 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:38:51.877805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:51.992328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397bd501-04e5-4a13-ac22-e46e4f9294d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a82f3a0>]}
[0m10:38:52.033940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397bd501-04e5-4a13-ac22-e46e4f9294d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d7ca60>]}
[0m10:38:52.034699 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:52.088133 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:38:52.163106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:38:52.163571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:38:52.188204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397bd501-04e5-4a13-ac22-e46e4f9294d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98967130>]}
[0m10:38:52.197913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397bd501-04e5-4a13-ac22-e46e4f9294d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98996af0>]}
[0m10:38:52.198345 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:38:52.198875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397bd501-04e5-4a13-ac22-e46e4f9294d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98996a30>]}
[0m10:38:52.200378 [info ] [MainThread]: 
[0m10:38:52.200847 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:52.201224 [info ] [MainThread]: 
[0m10:38:52.201741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:52.205377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m10:38:52.234010 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:38:52.234602 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:38:52.234930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:52.242618 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:38:52.243094 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:38:52.243458 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:38:52.245562 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:38:52.246719 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:38:52.247168 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:38:52.251728 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:52.252056 [debug] [MainThread]: On master: BEGIN
[0m10:38:52.252378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:52.259638 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:38:52.260073 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:52.260486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:52.264648 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m10:38:52.265957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397bd501-04e5-4a13-ac22-e46e4f9294d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98996d00>]}
[0m10:38:52.266341 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:52.266738 [debug] [MainThread]: On master: Close
[0m10:38:52.269176 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:38:52.269490 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:38:52.269986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:38:52.270528 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:38:52.270932 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:38:52.271326 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:38:52.278137 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:38:52.279915 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:38:52.281216 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:38:52.281935 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:38:52.282427 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:38:52.283181 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:38:52.283982 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:38:52.284513 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:38:52.284817 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:38:52.287466 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:38:52.288251 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:38:52.288762 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:38:52.289651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:52.289928 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:38:52.290219 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:38:52.290557 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:38:52.291170 [debug] [MainThread]: Command end result
[0m10:38:52.351511 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:38:52.354958 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:38:52.361451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:38:52.370032 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:38:52.370329 [info ] [MainThread]: Building catalog
[0m10:38:52.377965 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m10:38:52.384297 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:38:52.384668 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m10:38:52.384958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:52.391924 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:38:52.392430 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:38:52.392835 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:38:52.395631 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m10:38:52.399005 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m10:38:52.399450 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m10:38:52.409481 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m10:38:52.468727 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:38:52.470599 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:38:52.470925 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m10:38:52.471974 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6401722, "process_in_blocks": "0", "process_kernel_time": 0.097986, "process_mem_max_rss": "108680", "process_out_blocks": "5027", "process_user_time": 1.4338}
[0m10:38:52.472505 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:38:52.472407 after 0.64 seconds
[0m10:38:52.472845 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:38:52.473065 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m10:38:52.473333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a931100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a79400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a79490>]}
[0m10:38:52.473670 [debug] [MainThread]: Flushing usage events
[0m10:38:53.568211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:54.768011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927711c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918829a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91882a00>]}


============================== 10:38:54.770956 | 588a7a01-66a1-4b0a-8cd2-b93890afa529 ==============================
[0m10:38:54.770956 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:38:54.771686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8081', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:54.892484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '588a7a01-66a1-4b0a-8cd2-b93890afa529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c5ccd0>]}
[0m10:38:54.936061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '588a7a01-66a1-4b0a-8cd2-b93890afa529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bf3eb0>]}
[0m10:51:11.592947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bff1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1148e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b114940>]}


============================== 10:51:11.600443 | eaea5e3e-d5a1-4b8d-ae4f-a16d37699a0d ==============================
[0m10:51:11.600443 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:51:11.601162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:11.688306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaea5e3e-d5a1-4b8d-ae4f-a16d37699a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b319790>]}
[0m10:51:11.696186 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:11.698932 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:11.699866 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15072858, "process_in_blocks": "0", "process_kernel_time": 0.121087, "process_mem_max_rss": "90844", "process_out_blocks": "963", "process_user_time": 1.127816}
[0m10:51:11.700343 [debug] [MainThread]: Command `dbt deps` succeeded at 10:51:11.700243 after 0.15 seconds
[0m10:51:11.700702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bff1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b020cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b319790>]}
[0m10:51:11.700995 [debug] [MainThread]: Flushing usage events
[0m10:51:16.766697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:17.955868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93db1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ec2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ec25e0>]}


============================== 10:51:17.958868 | 30c90079-e8ff-4643-9b93-36c9c8955214 ==============================
[0m10:51:17.958868 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:51:17.959583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:18.082319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9562b940>]}
[0m10:51:18.125668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bd6df0>]}
[0m10:51:18.126827 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:51:18.185747 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:51:18.272823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:18.273332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:18.300154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91de5130>]}
[0m10:51:18.364554 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:51:18.367923 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:51:18.381365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e144f0>]}
[0m10:51:18.381795 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:51:18.382225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91df57c0>]}
[0m10:51:18.383697 [info ] [MainThread]: 
[0m10:51:18.384149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:18.384546 [info ] [MainThread]: 
[0m10:51:18.385113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:18.388890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:51:18.418380 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:51:18.418873 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:51:18.419206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:18.427000 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m10:51:18.428108 [debug] [ThreadPool]: On list_analytics: Close
[0m10:51:18.429426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m10:51:18.434750 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:51:18.435128 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:51:18.435446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:18.441492 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:51:18.441920 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:51:18.442328 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:51:18.444717 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m10:51:18.445840 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:51:18.446298 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:51:18.450333 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.450702 [debug] [MainThread]: On master: BEGIN
[0m10:51:18.450980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:18.457761 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:51:18.458302 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.458790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:18.461528 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:51:18.462683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92223e50>]}
[0m10:51:18.463149 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:18.463588 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.463879 [debug] [MainThread]: On master: BEGIN
[0m10:51:18.464351 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:51:18.464710 [debug] [MainThread]: On master: COMMIT
[0m10:51:18.464991 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.465258 [debug] [MainThread]: On master: COMMIT
[0m10:51:18.465630 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:18.465909 [debug] [MainThread]: On master: Close
[0m10:51:18.471820 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:51:18.472142 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:51:18.472665 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m10:51:18.473310 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m10:51:18.473922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:51:18.474354 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:51:18.474813 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:51:18.475185 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:51:18.482087 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.484106 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:51:18.487045 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:51:18.487466 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:51:18.520893 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m10:51:18.521502 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.523490 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:51:18.524390 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m10:51:18.524826 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:51:18.524034 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.525916 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m10:51:18.526374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:51:18.532355 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m10:51:18.532786 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:51:18.533110 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m10:51:18.534529 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:51:18.540325 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:51:18.541060 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m10:51:18.540648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m10:51:18.541747 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.542355 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m10:51:18.542030 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:51:18.550118 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:51:18.555515 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:51:18.593549 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:51:18.594005 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:51:18.558843 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.594599 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m10:51:18.595158 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m10:51:18.595475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:51:18.601916 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:51:18.602262 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.600713 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m10:51:18.602769 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:51:18.606423 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:51:18.607006 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m10:51:18.607496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:51:18.609811 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m10:51:18.610325 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:51:18.610615 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m10:51:18.607728 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:51:18.611109 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:51:18.613073 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m10:51:18.614044 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m10:51:18.616238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91082f70>]}
[0m10:51:18.616910 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:51:18.615640 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95630e50>]}
[0m10:51:18.618324 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:51:18.617722 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:51:18.618950 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:51:18.620112 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:51:18.620728 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m10:51:18.621439 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:51:18.621838 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:51:18.624729 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:51:18.626242 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:51:18.643563 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m10:51:18.644800 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:51:18.645229 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m10:51:18.645740 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:51:18.652760 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m10:51:18.653280 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:51:18.653765 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m10:51:18.661518 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.007 seconds
[0m10:51:18.664582 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:51:18.664934 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m10:51:18.665509 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:51:18.669129 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:51:18.669463 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m10:51:18.669909 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:51:18.675231 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:51:18.675597 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:51:18.675931 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:51:18.677123 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m10:51:18.679220 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m10:51:18.681055 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:51:18.681352 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m10:51:18.682695 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m10:51:18.683704 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m10:51:18.684232 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c90079-e8ff-4643-9b93-36c9c8955214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9116f670>]}
[0m10:51:18.684786 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m10:51:18.685381 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:51:18.686476 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.686838 [debug] [MainThread]: On master: BEGIN
[0m10:51:18.687131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:18.693096 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:51:18.693435 [debug] [MainThread]: On master: COMMIT
[0m10:51:18.693713 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.693967 [debug] [MainThread]: On master: COMMIT
[0m10:51:18.694263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:18.694603 [debug] [MainThread]: On master: Close
[0m10:51:18.695079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:18.695374 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:51:18.695888 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:51:18.696609 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:51:18.697299 [info ] [MainThread]: 
[0m10:51:18.698113 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:51:18.699771 [debug] [MainThread]: Command end result
[0m10:51:18.730417 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:51:18.732328 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:51:18.738678 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:51:18.739086 [info ] [MainThread]: 
[0m10:51:18.739546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:18.740074 [info ] [MainThread]: 
[0m10:51:18.740501 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:51:18.741500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.82787865, "process_in_blocks": "0", "process_kernel_time": 0.10318, "process_mem_max_rss": "110840", "process_out_blocks": "1794", "process_user_time": 1.63285}
[0m10:51:18.741951 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:18.741869 after 0.83 seconds
[0m10:51:18.742343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93db1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c40310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9562b940>]}
[0m10:51:18.742793 [debug] [MainThread]: Flushing usage events
[0m10:51:19.861575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:21.047466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5971130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a82820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a82880>]}


============================== 10:51:21.050360 | 50902bd5-8dc2-4914-b979-2687f1a415da ==============================
[0m10:51:21.050360 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:51:21.051082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:21.167710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50902bd5-8dc2-4914-b979-2687f1a415da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4aea940>]}
[0m10:51:21.210505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50902bd5-8dc2-4914-b979-2687f1a415da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa577ea90>]}
[0m10:51:21.211348 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:51:21.265600 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:51:21.343967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:21.344431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:21.369177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50902bd5-8dc2-4914-b979-2687f1a415da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39b7130>]}
[0m10:51:21.378711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50902bd5-8dc2-4914-b979-2687f1a415da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39e5b20>]}
[0m10:51:21.379276 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:51:21.379825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50902bd5-8dc2-4914-b979-2687f1a415da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39e5a60>]}
[0m10:51:21.381041 [info ] [MainThread]: 
[0m10:51:21.381458 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:21.381756 [info ] [MainThread]: 
[0m10:51:21.382232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:21.385800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m10:51:21.415720 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:51:21.416309 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:51:21.416836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:21.424411 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:51:21.424841 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:51:21.425190 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:51:21.427745 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:51:21.429073 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:51:21.429624 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:51:21.434251 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:21.434652 [debug] [MainThread]: On master: BEGIN
[0m10:51:21.434978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:21.441166 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:51:21.441597 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:21.442046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:21.444957 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:51:21.446500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50902bd5-8dc2-4914-b979-2687f1a415da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39e5d60>]}
[0m10:51:21.446888 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:21.447294 [debug] [MainThread]: On master: Close
[0m10:51:21.449697 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:51:21.450069 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:51:21.450583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:51:21.451096 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:51:21.451556 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:51:21.451917 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:51:21.458970 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:51:21.460960 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:51:21.462515 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:51:21.462816 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:51:21.463592 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:51:21.464335 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:51:21.465270 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:51:21.465887 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:51:21.466256 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:51:21.469126 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:51:21.470117 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:51:21.470724 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:51:21.471640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:21.472016 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:51:21.472322 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:51:21.472602 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:51:21.473318 [debug] [MainThread]: Command end result
[0m10:51:21.533249 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:51:21.536137 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:51:21.542433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:51:21.546710 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:51:21.546975 [info ] [MainThread]: Building catalog
[0m10:51:21.554253 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m10:51:21.560188 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:51:21.560618 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m10:51:21.561047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:21.567702 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:51:21.568125 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:51:21.568502 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:51:21.571546 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m10:51:21.574674 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m10:51:21.575118 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m10:51:21.585244 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m10:51:21.646036 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:51:21.647990 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:51:21.648320 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m10:51:21.649419 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6432339, "process_in_blocks": "0", "process_kernel_time": 0.086841, "process_mem_max_rss": "108680", "process_out_blocks": "5027", "process_user_time": 1.446352}
[0m10:51:21.649958 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:51:21.649859 after 0.64 seconds
[0m10:51:21.650382 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:51:21.650709 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m10:51:21.651071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5971130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3aca430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e02670>]}
[0m10:51:21.651449 [debug] [MainThread]: Flushing usage events
[0m10:51:22.732072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:07.382265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1b0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2c6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2c68b0>]}


============================== 10:53:07.388475 | 34abe600-0d49-4f21-8fad-f7bc75bebcff ==============================
[0m10:53:07.388475 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:53:07.389097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m10:53:07.470346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34abe600-0d49-4f21-8fad-f7bc75bebcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a311c0>]}
[0m10:53:07.479358 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:07.481400 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:53:07.482257 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14745054, "process_in_blocks": "0", "process_kernel_time": 0.123075, "process_mem_max_rss": "90880", "process_out_blocks": "963", "process_user_time": 1.147702}
[0m10:53:07.482699 [debug] [MainThread]: Command `dbt deps` succeeded at 10:53:07.482599 after 0.15 seconds
[0m10:53:07.483057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1b0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1d5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a311c0>]}
[0m10:53:07.483460 [debug] [MainThread]: Flushing usage events
[0m10:53:12.495763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:13.667594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf171130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae282640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2825e0>]}


============================== 10:53:13.670782 | 7ae4c867-8c5f-4fc4-841f-3d3c0656a64f ==============================
[0m10:53:13.670782 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:53:13.671403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:13.792209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09eb940>]}
[0m10:53:13.837139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefa1df0>]}
[0m10:53:13.838131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:53:13.895540 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:53:13.976631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:13.977165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:14.003691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1b5130>]}
[0m10:53:14.061675 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:53:14.064789 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:53:14.078288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1e54f0>]}
[0m10:53:14.078803 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:53:14.079134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1c57c0>]}
[0m10:53:14.080612 [info ] [MainThread]: 
[0m10:53:14.080951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:14.081425 [info ] [MainThread]: 
[0m10:53:14.082005 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:14.085618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:53:14.114950 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:53:14.115545 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:53:14.116020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:14.124324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m10:53:14.125539 [debug] [ThreadPool]: On list_analytics: Close
[0m10:53:14.126999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m10:53:14.132717 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:53:14.133120 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:53:14.133457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:14.139666 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:53:14.140102 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:53:14.140442 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:53:14.143037 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m10:53:14.144224 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:53:14.144649 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:53:14.149282 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:14.149679 [debug] [MainThread]: On master: BEGIN
[0m10:53:14.149939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:14.156127 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:53:14.156481 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:14.156913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:14.159947 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:53:14.161212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5f2e50>]}
[0m10:53:14.161744 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:14.162207 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:14.162511 [debug] [MainThread]: On master: BEGIN
[0m10:53:14.163265 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:53:14.163603 [debug] [MainThread]: On master: COMMIT
[0m10:53:14.163924 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:14.164210 [debug] [MainThread]: On master: COMMIT
[0m10:53:14.164606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:53:14.164914 [debug] [MainThread]: On master: Close
[0m10:53:14.171068 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:53:14.171470 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:53:14.172271 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m10:53:14.173047 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m10:53:14.173621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:53:14.174189 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:53:14.174630 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:53:14.175046 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:53:14.182608 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.184469 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:53:14.186560 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:53:14.193902 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:53:14.225578 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m10:53:14.226741 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.228373 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:53:14.229032 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m10:53:14.229335 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:53:14.228808 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.230061 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m10:53:14.230694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:53:14.240143 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m10:53:14.240607 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:53:14.241051 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m10:53:14.241401 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m10:53:14.241851 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.242225 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m10:53:14.242817 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:53:14.248198 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:53:14.248788 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m10:53:14.248492 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:53:14.252161 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.252723 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m10:53:14.252418 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:53:14.294297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.041 seconds
[0m10:53:14.302869 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:53:14.305200 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:53:14.305748 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:53:14.304420 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:53:14.306577 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.307505 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:53:14.308058 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m10:53:14.314022 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m10:53:14.314289 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:53:14.317544 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:53:14.319830 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m10:53:14.319501 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m10:53:14.320536 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:53:14.321023 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m10:53:14.320770 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m10:53:14.321479 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:53:14.324619 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m10:53:14.323511 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m10:53:14.326792 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09f0e50>]}
[0m10:53:14.326278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac451eb0>]}
[0m10:53:14.328171 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:53:14.328819 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:53:14.327434 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:53:14.329548 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:53:14.330291 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:53:14.330795 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m10:53:14.331402 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:53:14.331866 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:53:14.334723 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:53:14.336782 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:53:14.354882 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m10:53:14.356035 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:53:14.356371 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m10:53:14.356739 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:53:14.363682 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m10:53:14.364083 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:53:14.364430 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m10:53:14.372260 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.007 seconds
[0m10:53:14.374948 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:53:14.375309 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m10:53:14.375908 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:53:14.379571 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:53:14.379995 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m10:53:14.380648 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:53:14.386214 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:53:14.386629 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:53:14.386970 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:53:14.388114 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m10:53:14.390149 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m10:53:14.391951 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:53:14.392313 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m10:53:14.393658 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m10:53:14.394941 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m10:53:14.395550 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae4c867-8c5f-4fc4-841f-3d3c0656a64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad165c10>]}
[0m10:53:14.396151 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.06s]
[0m10:53:14.396804 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:53:14.397942 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:14.398257 [debug] [MainThread]: On master: BEGIN
[0m10:53:14.398508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:14.404761 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:53:14.405214 [debug] [MainThread]: On master: COMMIT
[0m10:53:14.405563 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:14.405998 [debug] [MainThread]: On master: COMMIT
[0m10:53:14.406414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:53:14.406743 [debug] [MainThread]: On master: Close
[0m10:53:14.407240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:14.407692 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:53:14.408103 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:53:14.408487 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:53:14.408911 [info ] [MainThread]: 
[0m10:53:14.409396 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m10:53:14.412035 [debug] [MainThread]: Command end result
[0m10:53:14.437800 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:53:14.439759 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:53:14.446079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:53:14.446431 [info ] [MainThread]: 
[0m10:53:14.446897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:53:14.447348 [info ] [MainThread]: 
[0m10:53:14.447799 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:53:14.448673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.82251215, "process_in_blocks": "0", "process_kernel_time": 0.108922, "process_mem_max_rss": "111220", "process_out_blocks": "1794", "process_user_time": 1.59687}
[0m10:53:14.449033 [debug] [MainThread]: Command `dbt run` succeeded at 10:53:14.448970 after 0.82 seconds
[0m10:53:14.449458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf171130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefbb160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1e54c0>]}
[0m10:53:14.449928 [debug] [MainThread]: Flushing usage events
[0m10:53:15.547969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:16.714831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6841100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5982850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59828b0>]}


============================== 10:53:16.717994 | c5ca3f04-b999-4953-b645-95535fe2476d ==============================
[0m10:53:16.717994 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:53:16.718639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:16.839093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5ca3f04-b999-4953-b645-95535fe2476d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb673f3a0>]}
[0m10:53:16.880370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5ca3f04-b999-4953-b645-95535fe2476d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4cbda60>]}
[0m10:53:16.881205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:53:16.934771 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:53:17.010790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:17.011256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:17.035771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5ca3f04-b999-4953-b645-95535fe2476d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4876130>]}
[0m10:53:17.044641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5ca3f04-b999-4953-b645-95535fe2476d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48a6af0>]}
[0m10:53:17.045078 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:53:17.045560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5ca3f04-b999-4953-b645-95535fe2476d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48a6a30>]}
[0m10:53:17.046784 [info ] [MainThread]: 
[0m10:53:17.047133 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:17.047543 [info ] [MainThread]: 
[0m10:53:17.048145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:17.051784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m10:53:17.079885 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:53:17.080388 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:53:17.080818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:17.087430 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:53:17.087905 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:53:17.088276 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:53:17.090274 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:53:17.091486 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:53:17.091930 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:53:17.096541 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:17.096887 [debug] [MainThread]: On master: BEGIN
[0m10:53:17.097180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:17.103369 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:53:17.103769 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:17.104125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:17.106785 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m10:53:17.108069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5ca3f04-b999-4953-b645-95535fe2476d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48a6d00>]}
[0m10:53:17.108601 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:17.109002 [debug] [MainThread]: On master: Close
[0m10:53:17.111483 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:53:17.111826 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:53:17.112357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:53:17.112903 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:53:17.113329 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:53:17.113756 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:53:17.121314 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:53:17.123374 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:53:17.124904 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:53:17.125955 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:53:17.125354 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:53:17.126856 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:53:17.127649 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:53:17.128142 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:53:17.128494 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:53:17.131225 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:53:17.132080 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:53:17.132688 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:53:17.133596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:17.133999 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:53:17.134308 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:53:17.134568 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:53:17.135267 [debug] [MainThread]: Command end result
[0m10:53:17.191258 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:53:17.194153 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:53:17.200653 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:53:17.206118 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:53:17.206403 [info ] [MainThread]: Building catalog
[0m10:53:17.214176 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m10:53:17.220361 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:53:17.220773 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m10:53:17.221091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:17.227600 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:53:17.227979 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:53:17.228324 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:53:17.230917 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m10:53:17.234060 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m10:53:17.234501 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m10:53:17.246931 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m10:53:17.307599 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:53:17.309592 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:53:17.309966 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m10:53:17.310979 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6374283, "process_in_blocks": "0", "process_kernel_time": 0.090117, "process_mem_max_rss": "108544", "process_out_blocks": "5027", "process_user_time": 1.428859}
[0m10:53:17.311540 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:53:17.311419 after 0.64 seconds
[0m10:53:17.311941 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:53:17.312246 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m10:53:17.312600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6841100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb498a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb498a490>]}
[0m10:53:17.312941 [debug] [MainThread]: Flushing usage events
[0m10:53:18.344559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:19.505433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6811c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7c29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7c2a00>]}


============================== 10:53:19.508744 | 7f8e4d1a-31c1-49c3-aed5-ceafa51f3e0e ==============================
[0m10:53:19.508744 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:53:19.509469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:19.639589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f8e4d1a-31c1-49c3-aed5-ceafa51f3e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb5ccd0>]}
[0m10:53:19.684195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f8e4d1a-31c1-49c3-aed5-ceafa51f3e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7caf0eb0>]}
[0m10:54:19.902219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb71400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac867f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac86850>]}


============================== 10:54:19.909261 | 052cb8b0-6498-41aa-867b-ca3fb670368c ==============================
[0m10:54:19.909261 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:54:19.909989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:19.994445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '052cb8b0-6498-41aa-867b-ca3fb670368c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1519a0>]}
[0m10:54:20.003713 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:54:20.005584 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:54:20.006480 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14794871, "process_in_blocks": "0", "process_kernel_time": 0.11055, "process_mem_max_rss": "90892", "process_out_blocks": "963", "process_user_time": 1.166362}
[0m10:54:20.006842 [debug] [MainThread]: Command `dbt deps` succeeded at 10:54:20.006770 after 0.15 seconds
[0m10:54:20.007125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb71400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab95cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1519a0>]}
[0m10:54:20.007415 [debug] [MainThread]: Flushing usage events
[0m10:54:21.054275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:22.176321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96c36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96c3640>]}


============================== 10:54:22.179596 | 6b51864f-6712-471e-beaf-c91058e6ba67 ==============================
[0m10:54:22.179596 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:54:22.180360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:22.334538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b893d0>]}
[0m10:54:22.376309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9de8d30>]}
[0m10:54:22.377072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:54:22.433042 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:54:22.510642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:54:22.511191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:54:22.536519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85e5130>]}
[0m10:54:22.593887 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:54:22.596363 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:54:22.609731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb860c550>]}
[0m10:54:22.610215 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:54:22.610680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85f6670>]}
[0m10:54:22.612213 [info ] [MainThread]: 
[0m10:54:22.612601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:22.612937 [info ] [MainThread]: 
[0m10:54:22.613456 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:22.617208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m10:54:22.646322 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m10:54:22.646833 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m10:54:22.647212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:22.654864 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m10:54:22.656024 [debug] [ThreadPool]: On list_analytics: Close
[0m10:54:22.657190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m10:54:22.662328 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:54:22.662686 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:54:22.662953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:22.669244 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:54:22.669702 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:54:22.670068 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:54:22.672388 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m10:54:22.673506 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:54:22.673918 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:54:22.678252 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:22.678699 [debug] [MainThread]: On master: BEGIN
[0m10:54:22.679049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:22.685554 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:54:22.685920 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:22.686257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:22.689002 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:54:22.690148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a06040>]}
[0m10:54:22.690602 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:22.690949 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:22.691169 [debug] [MainThread]: On master: BEGIN
[0m10:54:22.691625 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:54:22.692006 [debug] [MainThread]: On master: COMMIT
[0m10:54:22.692258 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:22.692486 [debug] [MainThread]: On master: COMMIT
[0m10:54:22.692852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:54:22.693152 [debug] [MainThread]: On master: Close
[0m10:54:22.697614 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:54:22.697873 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:54:22.698363 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m10:54:22.698939 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m10:54:22.699464 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:54:22.699917 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:54:22.700275 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:54:22.700622 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:54:22.707834 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.709814 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:54:22.711982 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:54:22.712310 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:54:22.747622 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.748759 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m10:54:22.750425 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.751018 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m10:54:22.751332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:54:22.750815 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:54:22.752005 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m10:54:22.752523 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:54:22.760679 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m10:54:22.761123 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.761648 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m10:54:22.763604 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m10:54:22.764561 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:54:22.764997 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m10:54:22.764193 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:54:22.772150 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.773108 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
alter table "analytics"."public"."stg_crime_reports__dbt_tmp" rename to "stg_crime_reports"
[0m10:54:22.772769 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:54:22.777390 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:54:22.778042 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
alter table "analytics"."public"."stg_districts__dbt_tmp" rename to "stg_districts"
[0m10:54:22.777699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:54:22.819796 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.041 seconds
[0m10:54:22.828543 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:54:22.829045 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:54:22.829465 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: COMMIT
[0m10:54:22.826915 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:54:22.830103 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.830550 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: COMMIT
[0m10:54:22.830770 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m10:54:22.836339 [debug] [Thread-2  ]: Applying DROP to: "analytics"."public"."stg_districts__dbt_backup"
[0m10:54:22.836646 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m10:54:22.840425 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m10:54:22.843338 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */
drop view if exists "analytics"."public"."stg_districts__dbt_backup" cascade
[0m10:54:22.842899 [debug] [Thread-1  ]: Applying DROP to: "analytics"."public"."stg_crime_reports__dbt_backup"
[0m10:54:22.844484 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m10:54:22.844866 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */
drop view if exists "analytics"."public"."stg_crime_reports__dbt_backup" cascade
[0m10:54:22.844012 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:54:22.845644 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m10:54:22.847768 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m10:54:22.850555 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbe30e80>]}
[0m10:54:22.851252 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.stg_districts .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:54:22.852039 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:54:22.848997 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m10:54:22.852991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7886130>]}
[0m10:54:22.853644 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public.stg_crime_reports ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:54:22.854352 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:54:22.855294 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:54:22.856087 [info ] [Thread-4  ]: 3 of 3 START sql table model public.transformed_data ........................... [RUN]
[0m10:54:22.856904 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:54:22.857528 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:54:22.860531 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:54:22.862392 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:54:22.881855 [debug] [Thread-4  ]: Writing runtime sql for node "model.my_dbt_project.transformed_data"
[0m10:54:22.883384 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:54:22.883851 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: BEGIN
[0m10:54:22.884179 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:54:22.890915 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m10:54:22.891468 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:54:22.891881 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */

  
    

  create  table "analytics"."public"."transformed_data__dbt_tmp"
  
  
    as
  
  (
    select scr.district_id,
    sd.district_name,
    scr.crime_type,
    scr.nearest_police_patrol,
    sd.population,
    sd.governor,
    scr.day_of_week,
    scr.date,
    scr.time
FROM "analytics"."public"."stg_crime_reports" AS scr
    LEFT JOIN "analytics"."public"."stg_districts" AS sd ON scr.district_id = sd.district_id
  );
  
[0m10:54:22.900499 [debug] [Thread-4  ]: SQL status: SELECT 2403 in 0.008 seconds
[0m10:54:22.903437 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:54:22.904017 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data" rename to "transformed_data__dbt_backup"
[0m10:54:22.904704 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:22.908443 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:54:22.908898 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
alter table "analytics"."public"."transformed_data__dbt_tmp" rename to "transformed_data"
[0m10:54:22.909662 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:22.915675 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:54:22.916172 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:54:22.916615 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: COMMIT
[0m10:54:22.918107 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m10:54:22.920698 [debug] [Thread-4  ]: Applying DROP to: "analytics"."public"."transformed_data__dbt_backup"
[0m10:54:22.922779 [debug] [Thread-4  ]: Using postgres connection "model.my_dbt_project.transformed_data"
[0m10:54:22.923134 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transformed_data"} */
drop table if exists "analytics"."public"."transformed_data__dbt_backup" cascade
[0m10:54:22.924542 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m10:54:22.925717 [debug] [Thread-4  ]: On model.my_dbt_project.transformed_data: Close
[0m10:54:22.926327 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b51864f-6712-471e-beaf-c91058e6ba67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8593940>]}
[0m10:54:22.927039 [info ] [Thread-4  ]: 3 of 3 OK created sql table model public.transformed_data ...................... [[32mSELECT 2403[0m in 0.07s]
[0m10:54:22.927842 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:54:22.929253 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:22.929666 [debug] [MainThread]: On master: BEGIN
[0m10:54:22.930002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:22.936365 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:54:22.936883 [debug] [MainThread]: On master: COMMIT
[0m10:54:22.937161 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:22.937409 [debug] [MainThread]: On master: COMMIT
[0m10:54:22.937897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:54:22.938264 [debug] [MainThread]: On master: Close
[0m10:54:22.938710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:22.939431 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:54:22.939798 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:54:22.940290 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:54:22.940752 [info ] [MainThread]: 
[0m10:54:22.941149 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m10:54:22.942331 [debug] [MainThread]: Command end result
[0m10:54:22.968258 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:54:22.970043 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:54:22.976122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:54:22.976421 [info ] [MainThread]: 
[0m10:54:22.976854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:54:22.977340 [info ] [MainThread]: 
[0m10:54:22.977836 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:54:22.978711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84527564, "process_in_blocks": "0", "process_kernel_time": 0.11155, "process_mem_max_rss": "110852", "process_out_blocks": "1794", "process_user_time": 1.572762}
[0m10:54:22.979159 [debug] [MainThread]: Command `dbt run` succeeded at 10:54:22.979079 after 0.85 seconds
[0m10:54:22.979696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9de8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb860c550>]}
[0m10:54:22.980105 [debug] [MainThread]: Flushing usage events
[0m10:54:24.069692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:25.210895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94101100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93242850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932428b0>]}


============================== 10:54:25.214066 | 4b73501c-a006-418c-ba7e-eb2f36096a0f ==============================
[0m10:54:25.214066 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:54:25.214791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:54:25.337428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b73501c-a006-418c-ba7e-eb2f36096a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fff3a0>]}
[0m10:54:25.378539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b73501c-a006-418c-ba7e-eb2f36096a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9257ca60>]}
[0m10:54:25.379239 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:54:25.436034 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:54:25.511088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:54:25.511482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:54:25.535740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b73501c-a006-418c-ba7e-eb2f36096a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92135130>]}
[0m10:54:25.544850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b73501c-a006-418c-ba7e-eb2f36096a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92165af0>]}
[0m10:54:25.545281 [info ] [MainThread]: Found 3 models, 433 macros
[0m10:54:25.545794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b73501c-a006-418c-ba7e-eb2f36096a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92165a30>]}
[0m10:54:25.547270 [info ] [MainThread]: 
[0m10:54:25.547690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:25.547991 [info ] [MainThread]: 
[0m10:54:25.548523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:25.552013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m10:54:25.579717 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:54:25.580169 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m10:54:25.580504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:25.587388 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:54:25.587799 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m10:54:25.588116 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:54:25.590285 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:54:25.591393 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m10:54:25.591812 [debug] [ThreadPool]: On list_analytics_public: Close
[0m10:54:25.596477 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:25.596860 [debug] [MainThread]: On master: BEGIN
[0m10:54:25.597175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:25.603563 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:54:25.604010 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:25.604346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:25.607168 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m10:54:25.608653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b73501c-a006-418c-ba7e-eb2f36096a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92165d00>]}
[0m10:54:25.609053 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:25.609445 [debug] [MainThread]: On master: Close
[0m10:54:25.611831 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m10:54:25.612110 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m10:54:25.612572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m10:54:25.613091 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m10:54:25.613506 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m10:54:25.613887 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m10:54:25.620791 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m10:54:25.622934 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m10:54:25.625315 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m10:54:25.626110 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m10:54:25.626477 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m10:54:25.627194 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m10:54:25.627972 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m10:54:25.628591 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.my_dbt_project.transformed_data'
[0m10:54:25.629084 [debug] [Thread-4  ]: Began compiling node model.my_dbt_project.transformed_data
[0m10:54:25.631833 [debug] [Thread-4  ]: Writing injected SQL for node "model.my_dbt_project.transformed_data"
[0m10:54:25.632706 [debug] [Thread-4  ]: Began executing node model.my_dbt_project.transformed_data
[0m10:54:25.633308 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m10:54:25.634177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:25.634466 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m10:54:25.634793 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m10:54:25.635011 [debug] [MainThread]: Connection 'model.my_dbt_project.transformed_data' was properly closed.
[0m10:54:25.635649 [debug] [MainThread]: Command end result
[0m10:54:25.693098 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:54:25.695747 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:54:25.701993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:54:25.706794 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:54:25.707085 [info ] [MainThread]: Building catalog
[0m10:54:25.714363 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m10:54:25.720605 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:54:25.721027 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m10:54:25.721325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:25.727980 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:54:25.728454 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m10:54:25.728848 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_districts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_crime_reports')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:54:25.731452 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m10:54:25.734759 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m10:54:25.735162 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m10:54:25.744930 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m10:54:25.802934 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:54:25.804946 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:54:25.805349 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m10:54:25.806576 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6381634, "process_in_blocks": "0", "process_kernel_time": 0.102414, "process_mem_max_rss": "108680", "process_out_blocks": "5027", "process_user_time": 1.41272}
[0m10:54:25.807056 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:54:25.806970 after 0.64 seconds
[0m10:54:25.807440 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:54:25.807711 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m10:54:25.808003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94101100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9224a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9224a490>]}
[0m10:54:25.808394 [debug] [MainThread]: Flushing usage events
[0m10:54:26.916265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:28.103620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe82160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efc2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efc29a0>]}


============================== 10:54:28.106678 | 9c1d60cc-3445-4630-93d0-18b48bb8a52e ==============================
[0m10:54:28.106678 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:54:28.107243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8081', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:28.221469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c1d60cc-3445-4630-93d0-18b48bb8a52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1994c0>]}
[0m10:54:28.263025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c1d60cc-3445-4630-93d0-18b48bb8a52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f006dc0>]}
[0m11:41:51.118649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9284c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919a2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919a28e0>]}


============================== 11:41:51.136017 | 67c0d8bc-060c-4bde-a517-de347953bc7c ==============================
[0m11:41:51.136017 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:41:51.136708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:51.223770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67c0d8bc-060c-4bde-a517-de347953bc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940cda90>]}
[0m11:41:51.234047 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:41:51.235291 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:41:51.237761 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17244983, "process_in_blocks": "0", "process_kernel_time": 0.624821, "process_mem_max_rss": "91648", "process_out_blocks": "1027", "process_user_time": 1.34654}
[0m11:41:51.238280 [debug] [MainThread]: Command `dbt deps` succeeded at 11:41:51.238168 after 0.17 seconds
[0m11:41:51.238730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9284c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918b78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940cda90>]}
[0m11:41:51.239075 [debug] [MainThread]: Flushing usage events
[0m11:41:56.377857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:57.926202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec01dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd30550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd304f0>]}


============================== 11:41:57.929826 | 5007c773-331e-4fe1-95df-572914f19444 ==============================
[0m11:41:57.929826 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:41:57.930551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:41:58.061194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd8e8e0>]}
[0m11:41:58.108689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf30910>]}
[0m11:41:58.109968 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:41:58.182026 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:41:58.241391 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:41:58.241885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea16d60>]}
[0m11:41:59.137640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac917130>]}
[0m11:41:59.223672 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:41:59.237413 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:41:59.260576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac8e1fa0>]}
[0m11:41:59.261221 [info ] [MainThread]: Found 3 models, 1 seed, 433 macros
[0m11:41:59.261789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9614c0>]}
[0m11:41:59.263482 [info ] [MainThread]: 
[0m11:41:59.263992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:41:59.264422 [info ] [MainThread]: 
[0m11:41:59.265004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:41:59.268755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m11:41:59.321333 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m11:41:59.322142 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:41:59.322578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:59.346224 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m11:41:59.347710 [debug] [ThreadPool]: On list_analytics: Close
[0m11:41:59.349751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m11:41:59.355613 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:41:59.356089 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m11:41:59.356444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:59.363167 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:41:59.363644 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:41:59.363984 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:41:59.370475 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m11:41:59.372382 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m11:41:59.373041 [debug] [ThreadPool]: On list_analytics_public: Close
[0m11:41:59.381315 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:59.382658 [debug] [MainThread]: On master: BEGIN
[0m11:41:59.383277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:59.392021 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:41:59.392897 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:59.393528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:41:59.397086 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:41:59.398201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9411c0>]}
[0m11:41:59.398703 [debug] [MainThread]: On master: ROLLBACK
[0m11:41:59.399085 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:59.399358 [debug] [MainThread]: On master: BEGIN
[0m11:41:59.400059 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:41:59.400487 [debug] [MainThread]: On master: COMMIT
[0m11:41:59.401152 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:59.401796 [debug] [MainThread]: On master: COMMIT
[0m11:41:59.402387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:41:59.402722 [debug] [MainThread]: On master: Close
[0m11:41:59.409590 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m11:41:59.410026 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m11:41:59.410618 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m11:41:59.411457 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m11:41:59.412074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m11:41:59.412602 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m11:41:59.413046 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m11:41:59.413518 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m11:41:59.420887 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m11:41:59.422761 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m11:41:59.424704 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m11:41:59.435035 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m11:41:59.461260 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m11:41:59.462535 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m11:41:59.464532 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m11:41:59.465336 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m11:41:59.465658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:59.465072 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m11:41:59.466398 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m11:41:59.467073 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:41:59.471089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m11:41:59.471434 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m11:41:59.471809 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m11:41:59.472077 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m11:41:59.472592 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m11:41:59.473387 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m11:41:59.473012 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.raw_crime_reports" does not exist
LINE 27: FROM public.raw_crime_reports
              ^

[0m11:41:59.474297 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: ROLLBACK
[0m11:41:59.474061 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "public.raw_districts" does not exist
LINE 18: FROM public.raw_districts
              ^

[0m11:41:59.475038 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: ROLLBACK
[0m11:41:59.474801 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m11:41:59.475622 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m11:41:59.480407 [debug] [Thread-2  ]: Database Error in model stg_districts (models/staging/stg_districts.sql)
  relation "public.raw_districts" does not exist
  LINE 18: FROM public.raw_districts
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql
[0m11:41:59.479633 [debug] [Thread-1  ]: Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  relation "public.raw_crime_reports" does not exist
  LINE 27: FROM public.raw_crime_reports
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql
[0m11:41:59.482846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fda790>]}
[0m11:41:59.483513 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model public.stg_crime_reports .................. [[31mERROR[0m in 0.07s]
[0m11:41:59.484107 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m11:41:59.482403 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5007c773-331e-4fe1-95df-572914f19444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeaec0d0>]}
[0m11:41:59.484591 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.stg_crime_reports' to be skipped because of status 'error'.  Reason: Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  relation "public.raw_crime_reports" does not exist
  LINE 27: FROM public.raw_crime_reports
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql.
[0m11:41:59.485148 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model public.stg_districts ...................... [[31mERROR[0m in 0.07s]
[0m11:41:59.485912 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m11:41:59.486343 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.stg_districts' to be skipped because of status 'error'.  Reason: Database Error in model stg_districts (models/staging/stg_districts.sql)
  relation "public.raw_districts" does not exist
  LINE 18: FROM public.raw_districts
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql.
[0m11:41:59.487099 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m11:41:59.487542 [info ] [Thread-4  ]: 3 of 3 SKIP relation public.transformed_data ................................... [[33mSKIP[0m]
[0m11:41:59.487988 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m11:41:59.489153 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:59.489487 [debug] [MainThread]: On master: BEGIN
[0m11:41:59.489719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:59.493586 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:41:59.493959 [debug] [MainThread]: On master: COMMIT
[0m11:41:59.494338 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:59.494634 [debug] [MainThread]: On master: COMMIT
[0m11:41:59.494973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:41:59.495220 [debug] [MainThread]: On master: Close
[0m11:41:59.495555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:59.495808 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m11:41:59.496093 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m11:41:59.496547 [info ] [MainThread]: 
[0m11:41:59.496923 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:41:59.497813 [debug] [MainThread]: Command end result
[0m11:41:59.523627 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:41:59.525686 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:41:59.532431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:41:59.532794 [info ] [MainThread]: 
[0m11:41:59.533294 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:41:59.533794 [info ] [MainThread]: 
[0m11:41:59.534256 [error] [MainThread]:   Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  relation "public.raw_crime_reports" does not exist
  LINE 27: FROM public.raw_crime_reports
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql
[0m11:41:59.534582 [info ] [MainThread]: 
[0m11:41:59.535112 [error] [MainThread]:   Database Error in model stg_districts (models/staging/stg_districts.sql)
  relation "public.raw_districts" does not exist
  LINE 18: FROM public.raw_districts
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql
[0m11:41:59.535550 [info ] [MainThread]: 
[0m11:41:59.535960 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m11:41:59.536998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6567268, "process_in_blocks": "0", "process_kernel_time": 0.264192, "process_mem_max_rss": "118020", "process_out_blocks": "2618", "process_user_time": 2.433562}
[0m11:41:59.537459 [debug] [MainThread]: Command `dbt run` failed at 11:41:59.537363 after 1.66 seconds
[0m11:41:59.537872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec01dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7cde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac8e1fa0>]}
[0m11:41:59.538228 [debug] [MainThread]: Flushing usage events
[0m11:42:00.430007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:38.320842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c15c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2a3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2a3880>]}


============================== 11:43:38.328079 | d4f509ec-15b3-4e3f-8a7e-d71115679261 ==============================
[0m11:43:38.328079 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:43:38.328858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:38.417716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4f509ec-15b3-4e3f-8a7e-d71115679261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2ff790>]}
[0m11:43:38.427322 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:43:38.429211 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:43:38.430189 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15157983, "process_in_blocks": "0", "process_kernel_time": 0.220635, "process_mem_max_rss": "91228", "process_out_blocks": "1027", "process_user_time": 1.231714}
[0m11:43:38.430705 [debug] [MainThread]: Command `dbt deps` succeeded at 11:43:38.430591 after 0.15 seconds
[0m11:43:38.431091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c15c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1aecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2ff790>]}
[0m11:43:38.431394 [debug] [MainThread]: Flushing usage events
[0m11:43:43.378207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:44.541814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82091dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811e05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811e0550>]}


============================== 11:43:44.544560 | 07c91e53-fa80-4198-9639-b13b4820f1e5 ==============================
[0m11:43:44.544560 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:43:44.545106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:44.685710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806d37c0>]}
[0m11:43:44.727508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806e5460>]}
[0m11:43:44.728281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:43:44.791455 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:43:44.895967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:44.896458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:44.930896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8027af70>]}
[0m11:43:44.996234 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:43:44.999547 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:43:45.013938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8020a730>]}
[0m11:43:45.014390 [info ] [MainThread]: Found 3 models, 1 seed, 433 macros
[0m11:43:45.014820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80216a00>]}
[0m11:43:45.016272 [info ] [MainThread]: 
[0m11:43:45.016698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:43:45.017063 [info ] [MainThread]: 
[0m11:43:45.017657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:45.021369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m11:43:45.063095 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m11:43:45.063562 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:43:45.063883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:45.082231 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m11:43:45.083412 [debug] [ThreadPool]: On list_analytics: Close
[0m11:43:45.084842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m11:43:45.090034 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:43:45.090473 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m11:43:45.090780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:45.094810 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:43:45.095197 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:43:45.095510 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:43:45.098178 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m11:43:45.099177 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m11:43:45.099554 [debug] [ThreadPool]: On list_analytics_public: Close
[0m11:43:45.103589 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:45.103888 [debug] [MainThread]: On master: BEGIN
[0m11:43:45.104106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:45.109129 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:43:45.109597 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:45.110038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:45.113705 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:43:45.114991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802123d0>]}
[0m11:43:45.115415 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:45.115796 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:45.116144 [debug] [MainThread]: On master: BEGIN
[0m11:43:45.117124 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:43:45.117644 [debug] [MainThread]: On master: COMMIT
[0m11:43:45.118139 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:45.118544 [debug] [MainThread]: On master: COMMIT
[0m11:43:45.119047 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:43:45.119415 [debug] [MainThread]: On master: Close
[0m11:43:45.125194 [debug] [Thread-1  ]: Began running node model.my_dbt_project.stg_crime_reports
[0m11:43:45.125515 [debug] [Thread-2  ]: Began running node model.my_dbt_project.stg_districts
[0m11:43:45.126024 [info ] [Thread-1  ]: 1 of 3 START sql view model public.stg_crime_reports ........................... [RUN]
[0m11:43:45.126682 [info ] [Thread-2  ]: 2 of 3 START sql view model public.stg_districts ............................... [RUN]
[0m11:43:45.127302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now model.my_dbt_project.stg_crime_reports)
[0m11:43:45.127824 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.my_dbt_project.stg_districts'
[0m11:43:45.128247 [debug] [Thread-1  ]: Began compiling node model.my_dbt_project.stg_crime_reports
[0m11:43:45.128687 [debug] [Thread-2  ]: Began compiling node model.my_dbt_project.stg_districts
[0m11:43:45.135383 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_dbt_project.stg_crime_reports"
[0m11:43:45.137994 [debug] [Thread-2  ]: Writing injected SQL for node "model.my_dbt_project.stg_districts"
[0m11:43:45.140984 [debug] [Thread-1  ]: Began executing node model.my_dbt_project.stg_crime_reports
[0m11:43:45.150973 [debug] [Thread-2  ]: Began executing node model.my_dbt_project.stg_districts
[0m11:43:45.178617 [debug] [Thread-2  ]: Writing runtime sql for node "model.my_dbt_project.stg_districts"
[0m11:43:45.177131 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_dbt_project.stg_crime_reports"
[0m11:43:45.180309 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m11:43:45.180946 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: BEGIN
[0m11:43:45.181246 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:43:45.180735 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m11:43:45.181911 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: BEGIN
[0m11:43:45.182636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:45.187765 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m11:43:45.188275 [debug] [Thread-2  ]: Using postgres connection "model.my_dbt_project.stg_districts"
[0m11:43:45.188876 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_districts"} */

  create view "analytics"."public"."stg_districts__dbt_tmp"
    
    
  as (
    SELECT district_id,
    CASE
        WHEN district_name LIKE '%District District' THEN REPLACE(district_name, 'District District', 'District')
        ELSE district_name
    END,
    population,
    CASE
        WHEN governor LIKE '% District' THEN REPLACE(governor, ' District', '')
        WHEN governor = 'AlRoumi' THEN 'Al Roumi'
        ELSE governor
    END
FROM public.raw_districts
  );
[0m11:43:45.188551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m11:43:45.189357 [debug] [Thread-1  ]: Using postgres connection "model.my_dbt_project.stg_crime_reports"
[0m11:43:45.190246 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "node_id": "model.my_dbt_project.stg_crime_reports"} */

  create view "analytics"."public"."stg_crime_reports__dbt_tmp"
    
    
  as (
    SELECT id,
    district_id,
    timestamp,
    CASE
        WHEN lower(crime_type) = 'assult' THEN 'assault'
        WHEN lower(crime_type) = 'frued' THEN 'fraud'
        ELSE lower(crime_type)
    END crime_type,
    CASE
        WHEN nearest_police_patrol LIKE '% miles' THEN REPLACE(nearest_police_patrol, ' miles', '')::FLOAT * 1.60934
        ELSE REPLACE(nearest_police_patrol, ' km', '')::FLOAT
    END AS nearest_police_patrol,
    EXTRACT(
        DOW
        FROM timestamp
    ) AS day_of_week,
    -- Day of the week (0=Sunday, 6=Saturday)
    DATE(timestamp) AS date,
    -- Extracts the date part
    TO_CHAR(timestamp, 'HH24:MI:SS') AS time
FROM public.raw_crime_reports
WHERE (
        crime_type IS NOT NULL
        AND crime_type != ''
    )
  );
[0m11:43:45.189695 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "public.raw_districts" does not exist
LINE 18: FROM public.raw_districts
              ^

[0m11:43:45.191052 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: ROLLBACK
[0m11:43:45.191539 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.raw_crime_reports" does not exist
LINE 27: FROM public.raw_crime_reports
              ^

[0m11:43:45.192464 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: ROLLBACK
[0m11:43:45.192765 [debug] [Thread-2  ]: On model.my_dbt_project.stg_districts: Close
[0m11:43:45.193284 [debug] [Thread-1  ]: On model.my_dbt_project.stg_crime_reports: Close
[0m11:43:45.197327 [debug] [Thread-1  ]: Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  relation "public.raw_crime_reports" does not exist
  LINE 27: FROM public.raw_crime_reports
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql
[0m11:43:45.195997 [debug] [Thread-2  ]: Database Error in model stg_districts (models/staging/stg_districts.sql)
  relation "public.raw_districts" does not exist
  LINE 18: FROM public.raw_districts
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql
[0m11:43:45.200615 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4bfc40>]}
[0m11:43:45.201617 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model public.stg_districts ...................... [[31mERROR[0m in 0.07s]
[0m11:43:45.202402 [debug] [Thread-2  ]: Finished running node model.my_dbt_project.stg_districts
[0m11:43:45.199711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07c91e53-fa80-4198-9639-b13b4820f1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4e9ac0>]}
[0m11:43:45.203138 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.stg_districts' to be skipped because of status 'error'.  Reason: Database Error in model stg_districts (models/staging/stg_districts.sql)
  relation "public.raw_districts" does not exist
  LINE 18: FROM public.raw_districts
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql.
[0m11:43:45.203685 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model public.stg_crime_reports .................. [[31mERROR[0m in 0.07s]
[0m11:43:45.204654 [debug] [Thread-1  ]: Finished running node model.my_dbt_project.stg_crime_reports
[0m11:43:45.205138 [debug] [Thread-7  ]: Marking all children of 'model.my_dbt_project.stg_crime_reports' to be skipped because of status 'error'.  Reason: Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  relation "public.raw_crime_reports" does not exist
  LINE 27: FROM public.raw_crime_reports
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql.
[0m11:43:45.206170 [debug] [Thread-4  ]: Began running node model.my_dbt_project.transformed_data
[0m11:43:45.206758 [info ] [Thread-4  ]: 3 of 3 SKIP relation public.transformed_data ................................... [[33mSKIP[0m]
[0m11:43:45.207355 [debug] [Thread-4  ]: Finished running node model.my_dbt_project.transformed_data
[0m11:43:45.208471 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:45.208790 [debug] [MainThread]: On master: BEGIN
[0m11:43:45.209024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:45.213491 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:43:45.213997 [debug] [MainThread]: On master: COMMIT
[0m11:43:45.214289 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:45.214685 [debug] [MainThread]: On master: COMMIT
[0m11:43:45.215120 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:43:45.215461 [debug] [MainThread]: On master: Close
[0m11:43:45.215889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:45.216254 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_crime_reports' was properly closed.
[0m11:43:45.216702 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_districts' was properly closed.
[0m11:43:45.217138 [info ] [MainThread]: 
[0m11:43:45.217511 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:43:45.218313 [debug] [MainThread]: Command end result
[0m11:43:45.282594 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:43:45.284535 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:43:45.290390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:43:45.290699 [info ] [MainThread]: 
[0m11:43:45.291142 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:43:45.291664 [info ] [MainThread]: 
[0m11:43:45.292152 [error] [MainThread]:   Database Error in model stg_districts (models/staging/stg_districts.sql)
  relation "public.raw_districts" does not exist
  LINE 18: FROM public.raw_districts
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_districts.sql
[0m11:43:45.292648 [info ] [MainThread]: 
[0m11:43:45.293371 [error] [MainThread]:   Database Error in model stg_crime_reports (models/staging/stg_crime_reports.sql)
  relation "public.raw_crime_reports" does not exist
  LINE 27: FROM public.raw_crime_reports
                ^
  compiled code at target/run/my_dbt_project/models/staging/stg_crime_reports.sql
[0m11:43:45.293985 [info ] [MainThread]: 
[0m11:43:45.294447 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m11:43:45.295662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7958853, "process_in_blocks": "0", "process_kernel_time": 0.154487, "process_mem_max_rss": "112120", "process_out_blocks": "1791", "process_user_time": 1.534841}
[0m11:43:45.296160 [debug] [MainThread]: Command `dbt run` failed at 11:43:45.296052 after 0.80 seconds
[0m11:43:45.296566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82091dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f21e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8020aa30>]}
[0m11:43:45.297021 [debug] [MainThread]: Flushing usage events
[0m11:43:46.153870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:25.744341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f711e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e866490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e866430>]}


============================== 11:44:25.748430 | 63d79f95-2759-4592-aab9-808d9f575796 ==============================
[0m11:44:25.748430 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:44:25.749141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:44:25.834324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63d79f95-2759-4592-aab9-808d9f575796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8669d0>]}
[0m11:44:25.842610 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:44:25.844460 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:44:25.845406 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14679079, "process_in_blocks": "0", "process_kernel_time": 0.192198, "process_mem_max_rss": "91436", "process_out_blocks": "3", "process_user_time": 1.068102}
[0m11:44:25.845912 [debug] [MainThread]: Command `dbt deps` succeeded at 11:44:25.845792 after 0.15 seconds
[0m11:44:25.846347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f711e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e767cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8669d0>]}
[0m11:44:25.846696 [debug] [MainThread]: Flushing usage events
[0m11:44:26.779935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:28.041646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dc1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0edc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0edc550>]}


============================== 11:44:28.044556 | fe31ac6b-113d-4fc1-b5f1-e1cfb576bf22 ==============================
[0m11:44:28.044556 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:44:28.045296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:28.170838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe31ac6b-113d-4fc1-b5f1-e1cfb576bf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03acd90>]}
[0m11:44:28.214078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe31ac6b-113d-4fc1-b5f1-e1cfb576bf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f0d1f0>]}
[0m11:44:28.215163 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:44:28.274721 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:44:28.365597 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m11:44:28.366085 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/staging/stg_districts.sql
[0m11:44:28.366340 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/mart/transformed_data.sql
[0m11:44:28.366564 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/staging/stg_crime_reports.sql
[0m11:44:28.406607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_dbt_project.mart
- models.my_dbt_project.staging
[0m11:44:28.411193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe31ac6b-113d-4fc1-b5f1-e1cfb576bf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff3d130>]}
[0m11:44:28.467345 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:44:28.470548 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:44:28.480577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe31ac6b-113d-4fc1-b5f1-e1cfb576bf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff715b0>]}
[0m11:44:28.481083 [info ] [MainThread]: Found 1 seed, 433 macros
[0m11:44:28.481504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe31ac6b-113d-4fc1-b5f1-e1cfb576bf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffe8640>]}
[0m11:44:28.482718 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:44:28.484526 [debug] [MainThread]: Command end result
[0m11:44:28.506096 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:44:28.507641 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:44:28.510956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:44:28.511746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5183908, "process_in_blocks": "0", "process_kernel_time": 0.119258, "process_mem_max_rss": "102384", "process_out_blocks": "2438", "process_user_time": 1.397031}
[0m11:44:28.512130 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:28.512041 after 0.52 seconds
[0m11:44:28.512475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dc1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa298e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff71730>]}
[0m11:44:28.512777 [debug] [MainThread]: Flushing usage events
[0m11:44:29.537450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:30.854704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9240d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa839e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa839e730>]}


============================== 11:44:30.858045 | d2499af0-dcea-4095-86ae-0f4f7dfb40a6 ==============================
[0m11:44:30.858045 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:44:30.858863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:44:30.976495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2499af0-dcea-4095-86ae-0f4f7dfb40a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad071f0>]}
[0m11:44:31.017256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2499af0-dcea-4095-86ae-0f4f7dfb40a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a49b50>]}
[0m11:44:31.017959 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:44:31.074496 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:44:31.152473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:31.152951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:31.158189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_dbt_project.mart
- models.my_dbt_project.staging
[0m11:44:31.176086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2499af0-dcea-4095-86ae-0f4f7dfb40a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7415130>]}
[0m11:44:31.185848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2499af0-dcea-4095-86ae-0f4f7dfb40a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73c7df0>]}
[0m11:44:31.186358 [info ] [MainThread]: Found 1 seed, 433 macros
[0m11:44:31.186825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2499af0-dcea-4095-86ae-0f4f7dfb40a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73c7ca0>]}
[0m11:44:31.188117 [info ] [MainThread]: 
[0m11:44:31.188589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:44:31.189006 [info ] [MainThread]: 
[0m11:44:31.189558 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:44:31.190363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m11:44:31.231015 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:44:31.231474 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m11:44:31.231716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:31.250356 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m11:44:31.250901 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:44:31.251385 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:44:31.263823 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m11:44:31.265094 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m11:44:31.265665 [debug] [ThreadPool]: On list_analytics_public: Close
[0m11:44:31.269859 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:31.270329 [debug] [MainThread]: On master: BEGIN
[0m11:44:31.270652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:31.276950 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:44:31.277326 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:31.277621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:44:31.280324 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:44:31.281509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2499af0-dcea-4095-86ae-0f4f7dfb40a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73dafd0>]}
[0m11:44:31.282012 [debug] [MainThread]: On master: ROLLBACK
[0m11:44:31.282452 [debug] [MainThread]: On master: Close
[0m11:44:31.285445 [debug] [Thread-1  ]: Began running node seed.my_dbt_project.lms_engagement_data
[0m11:44:31.286014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.my_dbt_project.lms_engagement_data)
[0m11:44:31.286396 [debug] [Thread-1  ]: Began compiling node seed.my_dbt_project.lms_engagement_data
[0m11:44:31.293368 [debug] [Thread-1  ]: Began executing node seed.my_dbt_project.lms_engagement_data
[0m11:44:31.294185 [debug] [Thread-1  ]: Finished running node seed.my_dbt_project.lms_engagement_data
[0m11:44:31.295217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:31.295544 [debug] [MainThread]: Connection 'seed.my_dbt_project.lms_engagement_data' was properly closed.
[0m11:44:31.296127 [debug] [MainThread]: Command end result
[0m11:44:31.343106 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:44:31.345841 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:44:31.351793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:44:31.364832 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:44:31.365177 [info ] [MainThread]: Building catalog
[0m11:44:31.373622 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m11:44:31.380306 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m11:44:31.380741 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m11:44:31.381119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:31.385502 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:44:31.385911 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m11:44:31.386255 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "my_postgres_profile", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('lms_engagement_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:44:31.389790 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m11:44:31.391260 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m11:44:31.391620 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m11:44:31.395511 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m11:44:31.416240 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:44:31.417859 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:44:31.418164 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m11:44:31.419123 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.61229265, "process_in_blocks": "0", "process_kernel_time": 0.15133, "process_mem_max_rss": "109708", "process_out_blocks": "4979", "process_user_time": 1.450169}
[0m11:44:31.419656 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:44:31.419564 after 0.61 seconds
[0m11:44:31.420000 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:44:31.420216 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m11:44:31.420482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9240d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad071f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73da5b0>]}
[0m11:44:31.420777 [debug] [MainThread]: Flushing usage events
[0m11:44:32.444315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:33.675067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd51e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cea0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cea06a0>]}


============================== 11:44:33.678052 | 38ccd7ba-7fae-429c-8113-f1ae123a7b08 ==============================
[0m11:44:33.678052 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:44:33.678843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:33.803329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ccd7ba-7fae-429c-8113-f1ae123a7b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3930a0>]}
[0m11:44:33.846295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ccd7ba-7fae-429c-8113-f1ae123a7b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bd4eb0>]}
